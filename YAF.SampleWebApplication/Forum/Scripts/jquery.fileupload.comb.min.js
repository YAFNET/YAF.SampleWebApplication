/*! jQuery UI - v1.12.1+0b7246b6eeadfa9e2696e22f3230f6452f8129dc - 2020-02-20
 * http://jqueryui.com
 * Includes: widget.js
 * Copyright jQuery Foundation and other contributors; Licensed MIT */
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(window.jQuery)})(function(n){n.ui=n.ui||{};n.ui.version="1.12.1";
/*!
   * jQuery UI Widget 1.12.1
   * http://jqueryui.com
   *
   * Copyright jQuery Foundation and other contributors
   * Released under the MIT license.
   * http://jquery.org/license
   */
n.expr.pseudos||(n.expr.pseudos=n.expr[":"]);n.uniqueSort||(n.uniqueSort=n.unique);var i=0,r=Array.prototype.hasOwnProperty,t=Array.prototype.slice;n.cleanData=function(t){return function(i){for(var r,u,f=0;(u=i[f])!=null;f++)r=n._data(u,"events"),r&&r.remove&&n(u).triggerHandler("remove");t(i)}}(n.cleanData);n.widget=function(t,i,r){var f,u,o,h={},e=t.split(".")[0],s;return t=t.split(".")[1],s=e+"-"+t,r||(r=i,i=n.Widget),n.isArray(r)&&(r=n.extend.apply(null,[{}].concat(r))),n.expr.pseudos[s.toLowerCase()]=function(t){return!!n.data(t,s)},n[e]=n[e]||{},f=n[e][t],u=n[e][t]=function(n,t){if(!this._createWidget)return new u(n,t);arguments.length&&this._createWidget(n,t)},n.extend(u,f,{version:r.version,_proto:n.extend({},r),_childConstructors:[]}),o=new i,o.options=n.widget.extend({},o.options),n.each(r,function(t,r){if(!n.isFunction(r)){h[t]=r;return}h[t]=function(){function n(){return i.prototype[t].apply(this,arguments)}function u(n){return i.prototype[t].apply(this,n)}return function(){var i=this._super,f=this._superApply,t;return this._super=n,this._superApply=u,t=r.apply(this,arguments),this._super=i,this._superApply=f,t}}()}),u.prototype=n.widget.extend(o,{widgetEventPrefix:f?o.widgetEventPrefix||t:t},h,{constructor:u,namespace:e,widgetName:t,widgetFullName:s}),f?(n.each(f._childConstructors,function(t,i){var r=i.prototype;n.widget(r.namespace+"."+r.widgetName,u,i._proto)}),delete f._childConstructors):i._childConstructors.push(u),n.widget.bridge(t,u),u};n.widget.extend=function(i){for(var o=t.call(arguments,1),e=0,s=o.length,u,f;e<s;e++)for(u in o[e])f=o[e][u],r.call(o[e],u)&&f!==undefined&&(i[u]=n.isPlainObject(f)?n.isPlainObject(i[u])?n.widget.extend({},i[u],f):n.widget.extend({},f):f);return i};n.widget.bridge=function(i,r){var u=r.prototype.widgetFullName||i;n.fn[i]=function(f){var s=typeof f=="string",o=t.call(arguments,1),e=this;return s?this.length||f!=="instance"?this.each(function(){var t,r=n.data(this,u);return f==="instance"?(e=r,!1):r?!n.isFunction(r[f])||f.charAt(0)==="_"?n.error("no such method '"+f+"' for "+i+" widget instance"):(t=r[f].apply(r,o),t!==r&&t!==undefined?(e=t&&t.jquery?e.pushStack(t.get()):t,!1):void 0):n.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+f+"'")}):e=undefined:(o.length&&(f=n.widget.extend.apply(null,[f].concat(o))),this.each(function(){var t=n.data(this,u);t?(t.option(f||{}),t._init&&t._init()):n.data(this,u,new r(f,this))})),e}};n.Widget=function(){};n.Widget._childConstructors=[];n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,r){r=n(r||this.defaultElement||this)[0];this.element=n(r);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=n();this.hoverable=n();this.focusable=n();this.classesElementLookup={};r!==this&&(n.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===r&&this.destroy()}}),this.document=n(r.style?r.ownerDocument:r.document||r),this.window=n(this.document[0].defaultView||this.document[0].parentWindow));this.options=n.widget.extend({},this.options,this._getCreateOptions(),t);this._create();this.options.disabled&&this._setOptionDisabled(this.options.disabled);this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){var t=this;this._destroy();n.each(this.classesElementLookup,function(n,i){t._removeClass(i,n)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:n.noop,widget:function(){return this.element},option:function(t,i){var e=t,r,u,f;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof t=="string")if(e={},r=t.split("."),t=r.shift(),r.length){for(u=e[t]=n.widget.extend({},this.options[t]),f=0;f<r.length-1;f++)u[r[f]]=u[r[f]]||{},u=u[r[f]];if(t=r.pop(),arguments.length===1)return u[t]===undefined?null:u[t];u[t]=i}else{if(arguments.length===1)return this.options[t]===undefined?null:this.options[t];e[t]=i}return this._setOptions(e),this},_setOptions:function(n){for(var t in n)this._setOption(t,n[t]);return this},_setOption:function(n,t){return n==="classes"&&this._setOptionClasses(t),this.options[n]=t,n==="disabled"&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var i,u,r;for(i in t)(r=this.classesElementLookup[i],t[i]!==this.options.classes[i]&&r&&r.length)&&(u=n(r.get()),this._removeClass(r,i),u.addClass(this._classes({element:u,keys:i,classes:t,add:!0})))},_setOptionDisabled:function(n){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!n);n&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){function f(){t.element.each(function(t,r){var u=n.map(i.classesElementLookup,function(n){return n}).some(function(n){return n.is(r)});u||i._on(n(r),{remove:"_untrackClassesElement"})})}function u(u,e){for(var s,o=0;o<u.length;o++)s=i.classesElementLookup[u[o]]||n(),t.add?(f(),s=n(n.uniqueSort(s.get().concat(t.element.get())))):s=n(s.not(t.element).get()),i.classesElementLookup[u[o]]=s,r.push(u[o]),e&&t.classes[u[o]]&&r.push(t.classes[u[o]])}var r=[],i=this;return t=n.extend({element:this.element,classes:this.options.classes||{}},t),t.keys&&u(t.keys.match(/\S+/g)||[],!0),t.extra&&u(t.extra.match(/\S+/g)||[]),r.join(" ")},_untrackClassesElement:function(t){var i=this;n.each(i.classesElementLookup,function(r,u){n.inArray(t.target,u)!==-1&&(i.classesElementLookup[r]=n(u.not(t.target).get()))});this._off(n(t.target))},_removeClass:function(n,t,i){return this._toggleClass(n,t,i,!1)},_addClass:function(n,t,i){return this._toggleClass(n,t,i,!0)},_toggleClass:function(n,t,i,r){r=typeof r=="boolean"?r:i;var u=typeof n=="string"||n===null,f={extra:u?t:i,keys:u?n:t,element:u?this.element:n,add:r};return f.element.toggleClass(this._classes(f),r),this},_on:function(t,i,r){var f,u=this;typeof t!="boolean"&&(r=i,i=t,t=!1);r?(i=f=n(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,f=this.widget());n.each(r,function(r,e){function o(){if(t||u.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof e=="string"?u[e]:e).apply(u,arguments)}typeof e!="string"&&(o.guid=e.guid=e.guid||o.guid||n.guid++);var s=r.match(/^([\w:-]*)\s*(.*)$/),h=s[1]+u.eventNamespace,c=s[2];if(c)f.on(h,c,o);else i.on(h,o)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;t.off(i);this.bindings=n(this.bindings.not(t).get());this.focusable=n(this.focusable.not(t).get());this.hoverable=n(this.hoverable.not(t).get())},_delay:function(n,t){function r(){return(typeof n=="string"?i[n]:n).apply(i,arguments)}var i=this;return setTimeout(r,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){this._addClass(n(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(n(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){this._addClass(n(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(n(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,i,r){var u,f,e=this.options[t];if(r=r||{},i=n.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],f=i.originalEvent,f)for(u in f)u in i||(i[u]=f[u]);return this.element.trigger(i,r),!(n.isFunction(e)&&e.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}};n.each({show:"fadeIn",hide:"fadeOut"},function(t,i){n.Widget.prototype["_"+t]=function(r,u,f){typeof u=="string"&&(u={effect:u});var o,e=u?u===!0||typeof u=="number"?i:u.effect||i:t;u=u||{};typeof u=="number"&&(u={duration:u});o=!n.isEmptyObject(u);u.complete=f;u.delay&&r.delay(u.delay);o&&n.effects&&n.effects.effect[e]?r[t](u):e!==t&&r[e]?r[e](u.duration,u.easing,f):r.queue(function(i){n(this)[t]();f&&f.call(r[0]);i()})}})}),function(n){"use strict";var t=function(n,i){var r=/[^\w\-.:]/.test(n)?new Function(t.arg+",tmpl","var _e=tmpl.encode"+t.helper+",_s='"+n.replace(t.regexp,t.func)+"';return _s;"):t.cache[n]=t.cache[n]||t(t.load(n));return i?r(i,t):function(n){return r(n,t)}};t.cache={};t.load=function(n){return document.getElementById(n).innerHTML};t.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g;t.func=function(n,t,i,r,u,f){return t?{"\n":"\\n","\r":"\\r","\t":"\\t"," ":" "}[t]||"\\"+t:i?i==="="?"'+_e("+r+")+'":"'+("+r+"==null?'':"+r+")+'":u?"';":f?"_s+='":void 0};t.encReg=/[<>&"'\x00]/g;t.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"};t.encode=function(n){return(n==null?"":""+n).replace(t.encReg,function(n){return t.encMap[n]||""})};t.arg="o";t.helper=",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}";typeof define=="function"&&define.amd?define(function(){return t}):typeof module=="object"&&module.exports?module.exports=t:n.tmpl=t}(this);!function(n){"use strict";function u(n){return!!i&&i.createObjectURL(n)}function f(n){return!!i&&i.revokeObjectURL(n)}function e(n,t){!n||"blob:"!==n.slice(0,5)||t&&t.noRevoke||f(n)}function o(t,i,r,u){var f,e;return n.FileReader?(f=new FileReader,f.onload=function(){i.call(f,this.result)},r&&(f.onabort=f.onerror=function(){r.call(f,this.error)}),e=f[u||"readAsDataURL"],e?(e.call(f,t),f):void 0):!1}function r(n,t){return Object.prototype.toString.call(t)==="[object "+n+"]"}function t(i,f,s){function h(f,h){function v(n,t){f!==h?n instanceof Error?h(n):((t=t||{}).image=n,f(t)):f&&f(n,t)}function a(t,f){f&&n.console&&console.log(f);t&&r("Blob",t)?l=u(i=t):(l=i,s&&s.crossOrigin&&(c.crossOrigin=s.crossOrigin));c.src=l}var l,c=document.createElement("img");return c.onerror=function(n){e(l,s);h&&h.call(c,n)},c.onload=function(){e(l,s);var n={originalWidth:c.naturalWidth||c.width,originalHeight:c.naturalHeight||c.height};try{t.transform(c,s,v,i,n)}catch(r){h&&h(r)}},"string"==typeof i?(t.requiresMetaData(s)?t.fetchBlob(i,a,s):a(),c):r("Blob",i)||r("File",i)?(l=u(i))?(c.src=l,c):o(i,function(n){c.src=n},h):void 0}return n.Promise&&"function"!=typeof f?(s=f,new Promise(h)):h(f,f)}var i=n.URL||n.webkitURL;t.requiresMetaData=function(n){return n&&n.meta};t.fetchBlob=function(n,t){t()};t.transform=function(n,t,i,r,u){i(n,u)};t.global=n;t.readFile=o;t.isInstanceOf=r;t.createObjectURL=u;t.revokeObjectURL=f;"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:n.loadImage=t}("undefined"!=typeof window&&window||this),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],n):"object"==typeof module&&module.exports?n(require("./load-image")):n(window.loadImage)}(function(n){"use strict";var t=n.transform;n.createCanvas=function(t,i,r){if(r&&n.global.OffscreenCanvas)return new OffscreenCanvas(t,i);var u=document.createElement("canvas");return u.width=t,u.height=i,u};n.transform=function(i,r,u,f,e){t.call(n,n.scale(i,r,e),r,u,f,e)};n.transformCoordinates=function(){};n.getTransformedOptions=function(n,t){var i,r,f,e,u=t.aspectRatio;if(!u)return t;for(r in i={},t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i.crop=!0,u<(f=n.naturalWidth||n.width)/(e=n.naturalHeight||n.height)?(i.maxWidth=e*u,i.maxHeight=e):(i.maxWidth=f,i.maxHeight=f/u),i};n.drawImage=function(n,t,i,r,u,f,e,o,s){var h=t.getContext("2d");return!1===s.imageSmoothingEnabled?(h.msImageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1):s.imageSmoothingQuality&&(h.imageSmoothingQuality=s.imageSmoothingQuality),h.drawImage(n,i,r,u,f,0,0,e,o),h};n.requiresCanvas=function(n){return n.canvas||n.crop||!!n.aspectRatio};n.scale=function(t,i,r){function nt(){var n=Math.max((b||e)/e,(k||s)/s);1<n&&(e*=n,s*=n)}function tt(){var n=Math.min((c||e)/e,(l||s)/s);n<1&&(e*=n,s*=n)}i=i||{};r=r||{};var c,l,b,k,u,f,a,v,p,w,d,o,g=t.getContext||n.requiresCanvas(i)&&!!n.global.HTMLCanvasElement,h=t.naturalWidth||t.width,y=t.naturalHeight||t.height,e=h,s=y;if(g&&(a=(i=n.getTransformedOptions(t,i,r)).left||0,v=i.top||0,i.sourceWidth?(u=i.sourceWidth,i.right!==undefined&&i.left===undefined&&(a=h-u-i.right)):u=h-a-(i.right||0),i.sourceHeight?(f=i.sourceHeight,i.bottom!==undefined&&i.top===undefined&&(v=y-f-i.bottom)):f=y-v-(i.bottom||0),e=u,s=f),c=i.maxWidth,l=i.maxHeight,b=i.minWidth,k=i.minHeight,g&&c&&l&&i.crop?(d=u/f-(e=c)/(s=l))<0?(f=l*u/c,i.top===undefined&&i.bottom===undefined&&(v=(y-f)/2)):0<d&&(u=c*f/l,i.left===undefined&&i.right===undefined&&(a=(h-u)/2)):((i.contain||i.cover)&&(b=c=c||b,k=l=l||k),i.cover?(tt(),nt()):(nt(),tt())),g){if(1<(p=i.pixelRatio)&&(!t.style.width||Math.floor(parseFloat(t.style.width,10))!==Math.floor(h/p))&&(e*=p,s*=p),n.orientationCropBug&&!t.getContext&&(a||v||u!==h||f!==y)&&(d=t,t=n.createCanvas(h,y,!0),n.drawImage(d,t,0,0,h,y,h,y,i)),0<(w=i.downsamplingRatio)&&w<1&&e<u&&s<f)for(;e<u*w;)o=n.createCanvas(u*w,f*w,!0),n.drawImage(t,o,a,v,u,f,o.width,o.height,i),v=a=0,u=o.width,f=o.height,t=o;return o=n.createCanvas(e,s),n.transformCoordinates(o,i,r),1<p&&(o.style.width=o.width/p+"px"),n.drawImage(t,o,a,v,u,f,e,s,i).setTransform(1,0,0,1,0,0),o}return t.width=e,t.height=s,t}}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],n):"object"==typeof module&&module.exports?n(require("./load-image")):n(window.loadImage)}(function(n){"use strict";function r(r,u,o,s){function h(u,h){if(!(t.DataView&&i&&r&&12<=r.size&&"image/jpeg"===r.type))return u(s);var l=o.maxMetaDataSize||262144;n.readFile(i.call(r,0,l),function(n){var i=new DataView(n);if(65496!==i.getUint16(0))return h(new Error("Invalid JPEG file: Missing JPEG marker."));for(var r,a,v,l,t=2,p=i.byteLength-4,y=t;t<p&&(65504<=(r=i.getUint16(t))&&r<=65519||65534===r);){if(t+(a=i.getUint16(t+2)+2)>i.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if((v=e.jpeg[r])&&!o.disableMetaDataParsers)for(l=0;l<v.length;l+=1)v[l].call(c,i,t,a,s,o);y=t+=a}!o.disableImageHead&&6<y&&(s.imageHead=f.call(n,0,y));u(s)},h,"readAsArrayBuffer")||u(s)}var c=this;return o=o||{},t.Promise&&"function"!=typeof u?(s=o=u||{},new Promise(h)):(s=s||{},h(u,u))}function o(n,t,r){return n&&t&&r?new Blob([r,i.call(n,t.byteLength)],{type:"image/jpeg"}):null}var t=n.global,u=n.transform,i=t.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),f=t.ArrayBuffer&&ArrayBuffer.prototype.slice||function(n,t){t=t||this.byteLength-n;var r=new Uint8Array(this,n,t),i=new Uint8Array(t);return i.set(r),i.buffer},e={jpeg:{65505:[],65517:[]}};n.transform=function(i,f,e,o,s){n.requiresMetaData(f)?r(o,function(r){r!==s&&(t.console&&console.log(r),r=s);u.call(n,i,f,e,o,r)},f,s=s||{}):u.apply(n,arguments)};n.blobSlice=i;n.bufferSlice=f;n.replaceHead=function(n,i,u){var f={maxMetaDataSize:256,disableMetaDataParsers:!0};if(!u&&t.Promise)return r(n,f).then(function(t){return o(n,t.imageHead,i)});r(n,function(t){u(o(n,t.imageHead,i))},f)};n.parseMetaData=r;n.metaDataParsers=e}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],n):"object"==typeof module&&module.exports?n(require("./load-image")):n(window.loadImage)}(function(n){"use strict";var t=n.global;t.fetch&&t.Request&&t.Response&&t.Response.prototype.blob?n.fetchBlob=function(n,i,r){function u(n){return n.blob()}if(t.Promise&&"function"!=typeof i)return fetch(new Request(n,i)).then(u);fetch(new Request(n,r)).then(u).then(i)["catch"](function(n){i(null,n)})}:t.XMLHttpRequest&&""===(new XMLHttpRequest).responseType&&(n.fetchBlob=function(n,i,r){function u(t,i){r=r||{};var u=new XMLHttpRequest;u.open(r.method||"GET",n);r.headers&&Object.keys(r.headers).forEach(function(n){u.setRequestHeader(n,r.headers[n])});u.withCredentials="include"===r.credentials;u.responseType="blob";u.onload=function(){t(u.response)};u.onerror=u.onabort=u.ontimeout=function(n){t===i?i(null,n):i(n)};u.send(r.body)}return t.Promise&&"function"!=typeof i?(r=i,new Promise(u)):u(i,i)})}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],n):"object"==typeof module&&module.exports?n(require("./load-image"),require("./load-image-scale"),require("./load-image-meta")):n(window.loadImage)}(function(n){"use strict";function r(t,i){var r=t&&t.orientation;return!0===r&&!n.orientation||1===r&&n.orientation||(!i||n.orientation)&&1<r&&r<9}function u(n,t){return n!==t&&(1===n&&1<t&&t<9||1<n&&n<9)}function f(n,t){if(1<t&&t<9)switch(n){case 2:case 4:return 4<t;case 5:case 7:return t%2==0;case 6:case 8:return 2===t||4===t||5===t||7===t}}var t,i,e=n.transform,o=n.requiresCanvas,s=n.requiresMetaData,h=n.transformCoordinates,c=n.getTransformedOptions;(t=n).global.document&&((i=document.createElement("img")).onload=function(){var n;t.orientation=2===i.width&&3===i.height;t.orientation&&((n=t.createCanvas(1,1,!0).getContext("2d")).drawImage(i,1,1,1,1,0,0,1,1),t.orientationCropBug="255,255,255,255"!==n.getImageData(0,0,1,1).data.toString())},i.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k=");n.requiresCanvas=function(t){return r(t)||o.call(n,t)};n.requiresMetaData=function(t){return r(t,!0)||s.call(n,t)};n.transform=function(t,i,r,u,f){e.call(n,t,i,function(t,i){var u,f,e;i&&4<(u=n.orientation&&i.exif&&i.exif.get("Orientation"))&&u<9&&(f=i.originalWidth,e=i.originalHeight,i.originalWidth=e,i.originalHeight=f);r(t,i)},u,f)};n.getTransformedOptions=function(t,i,r){var e=c.call(n,t,i),w=r.exif&&r.exif.get("Orientation"),v=e.orientation,y=n.orientation&&w,p;if(!0===v&&(v=w),!u(v,y))return e;var b,k,s=e.top,h=e.right,l=e.bottom,a=e.left,o={};for(p in e)Object.prototype.hasOwnProperty.call(e,p)&&(o[p]=e[p]);if((4<(o.orientation=v)&&!(4<y)||v<5&&4<y)&&(o.maxWidth=e.maxHeight,o.maxHeight=e.maxWidth,o.minWidth=e.minHeight,o.minHeight=e.minWidth,o.sourceWidth=e.sourceHeight,o.sourceHeight=e.sourceWidth),1<y){switch(y){case 2:h=e.left;a=e.right;break;case 3:s=e.bottom;h=e.left;l=e.top;a=e.right;break;case 4:s=e.bottom;l=e.top;break;case 5:s=e.left;h=e.bottom;l=e.right;a=e.top;break;case 6:s=e.left;h=e.top;l=e.right;a=e.bottom;break;case 7:s=e.right;h=e.top;l=e.left;a=e.bottom;break;case 8:s=e.right;h=e.bottom;l=e.left;a=e.top}f(v,y)&&(b=s,k=h,s=l,h=a,l=b,a=k)}switch(o.top=s,o.right=h,o.bottom=l,o.left=a,v){case 2:o.right=a;o.left=h;break;case 3:o.top=l;o.right=a;o.bottom=s;o.left=h;break;case 4:o.top=l;o.bottom=s;break;case 5:o.top=a;o.right=l;o.bottom=h;o.left=s;break;case 6:o.top=h;o.right=l;o.bottom=a;o.left=s;break;case 7:o.top=h;o.right=s;o.bottom=a;o.left=l;break;case 8:o.top=a;o.right=s;o.bottom=h;o.left=l}return o};n.transformCoordinates=function(t,i,r){var o,l;if(h.call(n,t,i,r),o=i.orientation,l=n.orientation&&r.exif&&r.exif.get("Orientation"),u(o,l)){var e=t.getContext("2d"),s=t.width,c=t.height,a=s,v=c;switch((4<o&&!(4<l)||o<5&&4<l)&&(t.width=c,t.height=s),4<o&&(a=c,v=s),l){case 2:e.translate(a,0);e.scale(-1,1);break;case 3:e.translate(a,v);e.rotate(Math.PI);break;case 4:e.translate(0,v);e.scale(1,-1);break;case 5:e.rotate(-.5*Math.PI);e.scale(-1,1);break;case 6:e.rotate(-.5*Math.PI);e.translate(-a,0);break;case 7:e.rotate(-.5*Math.PI);e.translate(-a,v);e.scale(1,-1);break;case 8:e.rotate(.5*Math.PI);e.translate(0,-v)}switch(f(o,l)&&(e.translate(a,v),e.rotate(Math.PI)),o){case 2:e.translate(s,0);e.scale(-1,1);break;case 3:e.translate(s,c);e.rotate(Math.PI);break;case 4:e.translate(0,c);e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI);e.translate(0,-c);break;case 7:e.rotate(.5*Math.PI);e.translate(s,-c);e.scale(-1,1);break;case 8:e.rotate(-.5*Math.PI);e.translate(-s,0)}}}}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],n):"object"==typeof module&&module.exports?n(require("./load-image"),require("./load-image-meta")):n(window.loadImage)}(function(n){"use strict";function t(n){n&&(Object.defineProperty(this,"map",{value:this.ifds[n].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[n]||{}}))}function r(n,t,i){return(!n||n[i])&&(!t||!0!==t[i])}function u(n,t,u,f,e,o,s,h){var v,y,l,c,a,p;if(u+6>n.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((y=u+2+12*(v=n.getUint16(u,f)))+4>n.byteLength)){for(l=0;l<v;l+=1)c=u+2+12*l,r(s,h,a=n.getUint16(c,f))&&(p=function(n,t,r,u,f,e){var a,c,h,o,l,v,s=i[u];if(s){if(!((c=4<(a=s.size*f)?t+n.getUint32(r+8,e):r+8)+a>n.byteLength)){if(1===f)return s.getValue(n,c,e);for(h=[],o=0;o<f;o+=1)h[o]=s.getValue(n,c+o*s.size,e);if(s.ascii){for(l="",o=0;o<h.length&&"\0"!==(v=h[o]);o+=1)l+=v;return l}return h}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")}(n,t,c,n.getUint16(c+2,f),n.getUint32(c+4,f),f),e[a]=p,o&&(o[a]=c));return n.getUint32(y,f)}console.log("Invalid Exif data: Invalid directory size.")}}t.prototype.ifds={ifd1:{name:"Thumbnail",map:t.prototype.map={Orientation:274,Thumbnail:"ifd1",Blob:513,Exif:34665,GPSInfo:34853,Interoperability:40965}},34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}};t.prototype.get=function(n){return this[n]||this[this.map[n]]};var i={1:{getValue:function(n,t){return n.getUint8(t)},size:1},2:{getValue:function(n,t){return String.fromCharCode(n.getUint8(t))},size:1,ascii:!0},3:{getValue:function(n,t,i){return n.getUint16(t,i)},size:2},4:{getValue:function(n,t,i){return n.getUint32(t,i)},size:4},5:{getValue:function(n,t,i){return n.getUint32(t,i)/n.getUint32(t+4,i)},size:8},9:{getValue:function(n,t,i){return n.getInt32(t,i)},size:4},10:{getValue:function(n,t,i){return n.getInt32(t,i)/n.getInt32(t+4,i)},size:8}};i[7]=i[1];n.parseExifData=function(i,f,e,o,s){if(!s.disableExif){var c,l,a,v=s.includeExifTags,y=s.excludeExifTags||{34665:{37500:!0}},h=f+10;if(1165519206===i.getUint32(f+4))if(h+8>i.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===i.getUint16(f+8)){switch(i.getUint16(h)){case 18761:c=!0;break;case 19789:c=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===i.getUint16(h+2,c)?(l=i.getUint32(h+4,c),o.exif=new t,s.disableExifOffsets||(o.exifOffsets=new t,o.exifTiffOffset=h,o.exifLittleEndian=c),(l=u(i,h,h+l,c,o.exif,o.exifOffsets,v,y))&&r(v,y,"ifd1")&&(o.exif.ifd1=l,o.exifOffsets&&(o.exifOffsets.ifd1=h+l)),Object.keys(o.exif.ifds).forEach(function(n){var f,r,a,e,p,s,l,w;r=n;a=i;e=h;p=c;s=v;l=y;(w=(f=o).exif[r])&&(f.exif[r]=new t(r),f.exifOffsets&&(f.exifOffsets[r]=new t(r)),u(a,e,e+w,p,f.exif[r],f.exifOffsets&&f.exifOffsets[r],s&&s[r],l&&l[r]))}),(a=o.exif.ifd1)&&a[513]&&(a[513]=function(t,i,r){if(r){if(!(i+r>t.byteLength))return new Blob([n.bufferSlice.call(t.buffer,i,i+r)],{type:"image/jpeg"});console.log("Invalid Exif data: Invalid thumbnail data.")}}(i,h+a[513],a[514]))):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}};n.metaDataParsers.jpeg[65505].push(n.parseExifData);n.exifWriters={274:function(n,t,i){var r=t.exifOffsets[274];return r&&new DataView(n,r+8,2).setUint16(0,i,t.exifLittleEndian),n}};n.writeExifData=function(t,i,r,u){return n.exifWriters[i.exif.map[r]](t,i,u)};n.ExifMap=t}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],n):"object"==typeof module&&module.exports?n(require("./load-image"),require("./load-image-exif")):n(window.loadImage)}(function(n){"use strict";var t=n.ExifMap.prototype;t.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}};t.tags.ifd1=t.tags;t.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"Original",2:"Horizontal flip",3:"Rotate 180° CCW",4:"Vertical flip",5:"Vertical flip + Rotate 90° CW",6:"Rotate 90° CW",7:"Horizontal flip + Rotate 90° CW",8:"Rotate 90° CCW"}};t.getText=function(n){var t=this.get(n);switch(n){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[n][t];case"ExifVersion":case"FlashpixVersion":return t?String.fromCharCode(t[0],t[1],t[2],t[3]):void 0;case"ComponentsConfiguration":return t?this.stringValues[n][t[0]]+this.stringValues[n][t[1]]+this.stringValues[n][t[2]]+this.stringValues[n][t[3]]:void 0;case"GPSVersionID":return t?t[0]+"."+t[1]+"."+t[2]+"."+t[3]:void 0}return String(t)};t.getAll=function(){var n,t,i,r={};for(n in this)Object.prototype.hasOwnProperty.call(this,n)&&((t=this[n])&&t.getAll?r[this.ifds[n].name]=t.getAll():(i=this.tags[n])&&(r[i]=this.getText(i)));return r};t.getName=function(n){var t=this.tags[n];return"object"==typeof t?this.ifds[n].name:t},function(){var n,u,r,i=t.tags;for(n in i)if(Object.prototype.hasOwnProperty.call(i,n))if(u=t.ifds[n])for(n in r=i[n])Object.prototype.hasOwnProperty.call(r,n)&&(u.map[r[n]]=Number(n));else t.map[i[n]]=Number(n)}()}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],n):"object"==typeof module&&module.exports?n(require("./load-image"),require("./load-image-meta")):n(window.loadImage)}(function(n){"use strict";function t(){}function i(n,t,i,r,u){return"binary"===t.types[n]?new Blob([i.buffer.slice(r,r+u)]):"Uint16"===t.types[n]?i.getUint16(r):function(n,t,i){for(var u="",f=t+i,r=t;r<f;r+=1)u+=String.fromCharCode(n.getUint8(r));return u}(i,r,u)}function r(n,t,r,u,f,e){for(var l,a,s,h,c,v=t+r,o=t;o<v;)28===n.getUint8(o)&&2===n.getUint8(o+1)&&(s=n.getUint8(o+2),f&&!f[s]||e&&e[s]||(a=n.getInt16(o+3),l=i(s,u.iptc,n,o+5,a),u.iptc[s]=(h=u.iptc[s],c=l,h===undefined?c:h instanceof Array?(h.push(c),h):[h,c]),u.iptcOffsets&&(u.iptcOffsets[s]=o))),o+=1}t.prototype.map={ObjectName:5};t.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"};t.prototype.get=function(n){return this[n]||this[this.map[n]]};n.parseIptcData=function(n,i,u,f,e){var v,o,y,h,s,c,l,a;if(!e.disableIptc)for(s=i+u;i+8<s;){if(h=i,943868237===(y=n).getUint32(h)&&1028===y.getUint16(h+4)){if(c=(v=i,o=void 0,(o=n.getUint8(v+7))%2!=0&&(o+=1),0===o&&(o=4),o),l=i+8+c,s<l){console.log("Invalid IPTC data: Invalid segment offset.");break}if(a=n.getUint16(i+6+c),s<i+a){console.log("Invalid IPTC data: Invalid segment size.");break}return f.iptc=new t,e.disableIptcOffsets||(f.iptcOffsets=new t),void r(n,l,a,f,e.includeIptcTags,e.excludeIptcTags||{202:!0})}i+=1}};n.metaDataParsers.jpeg[65517].push(n.parseIptcData);n.IptcMap=t}),function(n){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-iptc"],n):"object"==typeof module&&module.exports?n(require("./load-image"),require("./load-image-iptc")):n(window.loadImage)}(function(n){"use strict";var t=n.IptcMap.prototype;t.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"};t.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}};t.getText=function(n){var t=this.get(n),r=this.map[n],i=this.stringValues[r];return i?i[t]:String(t)};t.getAll=function(){var n,t,i={};for(n in this)Object.prototype.hasOwnProperty.call(this,n)&&(t=this.tags[n])&&(i[t]=this.getText(t));return i};t.getName=function(n){return this.tags[n]},function(){var n,i=t.tags,r=t.map||{};for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[i[n]]=Number(n))}()}),function(n){"use strict";var i=n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype,r=n.Blob&&function(){try{return Boolean(new Blob)}catch(n){return!1}}(),f=r&&n.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(n){return!1}}(),u=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,e=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,t=(r||u)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(n){var t,h,v,c,o,s,l,i,a;if(t=n.match(e),!t)throw new Error("invalid data URI");for(h=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),v=!!t[4],c=n.slice(t[0].length),o=v?atob(c):decodeURIComponent(c),s=new ArrayBuffer(o.length),l=new Uint8Array(s),i=0;i<o.length;i+=1)l[i]=o.charCodeAt(i);return r?new Blob([f?l:s],{type:h}):(a=new u,a.append(s),a.getBlob(h))};n.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(n,r,u){var f=this;setTimeout(function(){u&&i.toDataURL&&t?n(t(f.toDataURL(r,u))):n(f.mozGetAsFile("blob",r))})}:i.toDataURL&&t&&(i.toBlob=i.msToBlob?function(n,r,u){var f=this;setTimeout(function(){(r&&r!=="image/png"||u)&&i.toDataURL&&t?n(t(f.toDataURL(r,u))):n(f.msToBlob(r))})}:function(n,i,r){var u=this;setTimeout(function(){n(t(u.toDataURL(i,r)))})}));typeof define=="function"&&define.amd?define(function(){return t}):typeof module=="object"&&module.exports?module.exports=t:n.dataURLtoBlob=t}(window),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(window.jQuery)}(function(n){"use strict";var t=0,i=n,r="parseJSON";"JSON"in window&&"parse"in JSON&&(i=JSON,r="parse");n.ajaxTransport("iframe",function(i){if(i.async){var e=i.initialIframeSrc||"javascript:false;",r,u,f;return{send:function(o,s){r=n('<form style="display:none;"><\/form>');r.attr("accept-charset",i.formAcceptCharset);f=/\?/.test(i.url)?"&":"?";i.type==="DELETE"?(i.url=i.url+f+"_method=DELETE",i.type="POST"):i.type==="PUT"?(i.url=i.url+f+"_method=PUT",i.type="POST"):i.type==="PATCH"&&(i.url=i.url+f+"_method=PATCH",i.type="POST");t+=1;u=n('<iframe src="'+e+'" name="iframe-transport-'+t+'"><\/iframe>').on("load",function(){var t,f=n.isArray(i.paramName)?i.paramName:[i.paramName];u.off("load").on("load",function(){var t;try{if(t=u.contents(),!t.length||!t[0].firstChild)throw new Error;}catch(i){t=undefined}s(200,"success",{iframe:t});n('<iframe src="'+e+'"><\/iframe>').appendTo(r);window.setTimeout(function(){r.remove()},0)});r.prop("target",u.prop("name")).prop("action",i.url).prop("method",i.type);i.formData&&n.each(i.formData,function(t,i){n('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(r)});i.fileInput&&i.fileInput.length&&i.type==="POST"&&(t=i.fileInput.clone(),i.fileInput.after(function(n){return t[n]}),i.paramName&&i.fileInput.each(function(t){n(this).prop("name",f[t]||i.paramName)}),r.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),i.fileInput.removeAttr("form"));window.setTimeout(function(){r.submit();t&&t.length&&i.fileInput.each(function(i,r){var u=n(t[i]);n(r).prop("name",u.prop("name")).attr("form",u.attr("form"));u.replaceWith(r)})},0)});r.append(u).appendTo(document.body)},abort:function(){u&&u.off("load").prop("src",e);r&&r.remove()}}}});n.ajaxSetup({converters:{"iframe text":function(t){return t&&n(t[0].body).text()},"iframe json":function(t){return t&&i[r](n(t[0].body).text())},"iframe html":function(t){return t&&n(t[0].body).html()},"iframe xml":function(t){var i=t&&t[0];return i&&n.isXMLDoc(i)?i:n.parseXML(i.XMLDocument&&i.XMLDocument.xml||n(i.body).html())},"iframe script":function(t){return t&&n.globalEval(n(t[0].body).text())}}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery-ui/ui/widget"],n):typeof exports=="object"?n(require("jquery"),require("./vendor/jquery.ui.widget")):n(window.jQuery)}(function(n){"use strict";function t(t){var i=t==="dragover";return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var u=r.dataTransfer;u&&n.inArray("Files",u.types)!==-1&&this._trigger(t,n.Event(t,{delegatedEvent:r}))!==!1&&(r.preventDefault(),i&&(u.dropEffect="copy"))}}n.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||n('<input type="file"/>').prop("disabled"));n.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);n.widget("blueimp.yafFileUpload",{options:{dropZone:n(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,uniqueFilenames:undefined,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&n.each(i,function(n,i){t=t.replace("{"+n+"}",i)}),t},formData:function(n){return n.serializeArray()},add:function(t,i){if(t.isDefaultPrevented())return!1;(i.autoUpload||i.autoUpload!==!1&&n(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_promisePipe:function(){var t=n.fn.jquery.split(".");return Number(t[0])>1||Number(t[1])>7?"then":"pipe"}(),_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:n.support.blobSlice&&function(){var n=this.slice||this.webkitSlice||this.mozSlice;return n.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return n.type(t.formData)==="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:n.type(t.formData)==="object"?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?n.extend(t._progress,i):t._progress=i},_initResponseObject:function(n){var t;if(n._response)for(t in n._response)Object.prototype.hasOwnProperty.call(n._response,t)&&delete n._response[t];else n._response={}},_onProgress:function(t,i){if(t.lengthComputable){var r=Date.now?Date.now():(new Date).getTime(),u;if(i._time&&i.progressInterval&&r-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=r;u=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0);this._progress.loaded+=u-i._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,i.bitrateInterval);i._progress.loaded=i.loaded=u;i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(r,u,i.bitrateInterval);this._trigger("progress",n.Event("progress",{delegatedEvent:t}),i);this._trigger("progressall",n.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();if(i.upload){n(i.upload).on("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)});t.xhr=function(){return i}}},_deinitProgressListener:function(t){var i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&n(i.upload).off("progress")},_isInstanceOf:function(n,t){return Object.prototype.toString.call(t)==="[object "+n+"]"},_getUniqueFilename:function(n,t){return(n=String(n),t[n])?(n=n.replace(/(?: \(([\d]+)\))?(\.[^.]+)?$/,function(n,t,i){var r=t?Number(t)+1:1,u=i||"";return" ("+r+")"+u}),this._getUniqueFilename(n,t)):(t[n]=!0,n)},_initXHRData:function(t){var u=this,i,r=t.files[0],e=t.multipart||!n.support.xhrFileUpload,f=n.type(t.paramName)==="array"?t.paramName[0]:t.paramName;t.headers=n.extend({},t.headers);t.contentRange&&(t.headers["Content-Range"]=t.contentRange);e&&!t.blob&&this._isInstanceOf("File",r)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.uploadName||r.name)+'"');e?n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:f,value:t.blob}):n.each(t.files,function(r,u){i.push({name:n.type(t.paramName)==="array"&&t.paramName[r]||f,value:u})})):(u._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?i.append(f,t.blob,r.uploadName||r.name):n.each(t.files,function(r,e){if(u._isInstanceOf("File",e)||u._isInstanceOf("Blob",e)){var o=e.uploadName||e.name;t.uniqueFilenames&&(o=u._getUniqueFilename(o,t.uniqueFilenames));i.append(n.type(t.paramName)==="array"&&t.paramName[r]||f,e,o)}})),t.data=i):(t.contentType=r.type||"application/octet-stream",t.data=t.blob||r);t.blob=null},_initIframeSettings:function(t){var i=n("<a><\/a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n)},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||n.type(t.form.prop("method"))==="string"&&t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(n){return n.state?n.state():n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_addConvenienceMethods:function(t,i){var r=this,u=function(t){return n.Deferred().resolveWith(r,t).promise()};i.process=function(t,f){return(t||f)&&(i._processQueue=this._processQueue=(this._processQueue||u([this]))[r._promisePipe](function(){return i.errorThrown?n.Deferred().rejectWith(r,[i]).promise():u(arguments)})[r._promisePipe](t,f)),this._processQueue||u([this])};i.submit=function(){return this.state()!=="pending"&&(i.jqXHR=this.jqXHR=r._trigger("submit",n.Event("submit",{delegatedEvent:t}),this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()};i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))};i.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0};i.processing=function(){return!this.jqXHR&&this._processQueue&&r._getDeferredState(this._processQueue)==="pending"};i.progress=function(){return this._progress};i.response=function(){return this._response}},_getUploadedBytes:function(n){var i=n.getResponseHeader("Range"),t=i&&i.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var r=this,e=t.files[0],o=e.size,u=t.uploadedBytes,f=t.maxChunkSize||o,l=this._blobSlice,s=n.Deferred(),h=s.promise(),a,c;return!(this._isXHRUpload(t)&&l&&(u||(n.type(f)==="function"?f(t):f)<o))||t.data?!1:i?!0:u>=o?(e.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",e.error])):(c=function(){var i=n.extend({},t),h=i._progress.loaded;i.blob=l.call(e,u,u+(n.type(f)==="function"?f(i):f),e.type);i.chunkSize=i.blob.size;i.contentRange="bytes "+u+"-"+(u+i.chunkSize-1)+"/"+o;r._trigger("chunkbeforesend",null,i);r._initXHRData(i);r._initProgressListener(i);a=(r._trigger("chunksend",null,i)!==!1&&n.ajax(i)||r._getXHRPromise(!1,i.context)).done(function(f,e,l){u=r._getUploadedBytes(l)||u+i.chunkSize;h+i.chunkSize-i._progress.loaded&&r._onProgress(n.Event("progress",{lengthComputable:!0,loaded:u-i.uploadedBytes,total:u-i.uploadedBytes}),i);t.uploadedBytes=i.uploadedBytes=u;i.result=f;i.textStatus=e;i.jqXHR=l;r._trigger("chunkdone",null,i);r._trigger("chunkalways",null,i);u<o?c():s.resolveWith(i.context,[f,e,l])}).fail(function(n,t,u){i.jqXHR=n;i.textStatus=t;i.errorThrown=u;r._trigger("chunkfail",null,i);r._trigger("chunkalways",null,i);s.rejectWith(i.context,[n,t,u])}).always(function(){r._deinitProgressListener(i)})},this._enhancePromise(h),h.abort=function(){return a.abort()},c(),h)},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(t);this._initProgressObject(t);t._progress.loaded=t.loaded=t.uploadedBytes||0;t._progress.total=t.total=this._getTotal(t.files)||1;t._progress.bitrate=t.bitrate=0;this._active+=1;this._progress.loaded+=t.loaded;this._progress.total+=t.total},_onDone:function(t,i,r,u){var f=u._progress.total,e=u._response;u._progress.loaded<f&&this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:f,total:f}),u);e.result=u.result=t;e.textStatus=u.textStatus=i;e.jqXHR=u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){var u=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total);u.jqXHR=r.jqXHR=n;u.textStatus=r.textStatus=t;u.errorThrown=r.errorThrown=i;this._trigger("fail",null,r)},_onAlways:function(n,t,i,r){this._trigger("always",null,r)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r=this,f,s,e,h,u=r._getAJAXSettings(i),o=function(){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||((s||r._trigger("send",n.Event("send",{delegatedEvent:t}),u)===!1)&&r._getXHRPromise(!1,u.context,s)||r._chunkedUpload(u)||n.ajax(u)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._deinitProgressListener(u),r._onAlways(n,t,i,u),r._sending-=1,r._active-=1,u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift();f;){if(r._getDeferredState(f)==="pending"){f.resolve();break}f=r._slots.shift()}r._active===0&&r._trigger("stop")})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),h=e[r._promisePipe](o)):(this._sequence=this._sequence[r._promisePipe](o,o),h=this._sequence),h.abort=function(){return(s=[undefined,"abort","abort"],!f)?(e&&e.rejectWith(u.context,s),o()):f.abort()},this._enhancePromise(h)):o()},_onAdd:function(t,i){var a=this,p=!0,f=n.extend({},this.options,i),u=i.files,v=u.length,o=f.limitMultiFileUploads,c=f.limitMultiFileUploadSize,b=f.limitMultiFileUploadSizeOverhead,w=0,l=this._getParamName(f),s,e,h,r,y=0;if(!v)return!1;if(c&&u[0].size===undefined&&(c=undefined),(f.singleFileUploads||o||c)&&this._isXHRUpload(f))if(f.singleFileUploads||c||!o)if(!f.singleFileUploads&&c)for(h=[],s=[],r=0;r<v;r=r+1)w+=u[r].size+b,(r+1===v||w+u[r+1].size+b>c||o&&r+1-y>=o)&&(h.push(u.slice(y,r+1)),e=l.slice(y,r+1),e.length||(e=l),s.push(e),y=r+1,w=0);else s=l;else for(h=[],s=[],r=0;r<v;r+=o)h.push(u.slice(r,r+o)),e=l.slice(r,r+o),e.length||(e=l),s.push(e);else h=[u],s=[l];return i.originalFiles=u,n.each(h||u,function(r,u){var f=n.extend({},i);return f.files=h?u:[u],f.paramName=s[r],a._initResponseObject(f),a._initProgressObject(f),a._addConvenienceMethods(t,f),p=a._trigger("add",n.Event("add",{delegatedEvent:t}),f)}),p},_replaceFileInput:function(t){var i=t.fileInput,r=i.clone(!0),u=i.is(document.activeElement);t.fileInputClone=r;n("<form><\/form>").append(r)[0].reset();i.after(r).detach();u&&r.trigger("focus");n.cleanData(i.off("remove"));this.options.fileInput=this.options.fileInput.map(function(n,t){return t===i[0]?r[0]:t});i[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(t,i){var s=this,r=n.Deferred(),u=[],e,f=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},h=function(n){s._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(f)},o=function(){e.readEntries(function(n){n.length?(u=u.concat(n),o()):h(u)},f)};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(n){n.relativePath=i;r.resolve(n)},f):t.isDirectory?(e=t.createReader(),o()):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)}))[this._promisePipe](function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){var t;return n.webkitGetAsEntry?(t=n.webkitGetAsEntry(),t&&(t._file=n.getAsFile()),t):n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),i.length)i[0].name===undefined&&i[0].fileName&&n.each(i,function(n,t){t.name=t.fileName;t.size=t.fileSize});else{if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles))[this._promisePipe](function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var r=this,i={fileInput:n(t.target),form:n(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(u){i.files=u;r.options.replaceFileInput&&r._replaceFileInput(i);r._trigger("change",n.Event("change",{delegatedEvent:t}),i)!==!1&&r._onAdd(t,i)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};i&&i.length&&(n.each(i,function(n,t){var i=t.getAsFile&&t.getAsFile();i&&r.files.push(i)}),this._trigger("paste",n.Event("paste",{delegatedEvent:t}),r)!==!1&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var u=this,i=t.dataTransfer,r={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){r.files=i;u._trigger("drop",n.Event("drop",{delegatedEvent:t}),r)!==!1&&u._onAdd(t,r)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));n.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(t,i){var r=n.inArray(t,this._specialOptions)!==-1;r&&this._destroyEventHandlers();this._super(t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_getRegExp:function(n){var t=n.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return t!=="url"&&n.type(i)==="string"&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,r=this.element.data();n.each(this.element[0].attributes,function(n,u){var f=u.name.toLowerCase(),e;/^data-/.test(f)&&(f=f.slice(5).replace(/-[a-z]/g,function(n){return n.charAt(1).toUpperCase()}),e=r[f],t._isRegExpOption(f,e)&&(e=t._getRegExp(e)),i[f]=e)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),u=i.promise(),r,f;return u.abort=function(){return(f=!0,r)?r.abort():(i.reject(null,"abort","abort"),u)},this._getFileInputFiles(t.fileInput).always(function(n){if(!f){if(!n.length){i.reject();return}t.files=n;r=e._onSend(null,t);r.then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)})}}),this._enhancePromise(u)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","./jquery.fileupload"],n):typeof exports=="object"?n(require("jquery"),require("./jquery.fileupload")):n(window.jQuery)}(function(n){"use strict";var t=n.blueimp.yafFileUpload.prototype.options.add;n.widget("blueimp.yafFileUpload",n.blueimp.yafFileUpload,{options:{processQueue:[],add:function(i,r){var u=n(this);r.process(function(){return u.yafFileUpload("process",r)});t.call(this,i,r)}},processActions:{},_processFile:function(t,i){var r=this,f=n.Deferred().resolveWith(r,[t]),u=f.promise();return this._trigger("process",null,t),n.each(t.processQueue,function(t,f){var e=function(t){return i.errorThrown?n.Deferred().rejectWith(r,[i]).promise():r.processActions[f.action].call(r,t,f)};u=u[r._promisePipe](e,f.always&&e)}),u.done(function(){r._trigger("processdone",null,t);r._trigger("processalways",null,t)}).fail(function(){r._trigger("processfail",null,t);r._trigger("processalways",null,t)}),u},_transformProcessQueue:function(t){var i=[];n.each(t.processQueue,function(){var r={},f=this.action,u=this.prefix===!0?f:this.prefix;n.each(this,function(i,f){r[i]=n.type(f)==="string"&&f.charAt(0)==="@"?t[f.slice(1)||(u?u+i.charAt(0).toUpperCase()+i.slice(1):i)]:f});i.push(r)});t.processQueue=i},processing:function(){return this._processing},process:function(t){var i=this,r=n.extend({},this.options,t);return r.processQueue&&r.processQueue.length&&(this._transformProcessQueue(r),this._processing===0&&this._trigger("processstart"),n.each(t.files,function(u){var f=u?n.extend({},r):r,e=function(){return t.errorThrown?n.Deferred().rejectWith(i,[t]).promise():i._processFile(f,t)};f.index=u;i._processing+=1;i._processingQueue=i._processingQueue[i._promisePipe](e,e).always(function(){i._processing-=1;i._processing===0&&i._trigger("processstop")})})),this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=n.Deferred().resolveWith(this).promise()}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","load-image","load-image-meta","load-image-scale","load-image-exif","load-image-orientation","canvas-to-blob","./jquery.fileupload-process"],n):typeof exports=="object"?n(require("jquery"),require("blueimp-load-image/js/load-image"),require("blueimp-load-image/js/load-image-meta"),require("blueimp-load-image/js/load-image-scale"),require("blueimp-load-image/js/load-image-exif"),require("blueimp-load-image/js/load-image-orientation"),require("blueimp-canvas-to-blob"),require("./jquery.fileupload-process")):n(window.jQuery,window.loadImage)}(function(n,t){"use strict";n.blueimp.yafFileUpload.prototype.options.processQueue.unshift({action:"loadImageMetaData",maxMetaDataSize:"@",disableImageHead:"@",disableMetaDataParsers:"@",disableExif:"@",disableExifOffsets:"@",includeExifTags:"@",excludeExifTags:"@",disableIptc:"@",disableIptcOffsets:"@",includeIptcTags:"@",excludeIptcTags:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"});n.widget("blueimp.yafFileUpload",n.blueimp.yafFileUpload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!0,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(i,r){if(r.disabled)return i;var e=this,u=i.files[i.index],f=n.Deferred();return n.type(r.maxFileSize)==="number"&&u.size>r.maxFileSize||r.fileTypes&&!r.fileTypes.test(u.type)||!t(u,function(n){n.src&&(i.img=n);f.resolveWith(e,[i])},r)?i:f.promise()},resizeImage:function(i,r){if(r.disabled||!(i.canvas||i.img))return i;r=n.extend({canvas:!0},r);var h=this,f=n.Deferred(),u=r.canvas&&i.canvas||i.img,s=function(n){n&&(n.width!==u.width||n.height!==u.height||r.forceResize)&&(i[n.getContext?"canvas":"img"]=n);i.preview=n;f.resolveWith(h,[i])},e,o;return i.exif&&r.thumbnail&&(e=i.exif.get("Thumbnail"),o=e&&e.get("Blob"),o)?(r.orientation=i.exif.get("Orientation"),t(o,s,r),f.promise()):(i.orientation?delete r.orientation:i.orientation=r.orientation||t.orientation,u)?(s(t.scale(u,r,i)),f.promise()):i},saveImage:function(t,i){if(!t.canvas||i.disabled)return t;var f=this,r=t.files[t.index],u=n.Deferred();if(t.canvas.toBlob)t.canvas.toBlob(function(n){n.name||(r.type===n.type?n.name=r.name:r.name&&(n.name=r.name.replace(/\.\w+$/,"."+n.type.substr(6))));r.type!==n.type&&delete t.imageHead;t.files[t.index]=n;u.resolveWith(f,[t])},i.type||r.type,i.quality);else return t;return u.promise()},loadImageMetaData:function(i,r){if(r.disabled)return i;var f=this,u=n.Deferred();return t.parseMetaData(i.files[i.index],function(t){n.extend(i,t);u.resolveWith(f,[i])},r),u.promise()},saveImageMetaData:function(i,r){if(!(i.imageHead&&i.canvas&&i.canvas.toBlob&&!r.disabled))return i;var e=this,u=i.files[i.index],f=n.Deferred();return i.orientation===!0&&i.exifOffsets&&t.writeExifData(i.imageHead,i,"Orientation",1),t.replaceHead(u,i.imageHead,function(n){n.name=u.name;i.files[i.index]=n;f.resolveWith(e,[i])}),f.promise()},setImage:function(n,t){return n.preview&&!t.disabled&&(n.files[n.index][t.name||"preview"]=n.preview),n},deleteImageReferences:function(n,t){return t.disabled||(delete n.img,delete n.canvas,delete n.preview,delete n.imageHead),n}}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","./jquery.fileupload-process"],n):typeof exports=="object"?n(require("jquery"),require("./jquery.fileupload-process")):n(window.jQuery)}(function(n){"use strict";n.blueimp.yafFileUpload.prototype.options.processQueue.push({action:"validate",always:!0,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"});n.widget("blueimp.yafFileUpload",n.blueimp.yafFileUpload,{options:{getNumberOfFiles:n.noop,messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small"}},processActions:{validate:function(t,i){if(i.disabled)return t;var e=n.Deferred(),u=this.options,r=t.files[t.index],f;return(i.minFileSize||i.maxFileSize)&&(f=r.size),n.type(i.maxNumberOfFiles)==="number"&&(u.getNumberOfFiles()||0)+t.files.length>i.maxNumberOfFiles?r.error=u.i18n("maxNumberOfFiles"):!i.acceptFileTypes||i.acceptFileTypes.test(r.type)||i.acceptFileTypes.test(r.name)?f>i.maxFileSize?r.error=u.i18n("maxFileSize"):n.type(f)==="number"&&f<i.minFileSize?r.error=u.i18n("minFileSize"):delete r.error:r.error=u.i18n("acceptFileTypes"),r.error||t.files.error?(t.files.error=!0,e.rejectWith(this,[t])):e.resolveWith(this,[t]),e.promise()}}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","blueimp-tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],n):typeof exports=="object"?n(require("jquery"),require("blueimp-tmpl"),require("./jquery.fileupload-image"),require("./jquery.fileupload-audio"),require("./jquery.fileupload-video"),require("./jquery.fileupload-validate")):n(window.jQuery,window.tmpl)}(function(n,t){"use strict";n.blueimp.yafFileUpload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");n.widget("blueimp.yafFileUpload",n.blueimp.yafFileUpload,{options:{autoUpload:!1,showElementClass:"in",uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:undefined,prependFiles:!1,dataType:"json",messages:{unknownError:"Unknown error"},getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(t){return t.result&&n.isArray(t.result.files)?t.result.files:[]},add:function(t,i){if(t.isDefaultPrevented())return!1;var u=n(this),r=u.data("blueimp-yafFileUpload")||u.data("fileupload"),f=r.options;i.context=r._renderUpload(i.files).data("data",i).addClass("processing");f.filesContainer[f.prependFiles?"prepend":"append"](i.context);r._forceReflow(i.context);r._transition(i.context);i.process(function(){return u.yafFileUpload("process",i)}).always(function(){i.context.each(function(t){n(this).find(".size").text(r._formatFileSize(i.files[t].size))}).removeClass("processing");r._renderPreviews(i)}).done(function(){i.context.find(".edit,.start").prop("disabled",!1);r._trigger("added",t,i)!==!1&&(f.autoUpload||i.autoUpload)&&i.autoUpload!==!1&&i.submit()}).fail(function(){i.files.error&&i.context.each(function(t){var r=i.files[t].error;r&&n(this).find(".error").text(r)})})},send:function(t,i){if(t.isDefaultPrevented())return!1;var r=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload");return i.context&&i.dataType&&i.dataType.substr(0,6)==="iframe"&&i.context.find(".progress").addClass(!n.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%"),r._trigger("sent",t,i)},done:function(t,i){if(t.isDefaultPrevented())return!1;var r=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload"),o=i.getFilesFromResponse||r.options.getFilesFromResponse,e=o(i),u,f;i.context?i.context.each(function(o){var s=e[o]||{error:"Empty file upload result"};f=r._addFinishedDeferreds();r._transition(n(this)).done(function(){var e=n(this);u=r._renderDownload([s]).replaceAll(e);r._forceReflow(u);r._transition(u).done(function(){i.context=n(this);r._trigger("completed",t,i);r._trigger("finished",t,i);f.resolve()})})}):(u=r._renderDownload(e)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer),r._forceReflow(u),f=r._addFinishedDeferreds(),r._transition(u).done(function(){i.context=n(this);r._trigger("completed",t,i);r._trigger("finished",t,i);f.resolve()}))},fail:function(t,i){if(t.isDefaultPrevented())return!1;var r=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload"),f,u;i.context?i.context.each(function(e){if(i.errorThrown!=="abort"){var o=i.files[e];o.error=o.error||i.errorThrown||i.i18n("unknownError");u=r._addFinishedDeferreds();r._transition(n(this)).done(function(){var e=n(this);f=r._renderDownload([o]).replaceAll(e);r._forceReflow(f);r._transition(f).done(function(){i.context=n(this);r._trigger("failed",t,i);r._trigger("finished",t,i);u.resolve()})})}else u=r._addFinishedDeferreds(),r._transition(n(this)).done(function(){n(this).remove();r._trigger("failed",t,i);r._trigger("finished",t,i);u.resolve()})}):i.errorThrown!=="abort"?(i.context=r._renderUpload(i.files)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer).data("data",i),r._forceReflow(i.context),u=r._addFinishedDeferreds(),r._transition(i.context).done(function(){i.context=n(this);r._trigger("failed",t,i);r._trigger("finished",t,i);u.resolve()})):(r._trigger("failed",t,i),r._trigger("finished",t,i),r._addFinishedDeferreds().resolve())},progress:function(t,i){if(t.isDefaultPrevented())return!1;var r=Math.floor(i.loaded/i.total*100);i.context&&i.context.each(function(){n(this).find(".progress").attr("aria-valuenow",r).children().first().css("width",r+"%")})},progressall:function(t,i){if(t.isDefaultPrevented())return!1;var r=n(this),u=Math.floor(i.loaded/i.total*100),f=r.find(".fileupload-progress"),e=f.find(".progress-extended");e.length&&e.html((r.data("blueimp-yafFileUpload")||r.data("fileupload"))._renderExtendedProgress(i));f.find(".progress").attr("aria-valuenow",u).children().first().css("width",u+"%")},start:function(t){if(t.isDefaultPrevented())return!1;var i=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload");i._resetFinishedDeferreds();i._transition(n(this).find(".fileupload-progress")).done(function(){i._trigger("started",t)})},stop:function(t){if(t.isDefaultPrevented())return!1;var i=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload"),r=i._addFinishedDeferreds();n.when.apply(n,i._getFinishedDeferreds()).done(function(){i._trigger("stopped",t)});i._transition(n(this).find(".fileupload-progress")).done(function(){n(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");n(this).find(".progress-extended").html("&nbsp;");r.resolve()})},processstart:function(t){if(t.isDefaultPrevented())return!1;n(this).addClass("fileupload-processing")},processstop:function(t){if(t.isDefaultPrevented())return!1;n(this).removeClass("fileupload-processing")},destroy:function(t,i){if(t.isDefaultPrevented())return!1;var r=n(this).data("blueimp-yafFileUpload")||n(this).data("fileupload"),u=function(){r._transition(i.context).done(function(){n(this).remove();r._trigger("destroyed",t,i)})};i.url?(i.dataType=i.dataType||r.options.dataType,n.ajax(i).done(u).fail(function(){r._trigger("destroyfailed",t,i)})):u()}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(t){var i=t||n.Deferred();return this._finishedUploads.push(i),i},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var t=n(this),i=t.prop("href"),r=t.prop("download"),u="application/octet-stream";t.on("dragstart",function(n){try{n.originalEvent.dataTransfer.setData("DownloadURL",[u,r,i].join(":"))}catch(t){}})},_formatFileSize:function(n){return typeof n!="number"?"":n>=1e9?(n/1e9).toFixed(2)+" GB":n>=1e6?(n/1e6).toFixed(2)+" MB":(n/1e3).toFixed(2)+" KB"},_formatBitrate:function(n){return typeof n!="number"?"":n>=1e9?(n/1e9).toFixed(2)+" Gbit/s":n>=1e6?(n/1e6).toFixed(2)+" Mbit/s":n>=1e3?(n/1e3).toFixed(2)+" kbit/s":n.toFixed(2)+" bit/s"},_formatTime:function(n){var i=new Date(n*1e3),t=Math.floor(n/86400);return t=t?t+"d ":"",t+("0"+i.getUTCHours()).slice(-2)+":"+("0"+i.getUTCMinutes()).slice(-2)+":"+("0"+i.getUTCSeconds()).slice(-2)},_formatPercentage:function(n){return(n*100).toFixed(2)+" %"},_renderExtendedProgress:function(n){return this._formatBitrate(n.bitrate)+" | "+this._formatTime((n.total-n.loaded)*8/n.bitrate)+" | "+this._formatPercentage(n.loaded/n.total)+" | "+this._formatFileSize(n.loaded)+" / "+this._formatFileSize(n.total)},_renderTemplate:function(t,i){if(!t)return n();var r=t({files:i,formatFileSize:this._formatFileSize,options:this.options});return r instanceof n?r:n(this.options.templatesContainer).html(r).children()},_renderPreviews:function(t){t.context.find(".preview").each(function(i,r){n(r).empty().append(t.files[i].preview)})},_renderUpload:function(n){return this._renderTemplate(this.options.uploadTemplate,n)},_renderDownload:function(n){return this._renderTemplate(this.options.downloadTemplate,n).find("a[download]").each(this._enableDragToDesktop).end()},_editHandler:function(t){if(t.preventDefault(),this.options.edit){var f=this,e=n(t.currentTarget),r=e.closest(".template-upload"),i=r.data("data"),u=e.data().index;this.options.edit(i.files[u]).then(function(t){t&&(i.files[u]=t,i.context.addClass("processing"),r.find(".edit,.start").prop("disabled",!0),n(f.element).fileupload("process",i).always(function(){r.find(".size").text(f._formatFileSize(i.files[u].size));i.context.removeClass("processing");f._renderPreviews(i)}).done(function(){r.find(".edit,.start").prop("disabled",!1)}).fail(function(){r.find(".edit").prop("disabled",!1);var n=i.files[u].error;n&&r.find(".error").text(n)}))})}},_startHandler:function(t){t.preventDefault();var r=n(t.currentTarget),u=r.closest(".template-upload"),i=u.data("data");r.prop("disabled",!0);i&&i.submit&&i.submit()},_cancelHandler:function(t){t.preventDefault();var r=n(t.currentTarget).closest(".template-upload,.template-download"),i=r.data("data")||{};i.context=i.context||r;i.abort?i.abort():(i.errorThrown="abort",this._trigger("fail",t,i))},_deleteHandler:function(t){t.preventDefault();var i=n(t.currentTarget);this._trigger("destroy",t,n.extend({context:i.closest(".template-download"),type:"DELETE"},i.data()))},_forceReflow:function(t){return n.support.transition&&t.length&&t[0].offsetWidth},_transition:function(t){var i=n.Deferred(),r;return n.support.transition&&t.hasClass("fade")&&t.is(":visible")?(r=function(u){u.target===t[0]&&(t.off(n.support.transition.end,r),i.resolveWith(t))},t.on(n.support.transition.end,r).toggleClass(this.options.showElementClass)):(t.toggleClass(this.options.showElementClass),i.resolveWith(t)),i},_initButtonBarEventHandlers:function(){var t=this.element.find(".fileupload-buttonbar"),i=this.options.filesContainer;this._on(t.find(".start"),{click:function(n){n.preventDefault();i.find(".start").trigger("click")}});this._on(t.find(".cancel"),{click:function(n){n.preventDefault();i.find(".cancel").trigger("click")}});this._on(t.find(".delete"),{click:function(n){n.preventDefault();i.find(".toggle:checked").closest(".template-download").find(".delete").trigger("click");t.find(".toggle").prop("checked",!1)}});this._on(t.find(".toggle"),{change:function(t){i.find(".toggle").prop("checked",n(t.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .edit":this._editHandler,"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){var n=this.options;n.templatesContainer=this.document[0].createElement(n.filesContainer.prop("nodeName"));t&&(n.uploadTemplateId&&(n.uploadTemplate=t(n.uploadTemplateId)),n.downloadTemplateId&&(n.downloadTemplate=t(n.downloadTemplateId)))},_initFilesContainer:function(){var t=this.options;t.filesContainer===undefined?t.filesContainer=this.element.find(".files"):t.filesContainer instanceof n||(t.filesContainer=n(t.filesContainer))},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();n.support.fileInput||this._disableFileInputButton()},enable:function(){var n=!1;this.options.disabled&&(n=!0);this._super();n&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton());this._super()}})});
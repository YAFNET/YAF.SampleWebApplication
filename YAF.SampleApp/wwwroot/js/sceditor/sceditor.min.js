(() => {
    function i(e, t) {
        return typeof t === e;
    }
    var me = i.bind(null, "string"), Ue = i.bind(null, "undefined"), Be = i.bind(null, "function"), a = i.bind(null, "number");
    function l(e) {
        return !Object.keys(e).length;
    }
    function We(e, t) {
        var n = e === !!e, o = n ? 2 : 1, r = n ? t : e, i = n && e;
        function a(e) {
            return null !== e && "object" == typeof e && Object.getPrototypeOf(e) === Object.prototype;
        }
        for (;o < arguments.length; o++) {
            var l, s = arguments[o];
            for (l in s) {
                var c, u, d = r[l], f = s[l];
                Ue(f) || "__proto__" !== l && "constructor" !== l && (u = a(f), 
                c = Array.isArray(f), i && (u || c) ? (u = a(d) === u && Array.isArray(d) === c, 
                r[l] = We(!0, u ? d : c ? [] : {}, f)) : r[l] = f);
            }
        }
        return r;
    }
    function Ve(e, t) {
        t = e.indexOf(t);
        -1 < t && e.splice(t, 1);
    }
    function he(t, n) {
        if (Array.isArray(t) || "length" in t && a(t.length)) for (let e = 0; e < t.length; e++) n(e, t[e]); else Object.keys(t).forEach(function(e) {
            n(e, t[e]);
        });
    }
    var s = {}, ge = 1, ve = 3, c = 8;
    function r(e) {
        return e = parseFloat(e), isFinite(e) ? e : 0;
    }
    function ye(e, t, n) {
        var o = (n || document).createElement(e);
        return he(t || {}, function(e, t) {
            "style" === e ? o.style.cssText = t : e in o ? o[e] = t : o.setAttribute(e, t);
        }), o;
    }
    function u(e, t) {
        for (var n = e || {}; (n = n.parentNode) && !/(9|11)/.test(n.nodeType); ) if (!t || ke(n, t)) return n;
    }
    function Xe(e, t) {
        return ke(e, t) ? e : u(e, t);
    }
    function be(e) {
        e.parentNode && e.parentNode.removeChild(e);
    }
    function we(e, t) {
        e.appendChild(t);
    }
    function xe(e, t) {
        return e.querySelectorAll(t);
    }
    function Te(n, e, o, r, i) {
        e.split(" ").forEach(function(e) {
            var t;
            me(o) ? (t = r["_sce-event-" + e + o] || function(e) {
                for (var t = e.target; t && t !== n; ) {
                    if (ke(t, o)) return void r.call(t, e);
                    t = t.parentNode;
                }
            }, r["_sce-event-" + e + o] = t) : (t = o, i = r), n.addEventListener(e, t, i || !1);
        });
    }
    function Ee(n, e, o, r, i) {
        e.split(" ").forEach(function(e) {
            var t;
            me(o) ? t = r["_sce-event-" + e + o] : (t = o, i = r), n.removeEventListener(e, t, i || !1);
        });
    }
    function Se(e, t, n) {
        if (arguments.length < 3) return e.getAttribute(t);
        null == n ? Ce(e, t) : e.setAttribute(t, n);
    }
    function Ce(e, t) {
        e.removeAttribute(t);
    }
    function Ke(e) {
        De(e, "display", "none");
    }
    function Qe(e) {
        De(e, "display", "");
    }
    function Ze(e) {
        (nt(e) ? Ke : Qe)(e);
    }
    function De(n, e, t) {
        if (arguments.length < 3) {
            if (me(e)) return 1 === n.nodeType ? getComputedStyle(n)[e] : null;
            he(e, function(e, t) {
                De(n, e, t);
            });
        } else {
            var o = (t || 0 === t) && !isNaN(t);
            n.style[e] = o ? t + "px" : t;
        }
    }
    function d(e, t, n) {
        var o = arguments.length, r = {};
        if (e.nodeType === ge) return 1 === o ? (he(e.attributes, function(e, t) {
            /^data\-/i.test(t.name) && (r[t.name.substr(5)] = t.value);
        }), r) : 2 === o ? Se(e, "data-" + t) : void Se(e, "data-" + t, String(n));
    }
    function ke(e, t) {
        var n = !1;
        return n = e && e.nodeType === ge ? (e.matches || e.msMatchesSelector || e.webkitMatchesSelector).call(e, t) : n;
    }
    function Ne(e, t) {
        t.parentNode.insertBefore(e, t);
    }
    function f(e) {
        return e.className.trim().split(/\s+/);
    }
    function _e(e, t) {
        return ke(e, "." + t);
    }
    function Ae(e, t) {
        var n = f(e);
        n.indexOf(t) < 0 && n.push(t), e.className = n.join(" ");
    }
    function Je(e, t) {
        var n = f(e);
        Ve(n, t), e.className = n.join(" ");
    }
    function Me(e, t, n) {
        ((n = Ue(n) ? !_e(e, t) : n) ? Ae : Je)(e, t);
    }
    function et(e, t) {
        var n, o;
        if (Ue(t)) return n = r((o = getComputedStyle(e)).paddingLeft) + r(o.paddingRight), 
        o = r(o.borderLeftWidth) + r(o.borderRightWidth), e.offsetWidth - n - o;
        De(e, "width", t);
    }
    function Re(e, t) {
        var n, o;
        if (Ue(t)) return n = r((o = getComputedStyle(e)).paddingTop) + r(o.paddingBottom), 
        o = r(o.borderTopWidth) + r(o.borderBottomWidth), e.offsetHeight - n - o;
        De(e, "height", t);
    }
    function tt(e, t, n) {
        var o;
        Be(window.CustomEvent) ? o = new CustomEvent(t, {
            bubbles: !0,
            cancelable: !0,
            detail: n
        }) : (o = e.ownerDocument.createEvent("CustomEvent")).initCustomEvent(t, !0, !0, n), 
        e.dispatchEvent(o);
    }
    function nt(e) {
        return e.getClientRects().length;
    }
    function p(e, t, n, o, r) {
        for (e = r ? e.lastChild : e.firstChild; e; ) {
            var i = r ? e.previousSibling : e.nextSibling;
            if (!n && !1 === t(e) || !o && !1 === p(e, t, n, o, r) || n && !1 === t(e)) return !1;
            e = i;
        }
    }
    function ot(e, t, n, o) {
        p(e, t, n, o, !0);
    }
    function rt(e, t) {
        var n = (t = t || document).createDocumentFragment(), o = ye("div", {}, t);
        for (o.innerHTML = e; o.firstChild; ) we(n, o.firstChild);
        return n;
    }
    function it(e) {
        return e && (!ke(e, "p,div") || e.className || Se(e, "style") || !l(d(e)));
    }
    function at(e, t) {
        var n = ye(t, {}, e.ownerDocument);
        for (he(e.attributes, function(e, t) {
            try {
                Se(n, t.name, t.value);
            } catch (e) {}
        }); e.firstChild; ) we(n, e.firstChild);
        return e.parentNode.replaceChild(n, e), n;
    }
    var m = "|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|details|section|article|aside|nav|main|header|hgroup|footer|fieldset|dl|dt|dd|figure|figcaption|";
    function lt(e) {
        return !!/11?|9/.test(e.nodeType) && "|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf(`|${e.nodeName.toLowerCase()}|`) < 0;
    }
    function Oe(e, t) {
        var n = (e || {}).nodeType || ve;
        return n !== ge ? n === ve : "code" === (n = e.tagName.toLowerCase()) ? !t : m.indexOf(`|${n}|`) < 0;
    }
    function h(e) {
        return e.lastChild && h(e.lastChild) && be(e.lastChild), 3 === e.nodeType ? !e.nodeValue : lt(e) && !e.childNodes.length;
    }
    function st(e) {
        p(e, function(t) {
            var n = !Oe(t, !0) && t.nodeType !== c, o = t.parentNode;
            if (n && (Oe(o, !0) || "P" === o.tagName)) {
                let e = t;
                for (;Oe(e.parentNode, !0) || "P" === e.parentNode.tagName; ) e = e.parentNode;
                for (var r = v(e, t), i = t; o && Oe(o, !0); ) {
                    if (o.nodeType === ge) {
                        for (var a = o.cloneNode(); i.firstChild; ) we(a, i.firstChild);
                        we(i, a);
                    }
                    o = o.parentNode;
                }
                Ne(i, e), h(r) || Ne(r, i), h(e) && be(e);
            }
            if (n && ke(t, "ul,ol") && ke(t.parentNode, "ul,ol")) {
                r = "li", n = (n = t).previousElementSibling;
                let e = !r || !n || ke(n, r) ? n : null;
                e || Ne(e = ye("li"), t), we(e, t);
            }
        });
    }
    function g(e, t) {
        return e ? (t ? e.previousSibling : e.nextSibling) || g(e.parentNode, t) : null;
    }
    function ct(e) {
        var t, n, o, r, i, a, l = De(e, "whiteSpace"), s = /line$/i.test(l), c = e.firstChild;
        if (!/pre(\-wrap)?$/i.test(l)) for (;c; ) {
            if (i = c.nextSibling, t = c.nodeValue, (n = c.nodeType) === ge && c.firstChild && ct(c), 
            n === ve) {
                for (n = g(c), o = g(c, !0), a = !1; _e(o, "sceditor-ignore"); ) o = g(o, !0);
                if (Oe(c) && o) {
                    for (r = o; r.lastChild; ) for (r = r.lastChild; _e(r, "sceditor-ignore"); ) r = g(r, !0);
                    a = r.nodeType === ve ? /[\t\n\r ]$/.test(r.nodeValue) : !Oe(r);
                }
                t = t.replace(/\u200B/g, ""), o && Oe(o) && !a || (t = t.replace(s ? /^[\t ]+/ : /^[\t\n\r ]+/, "")), 
                (t = n && Oe(n) ? t : t.replace(s ? /[\t ]+$/ : /[\t\n\r ]+$/, "")).length ? c.nodeValue = t.replace(s ? /[\t ]+/g : /[\t\n\r ]+/g, " ") : be(c);
            }
            c = i;
        }
    }
    function v(e, t) {
        var n = e.ownerDocument.createRange();
        return n.setStartBefore(e), n.setEndAfter(t), n.extractContents();
    }
    function ut(e) {
        for (var t = 0, n = 0; e; ) t += e.offsetLeft, n += e.offsetTop, e = e.offsetParent;
        return {
            left: t,
            top: n
        };
    }
    function y(e, t) {
        var n = e.style;
        return s[t] || (s[t] = t.replace(/^-ms-/, "ms-").replace(/-(\w)/g, function(e, t) {
            return t.toUpperCase();
        })), n = n[t = s[t]], "textAlign" === t && (n = n || De(e, t), De(e.parentNode, t) === n || "block" !== De(e, "display") || ke(e, "hr,th")) ? "" : n;
    }
    function dt(e, t) {
        var n = e.attributes.length;
        if (n === t.attributes.length) {
            for (;n--; ) {
                var o = e.attributes[n];
                if ("style" === o.name ? !((e, t) => {
                    var n = e.style.length;
                    if (n === t.style.length) {
                        for (;n--; ) {
                            var o = e.style[n];
                            if (e.style[o] !== t.style[o]) return;
                        }
                        return 1;
                    }
                })(e, t) : o.value !== Se(t, o.name)) return;
            }
            return 1;
        }
    }
    function ft(e) {
        for (;e.firstChild; ) Ne(e.firstChild, e);
        be(e);
    }
    var pt = {
        toolbar: "bold,italic,underline,strike|font,size,color|mark|email,link,unlink,quote,code|image|note|bulletlist,orderedlist|left,center,right|cut,copy,pastetext,removeformat|undo,redo|youtube,vimeo,instagram,facebook,media,extensions|source|reply",
        toolbarExclude: null,
        maxLength: null,
        styles: [],
        themeMode: Se(document.documentElement, "data-bs-theme") || "light",
        fonts: "Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",
        format: "bbcode",
        icons: "fontawesome",
        codeLanguages: [ {
            Value: "markup",
            Text: "Plain Text"
        }, {
            Value: "bash",
            Text: "Bash(shell)"
        }, {
            Value: "c",
            Text: "C"
        }, {
            Value: "cpp",
            Text: "C++"
        }, {
            Value: "csharp",
            Text: "C#"
        }, {
            Value: "css",
            Text: "CSS"
        }, {
            Value: "scss",
            Text: "SCSS"
        }, {
            Value: "git",
            Text: "Git"
        }, {
            Value: "markup",
            Text: "HTML"
        }, {
            Value: "java",
            Text: "Java"
        }, {
            Value: "javascript",
            Text: "JavaScript"
        }, {
            Value: "json",
            Text: "JSON"
        }, {
            Value: "python",
            Text: "Python"
        }, {
            Value: "sql",
            Text: "SQL"
        }, {
            Value: "markup",
            Text: "XML"
        }, {
            Value: "vb",
            Text: "Visual Basic"
        } ],
        noteTypes: "primary,secondary,success,danger,warning,info,light,dark",
        colors: "#000000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaaaaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#cccccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eeeeee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#ffffff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",
        locale: Se(document.documentElement, "lang") || "en",
        charset: "utf-8",
        width: "100%",
        height: null,
        resizeEnabled: !0,
        resizeMinWidth: null,
        resizeMinHeight: null,
        resizeMaxHeight: null,
        resizeMaxWidth: null,
        resizeHeight: !0,
        resizeWidth: !0,
        dateFormat: "year-month-day",
        toolbarContainer: null,
        enablePasteFiltering: !1,
        disablePasting: !1,
        readOnly: !1,
        rtl: !1,
        autofocus: !1,
        autofocusEnd: !0,
        autoExpand: !1,
        autoUpdate: !1,
        spellcheck: !0,
        runWithoutWysiwygSupport: !1,
        startInSourceMode: !1,
        id: null,
        plugins: "undo,dragdrop",
        zIndex: null,
        bbcodeTrim: !1,
        disableBlockRemove: !0,
        allowedIframeUrls: [],
        parserOptions: {},
        dropDownCss: {},
        allowedTags: [],
        allowedAttributes: [ "contenteditable" ],
        extensionsUrl: "",
        root: "",
        attachmentsPreviewUrl: "",
        albumsPreviewUrl: "",
        onToggleMode: void 0
    }, b = /^(https?|s?ftp|mailto|spotify|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;
    function w(e) {
        return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    }
    function Ie(e, t) {
        var n;
        return e && (!(n = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            "  ": "&nbsp; ",
            "\r\n": "<br />",
            "\r": "<br />",
            "\n": "<br />"
        }) !== t && (n['"'] = "&#34;", n["'"] = "&#39;", n["`"] = "&#96;"), e = e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g, function(e) {
            return n[e] || e;
        })), e;
    }
    var x = {
        html: '<!DOCTYPE html><html data-bs-theme="{themeMode}"><head><meta http-equiv="Content-Type" content="text/html;charset={charset}" />{styles}</head><body style="min-height:265px" contenteditable="true" {spellcheck}><p></p></body></html>',
        style: '<link rel="stylesheet" type="text/css" href="{style}" />',
        toolbarButton: '<a class="btn sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><span unselectable="on">  </span></a>',
        codeOpt: '<a class="sceditor-code-option dropdown-item" href="#" data-language="{language}">{languageName}</a>',
        noteOpt: '<option value="{type}">{type}</option>',
        extensionOpt: '<a class="sceditor-extension-option dropdown-item" href="#" data-language="{extension}">{extension}</a>',
        fontOpt: '<a class="sceditor-font-option dropdown-item" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',
        sizeOpt: '<a class="sceditor-fontsize-option dropdown-item" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',
        albums: '<form class="m-3"><div id="AlbumsListBox" class="content"><div id="AlbumsListPager"></div><div id="PostAlbumsLoader" class="text-center"><div class="fa-3x"><i class="fas fa-spinner fa-pulse"></i></div></div><div id="AlbumsListBox" class="content"><div id="PostAlbumsListPlaceholder" data-url="{root}" style="clear: both; "><div class="container"><div class="AlbumsList row"></div></div></div></div></div></form>',
        note: '<form class="m-3"><div class="mb-3"><label for="type" class="form-label">{labelType}</label> <select class="form-select" id="type" aria-label="note type">{values}</select> </div> <div class="mb-3"><label for="txt" class="form-label">{labelText}</label> <textarea cols="20" rows="7" id="txt" class="form-control textarea-input"></textarea></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></div></form>',
        pastetext: '<form class="m-3"><div class="mb-3"><label for="txt" class="form-label">{label}</label> <textarea cols="20" rows="7" id="txt" class="form-control"></textarea></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></div></form>',
        image: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{url}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><div class="mb-3"><label for="des" class="form-label">{desc}</label> <input type="text" id="des" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        link: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{url}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><div class="mb-3"><label for="des" class="form-label">{desc}</label> <input type="text" id="des" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{ins}" /></form>',
        mediaMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="url" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        youtubeMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        instagramMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        facebookMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        facebook: '<div class="ratio ratio-1x1 border" data-oembed-url="{url}" data-facebook-url="{url}"><iframe src="https://www.facebook.com/plugins/post.php?href={url}"></iframe></div>',
        instagram: '<div class="ratio ratio-1x1 border" data-oembed-url="https://www.instagram.com/p/{id}" data-instagram-url="{url}"><iframe src="https://www.instagram.com/p/{id}/embed/captioned/"></iframe></div>',
        youtube: '<div data-oembed-url="https://youtube.com/embed/{id}" data-youtube-url="{url}" class="ratio ratio-16x9 border"><iframe src="https://youtube.com/embed/{id}?hd=1"></iframe></div>',
        vimeo: '<div data-oembed-url="https://vimeo.com/{vimeoId}" data-vimeo-url="{url}" class="ratio ratio-16x9 border"><iframe src="https://player.vimeo.com/video/{vimeoId}?show_title=1&show_byline=1&show_portrait=1&fullscreen=1"></iframe></div>'
    };
    function Le(e, t, n) {
        var o = x[e];
        return Object.keys(t).forEach(function(e) {
            o = o.replace(new RegExp(w(`{${e}}`), "g"), t[e]);
        }), o = n ? rt(o) : o;
    }
    function T(n) {
        if ("mozHidden" in document) {
            let e = n.getBody(), t;
            for (;e; ) {
                if ((t = e).firstChild) t = t.firstChild; else {
                    for (;t && !t.nextSibling; ) t = t.parentNode;
                    t = t && t.nextSibling;
                }
                3 !== e.nodeType || !/[\n\r\t]+/.test(e.nodeValue) || /^pre/.test(De(e.parentNode, "whiteSpace")) || be(e), 
                e = t;
            }
        }
    }
    var He = {
        albums: {
            exec: function(e) {
                var t = ye("div");
                we(t, Le("albums", {
                    root: this.opts.root
                }, !0)), this.createDropDown(e, "albums", t);
                getAlbumImagesData(6, 0, !1);
            },
            tooltip: "User Albums"
        },
        attachments: {
            exec: function() {
                var e = new window.bootstrap.Modal("#UploadDialog");
                e.show(), e._element.addEventListener("shown.bs.modal", e => {
                    getPaginationData(6, 0, !1);
                });
            },
            tooltip: "User Attachments"
        },
        bold: {
            exec: "bold",
            tooltip: "Bold",
            shortcut: "Ctrl+B"
        },
        italic: {
            exec: "italic",
            tooltip: "Italic",
            shortcut: "Ctrl+I"
        },
        underline: {
            exec: "underline",
            tooltip: "Underline",
            shortcut: "Ctrl+U"
        },
        strike: {
            exec: "strikethrough",
            tooltip: "Strikethrough"
        },
        mark: {
            exec: function() {
                this.wysiwygEditorInsertHtml("<mark>", "</mark>");
            },
            tooltip: "Highlight",
            shortcut: "Ctrl+H"
        },
        left: {
            state: function(e) {
                var t;
                if (e = e && 3 === e.nodeType ? e.parentNode : e) return t = "ltr" === De(e, "direction"), 
                e = De(e, "textAlign"), /left/.test(e) || e === (t ? "start" : "end");
            },
            exec: "justifyleft",
            tooltip: "Align left"
        },
        center: {
            exec: "justifycenter",
            tooltip: "Center"
        },
        right: {
            state: function(e) {
                var t;
                if (e = e && 3 === e.nodeType ? e.parentNode : e) return t = "ltr" === De(e, "direction"), 
                e = De(e, "textAlign"), /right/.test(e) || e === (t ? "end" : "start");
            },
            exec: "justifyright",
            tooltip: "Align right"
        },
        justify: {
            exec: "justifyfull",
            tooltip: "Justify"
        },
        font: {
            _dropDown: function(t, e, n) {
                var o = ye("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "font")), t.closeDropDown(!0), e.preventDefault();
                }), t.opts.fonts.split(",").forEach(function(e) {
                    we(o, Le("fontOpt", {
                        font: e
                    }, !0));
                }), t.createDropDown(e, "font-picker", o);
            },
            exec: function(e) {
                var t = this;
                He.font._dropDown(t, e, function(e) {
                    t.execCommand("fontname", e);
                });
            },
            tooltip: "Font Name"
        },
        size: {
            _dropDown: function(t, e, n) {
                var o = ye("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "size")), t.closeDropDown(!0), e.preventDefault();
                });
                for (let e = 1; e <= 7; e++) we(o, Le("sizeOpt", {
                    size: e
                }, !0));
                t.createDropDown(e, "fontsize-picker", o);
            },
            exec: function(e) {
                var t = this;
                He.size._dropDown(t, e, function(e) {
                    t.execCommand("fontsize", e);
                });
            },
            tooltip: "Font Size"
        },
        color: {
            _dropDown: function(t, e, n) {
                var o = ye("div"), r = "", i = He.color;
                i._htmlCache || (t.opts.colors.split("|").forEach(function(e) {
                    r += '<div class="sceditor-color-column">', e.split(",").forEach(function(e) {
                        r += `<a href="#" class="sceditor-color-option" style="background-color: ${e}" data-color="${e}"></a>`;
                    }), r += "</div>";
                }), i._htmlCache = r), we(o, rt(i._htmlCache)), Te(o, "click", "a", function(e) {
                    n(d(this, "color")), t.closeDropDown(!0), e.preventDefault();
                }), t.createDropDown(e, "color-picker", o);
            },
            exec: function(e) {
                var t = this;
                He.color._dropDown(t, e, function(e) {
                    t.execCommand("forecolor", e);
                });
            },
            tooltip: "Font Color"
        },
        removeformat: {
            exec: "removeformat",
            tooltip: "Remove Formatting"
        },
        cut: {
            exec: "cut",
            tooltip: "Cut",
            errorMessage: "Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"
        },
        copy: {
            exec: "copy",
            tooltip: "Copy",
            errorMessage: "Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"
        },
        paste: {
            exec: "paste",
            tooltip: "Paste",
            errorMessage: "Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"
        },
        pastetext: {
            exec: function(e) {
                var t, n = ye("div"), o = this;
                we(n, Le("pastetext", {
                    label: o._("Paste your text inside the following box:"),
                    insert: o._("Insert")
                }, !0)), Te(n, "click", ".button", function(e) {
                    (t = xe(n, "#txt")[0].value) && o.wysiwygEditorInsertText(t), 
                    o.closeDropDown(!0), e.preventDefault();
                }), o.createDropDown(e, "pastetext", n);
            },
            tooltip: "Paste Text"
        },
        bulletlist: {
            exec: function() {
                T(this), this.execCommand("insertunorderedlist");
            },
            tooltip: "Bullet list"
        },
        orderedlist: {
            exec: function() {
                T(this), this.execCommand("insertorderedlist");
            },
            tooltip: "Numbered list"
        },
        table: {
            exec: function(e) {
                var r = this, i = ye("div");
                we(i, Le("table", {
                    rows: r._("Rows:"),
                    cols: r._("Cols:"),
                    insert: r._("Insert")
                }, !0)), Te(i, "click", ".button", function(e) {
                    var t = Number(xe(i, "#rows")[0].value), n = Number(xe(i, "#cols")[0].value), o = '<table class="table">';
                    0 < t && 0 < n && (o += Array(t + 1).join("<tr>" + Array(n + 1).join('<td class="border"><br /></td>') + "</tr>"), 
                    r.wysiwygEditorInsertHtml(o += "</table>"), r.closeDropDown(!0), 
                    e.preventDefault());
                }), r.createDropDown(e, "inserttable", i);
            },
            tooltip: "Insert a table"
        },
        code: {
            _dropDown: function(t, e, n) {
                var o = ye("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "language")), t.closeDropDown(!0), e.preventDefault();
                }), t.opts.codeLanguages.forEach(function(e) {
                    we(o, Le("codeOpt", {
                        language: e.Value,
                        languageName: e.Text
                    }, !0));
                }), t.createDropDown(e, "codeLanguage-picker", o);
            },
            exec: function(e) {
                var t = this;
                He.code._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertHtml(`<pre class="border border-danger rounded m-2 p-2"><code class="lang-${e}">`, "</code></pre>");
                });
            },
            tooltip: "Code"
        },
        note: {
            exec: function(e) {
                var t, n, o = ye("div"), r = this, i = "";
                r.opts.noteTypes.split(",").forEach(function(e) {
                    i += Le("noteOpt", {
                        type: e
                    }, !1);
                }), we(o, Le("note", {
                    labelType: r._("Select the note type:"),
                    labelText: r._("Enter the note inside the following box:"),
                    insert: r._("Insert"),
                    values: i
                }, !0)), Te(o, "click", ".button", function(e) {
                    n = xe(o, "#txt")[0].value, t = xe(o, "#type")[0].value, n && r.wysiwygEditorInsertHtml(`<div class="alert alert-${t}" role="alert">${n}</div>`), 
                    r.closeDropDown(!0), e.preventDefault();
                }), r.createDropDown(e, "pastetext", o);
            },
            tooltip: "Note"
        },
        extensions: {
            _dropDown: function(t, e, n) {
                var o = ye("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "language")), t.closeDropDown(!0), e.preventDefault();
                }), fetch(t.opts.extensionsUrl, {
                    method: "GET"
                }).then(e => e.json()).then(e => {
                    e.forEach(function(e) {
                        e.useToolbar || we(o, Le("extensionOpt", {
                            extension: e.name
                        }, !0));
                    });
                }), t.createDropDown(e, "extensions-picker", o);
            },
            exec: function(e) {
                var t = this;
                He.extensions._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertText(`[${e}]`, `[/${e}]`);
                });
            },
            tooltip: "More BBCode"
        },
        image: {
            _dropDown: function(n, e, o) {
                var r = ye("div"), i = (we(r, Le("image", {
                    url: n._("URL:"),
                    desc: n._("Description (optional):"),
                    insert: n._("Insert")
                }, !0)), xe(r, "#link")[0]);
                function t(e) {
                    var t = xe(r, "#des")[0].value;
                    i.value && o(i.value, t), n.closeDropDown(!0), e.preventDefault();
                }
                Te(r, "click", ".button", t), Te(r, "keypress", function(e) {
                    13 === e.which && i.value && t(e);
                }, !0), n.createDropDown(e, "insertimage", r);
            },
            exec: function(e) {
                var o = this;
                He.image._dropDown(o, e, function(e, t) {
                    var n = "";
                    t && (n += ` alt="${Ie(t)}"`), n += ` src="${Ie(e)}"`, o.wysiwygEditorInsertHtml(`<img${n} class="img-user-posted img-thumbnail" />`);
                });
            },
            tooltip: "Insert an image"
        },
        email: {
            _dropDown: function(n, e, o) {
                var r = ye("div");
                we(r, Le("email", {
                    label: n._("E-mail:"),
                    desc: n._("Description (optional):"),
                    insert: n._("Insert")
                }, !0)), Te(r, "click", ".button", function(e) {
                    var t = xe(r, "#email")[0].value;
                    t && o(t, xe(r, "#des")[0].value), n.closeDropDown(!0), e.preventDefault();
                }), n.createDropDown(e, "insertemail", r);
            },
            exec: function(e) {
                var n = this;
                He.email._dropDown(n, e, function(e, t) {
                    !n.getRangeHelper().selectedHtml() || t ? n.wysiwygEditorInsertHtml(`<a href="mailto:${Ie(e)}">${Ie(t || e)}</a>`) : n.execCommand("createlink", "mailto:" + e);
                });
            },
            tooltip: "Insert an email"
        },
        link: {
            _dropDown: function(t, e, n) {
                var o = ye("div"), r = (we(o, Le("link", {
                    url: t._("URL:"),
                    desc: t._("Description (optional):"),
                    ins: t._("Insert")
                }, !0)), xe(o, "#link")[0]);
                function i(e) {
                    r.value && n(r.value, xe(o, "#des")[0].value), t.closeDropDown(!0), 
                    e.preventDefault();
                }
                Te(o, "click", ".button", i), Te(o, "keypress", function(e) {
                    13 === e.which && r.value && i(e);
                }, !0), t.createDropDown(e, "insertlink", o);
            },
            exec: function(e) {
                var n = this;
                He.link._dropDown(n, e, function(e, t) {
                    t || !n.getRangeHelper().selectedHtml() ? n.wysiwygEditorInsertHtml(`<a href="${Ie(e)}">${Ie(t || e)}</a>`) : n.execCommand("createlink", e);
                });
            },
            tooltip: "Insert a link"
        },
        unlink: {
            state: function() {
                return Xe(this.currentNode(), "a") ? 0 : -1;
            },
            exec: function() {
                var e = Xe(this.currentNode(), "a");
                if (e) {
                    for (;e.firstChild; ) Ne(e.firstChild, e);
                    be(e);
                }
            },
            tooltip: "Unlink"
        },
        quote: {
            exec: function(e, t, n) {
                var o = '<div class="border rounded mx-3 mb-3 p-3 border-secondary shadow-sm"><span contenteditable="false"><i class="fa fa-quote-left text-primary fs-4 me-2"></i></span>', r = "</div>";
                t ? (o = o + t + (n = n ? `<cite class="card-text text-end d-block text-body-secondary small">${Ie(n)}</cite>` : "") + r, 
                r = null) : this.getRangeHelper().selectedHtml(), this.wysiwygEditorInsertHtml(o, r);
            },
            tooltip: "Insert a Quote"
        },
        media: {
            _dropDown: function(n, e, o) {
                var r = ye("div");
                we(r, Le("mediaMenu", {
                    label: n._("Media URL:"),
                    insert: n._("Insert")
                }, !0)), Te(r, "click", ".button", function(e) {
                    var t = xe(r, "#link")[0].value;
                    t.startsWith("http") ? (o(t), n.closeDropDown(!0), e.preventDefault()) : alert("Not a valid URL!");
                }), n.createDropDown(e, "insertmedia", r);
            },
            exec: function(e) {
                var t = this;
                He.media._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertHtml(`[media]${e}[/media]`);
                });
            },
            tooltip: "Insert an embed media like a YouTube video, facebook post or twitter status."
        },
        vimeo: {
            _dropDown: function(o, e, r) {
                var i = ye("div");
                we(i, Le("youtubeMenu", {
                    label: o._("Video URL:"),
                    insert: o._("Insert")
                }, !0)), Te(i, "click", ".button", function(e) {
                    var t, n = xe(i, "#link")[0].value;
                    "" !== n && (t = n.match(/vimeo\..*\/(\d+)(?:$|\/)/), r(n, t[1])), 
                    o.closeDropDown(!0), e.preventDefault();
                }), o.createDropDown(e, "insertlink", i);
            },
            exec: function(e) {
                var n = this;
                He.vimeo._dropDown(n, e, function(e, t) {
                    n.wysiwygEditorInsertHtml(Le("vimeo", {
                        url: e,
                        vimeoId: t
                    }));
                });
            },
            tooltip: "Insert a Vimeo video"
        },
        instagram: {
            _dropDown: function(o, e, r) {
                var i = ye("div");
                we(i, Le("instagramMenu", {
                    label: o._("Instagram Post URL:"),
                    insert: o._("Insert")
                }, !0)), Te(i, "click", ".button", function(e) {
                    var t, n = xe(i, "#link")[0].value;
                    "" !== n && (t = n.match(/\/(p|tv|reel)\/(.*?)\//)) && (t = t[2], 
                    r(n, t)), o.closeDropDown(!0), e.preventDefault();
                }), o.createDropDown(e, "insertlink", i);
            },
            exec: function(e) {
                var n = this;
                He.instagram._dropDown(n, e, function(e, t) {
                    n.wysiwygEditorInsertHtml(Le("instagram", {
                        url: e,
                        id: t
                    }));
                });
            },
            tooltip: "Insert an Instagram Post"
        },
        facebook: {
            _dropDown: function(n, e, o) {
                var r = ye("div");
                we(r, Le("facebookMenu", {
                    label: n._("Facebook post URL:"),
                    insert: n._("Insert")
                }, !0)), Te(r, "click", ".button", function(e) {
                    var t = xe(r, "#link")[0].value;
                    o(t), n.closeDropDown(!0), e.preventDefault();
                }), n.createDropDown(e, "insertlink", r);
            },
            exec: function(e) {
                var t = this;
                He.facebook._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertHtml(Le("facebook", {
                        url: e
                    }));
                });
            },
            tooltip: "Insert an Facebook Post"
        },
        youtube: {
            _dropDown: function(o, e, r) {
                var i = ye("div");
                we(i, Le("youtubeMenu", {
                    label: o._("Video URL:"),
                    insert: o._("Insert")
                }, !0)), Te(i, "click", ".button", function(e) {
                    var t = xe(i, "#link")[0].value, n = t.match(/(?:v=|v\/|embed\/|youtu.be\/)?([a-zA-Z0-9_-]{11})/);
                    n && /^[a-zA-Z0-9_\-]{11}$/.test(n[1]) && r(t, n[1]), o.closeDropDown(!0), 
                    e.preventDefault();
                }), o.createDropDown(e, "insertlink", i);
            },
            exec: function(e) {
                var n = this;
                He.youtube._dropDown(n, e, function(e, t) {
                    n.wysiwygEditorInsertHtml(Le("youtube", {
                        url: e,
                        id: t
                    }));
                });
            },
            tooltip: "Insert a YouTube video"
        },
        date: {
            _date: function(e) {
                var t = new Date(), n = t.getYear(), o = t.getMonth() + 1, t = t.getDate();
                return o < 10 && (o = "0" + o), t < 10 && (t = "0" + t), e.opts.dateFormat.replace(/year/i, n = n < 2e3 ? 1900 + n : n).replace(/month/i, o).replace(/day/i, t);
            },
            exec: function() {
                this.insertText(He.date._date(this));
            },
            txtExec: function() {
                this.insertText(He.date._date(this));
            },
            tooltip: "Insert current date"
        },
        time: {
            _time: function() {
                var e = new Date(), t = e.getHours(), n = e.getMinutes(), e = e.getSeconds();
                return (t = t < 10 ? "0" + t : t) + ":" + (n = n < 10 ? "0" + n : n) + ":" + (e = e < 10 ? "0" + e : e);
            },
            exec: function() {
                this.insertText(He.time._time());
            },
            txtExec: function() {
                this.insertText(He.time._time());
            },
            tooltip: "Insert current time"
        },
        undo: {
            exec: "undo",
            tooltip: "Undo",
            shortcut: "Ctrl+Z"
        },
        redo: {
            exec: "redo",
            tooltip: "Redo",
            shortcut: "Ctrl+Y"
        },
        maximize: {
            state: function() {
                return this.maximize();
            },
            exec: function() {
                this.maximize(!this.maximize()), this.focus();
            },
            txtExec: function() {
                this.maximize(!this.maximize()), this.focus();
            },
            tooltip: "Maximize",
            shortcut: "Ctrl+Shift+M"
        },
        source: {
            state: function() {
                return this.sourceMode();
            },
            exec: function() {
                this.toggleSourceMode(), this.focus();
            },
            txtExec: function() {
                this.toggleSourceMode(), this.focus();
            },
            tooltip: "View source",
            shortcut: "Ctrl+Shift+S"
        },
        reply: {
            exec: function() {
                null !== document.getElementById("QuickReplyDialog") ? document.querySelector('[data-bs-save*="modal"]').click() : null !== document.querySelector('[formaction*="PostReply"]') ? document.querySelector('[formaction*="PostReply"]').click() : null !== document.querySelector('[id*="QuickReply"]') ? document.querySelector('[id*="QuickReply"]').click() : null !== document.querySelector('[id*="PostReply"]') && (window.location.href = document.querySelector('[id*="PostReply"]').href);
            },
            tooltip: "Post Reply",
            shortcut: "Ctrl+Enter"
        },
        ignore: {}
    }, E = {};
    function mt(i) {
        function a(e) {
            return "signal" + e.charAt(0).toUpperCase() + e.slice(1);
        }
        function e(e, t) {
            e = [].slice.call(e);
            for (var n, o = a(e.shift()), r = 0; r < l.length; r++) if (o in l[r] && (n = l[r][o].apply(i, e), 
            t)) return n;
        }
        var r = this, l = [];
        r.call = function() {
            e(arguments, !1);
        }, r.callOnlyFirst = function() {
            return e(arguments, !0);
        }, r.hasHandler = function(e) {
            var t = l.length;
            for (e = a(e); t--; ) if (e in l[t]) return !0;
            return !1;
        }, r.exists = function(e) {
            return e in E && "function" == typeof (e = E[e]) && "object" == typeof e.prototype;
        }, r.isRegistered = function(t) {
            if (r.exists(t)) {
                let e = l.length;
                for (;e--; ) if (l[e] instanceof E[t]) return !0;
            }
            return !1;
        }, r.register = function(e) {
            return !(!r.exists(e) || r.isRegistered(e) || (e = new E[e](), l.push(e), 
            "init" in e && e.init.call(i), 0));
        }, r.deregister = function(e) {
            var t, n = l.length, o = !1;
            if (r.isRegistered(e)) for (;n--; ) l[n] instanceof E[e] && (o = !0, 
            "destroy" in (t = l.splice(n, 1)[0])) && t.destroy.call(i);
            return o;
        }, r.destroy = function() {
            for (var e = l.length; e--; ) "destroy" in l[e] && l[e].destroy.call(i);
            l = [], i = null;
        };
    }
    mt.plugins = E;
    var S = function(e, t, n) {
        var o, r, i, a, l, s = "", c = e.startContainer, u = e.startOffset;
        for (c && 3 !== c.nodeType && (c = c.childNodes[u], u = 0), i = a = u; n > s.length && c && 3 === c.nodeType; ) o = c.nodeValue, 
        r = n - s.length, l && (a = o.length, i = 0), l = c, c = t ? (u = i = Math.max(a - r, 0), 
        s = o.substr(i, a - i) + s, l.previousSibling) : (u = i + (a = Math.min(r, o.length)), 
        s += o.substr(i, a), l.nextSibling);
        return {
            node: l || c,
            offset: u,
            text: s
        };
    };
    function ht(r, e, i) {
        var a, l, s = e || r.contentDocument || r.document, c = "sceditor-start-marker", u = "sceditor-end-marker", g = this;
        g.insertHTML = function(e, t) {
            if (!g.selectedRange()) return !1;
            t && (e += g.selectedHtml() + t);
            var n = ye("p", {}, s), o = s.createDocumentFragment();
            for (n.innerHTML = i(e); n.firstChild; ) we(o, n.firstChild);
            g.insertNode(o);
        }, l = function(e, t, n) {
            var o, r = s.createDocumentFragment();
            if ("string" == typeof e ? (t && (e += g.selectedHtml() + t), r = rt(e)) : (we(r, e), 
            t && (we(r, g.selectedRange().extractContents()), we(r, t))), o = r.lastChild) {
                for (;!Oe(o.lastChild, !0); ) o = o.lastChild;
                return lt(o) ? o.lastChild || we(o, document.createTextNode("​")) : o = r, 
                g.removeMarkers(), we(o, a(c)), we(o, a(u)), n ? (we(e = ye("div"), r), 
                e.innerHTML) : r;
            }
        }, g.insertNode = function(e, t) {
            var n, o, e = l(e, t), t = g.selectedRange(), r = t.commonAncestorContainer, i = [];
            if (!e) return !1;
            function a(e) {
                e && h(e) && i.indexOf(e) < 0 && be(e);
            }
            t.startContainer !== t.endContainer && (he(r.childNodes, function(e, t) {
                h(t) && i.push(t);
            }), n = e.firstChild, o = e.lastChild), t.deleteContents(), r && 3 !== r.nodeType && !lt(r) ? Ne(e, r) : (t.insertNode(e), 
            a(n && n.previousSibling), a(o && o.nextSibling)), g.restoreRange();
        }, g.cloneSelected = function() {
            var e = g.selectedRange();
            if (e) return e.cloneRange();
        }, g.selectedRange = function() {
            var e, t, n = r.getSelection();
            if (n) {
                if (n.rangeCount <= 0) {
                    for (t = s.body; t.firstChild; ) t = t.firstChild;
                    (e = s.createRange()).setStartBefore(t), n.addRange(e);
                }
                return e = 0 < n.rangeCount ? n.getRangeAt(0) : e;
            }
        }, g.hasSelection = function() {
            var e = r.getSelection();
            return e && 0 < e.rangeCount;
        }, g.selectedHtml = function() {
            var e, t = g.selectedRange();
            return t ? (we(e = ye("p", {}, s), t.cloneContents()), e.innerHTML) : "";
        }, g.parentNode = function() {
            var e = g.selectedRange();
            if (e) return e.commonAncestorContainer;
        }, g.getFirstBlockParent = function(e) {
            var t = function(e) {
                return Oe(e, !0) ? (e = e ? e.parentNode : null) && t(e) : e;
            };
            return t(e || g.parentNode());
        }, g.insertNodeAt = function(e, t) {
            var n = g.selectedRange(), o = g.cloneSelected();
            if (!o) return !1;
            o.collapse(e), o.insertNode(t), g.selectRange(n);
        }, a = function(e) {
            g.removeMarker(e);
            e = ye("span", {
                id: e,
                className: "sceditor-selection sceditor-ignore",
                style: "display:none;line-height:0"
            }, s);
            return e.innerHTML = " ", e;
        }, g.insertMarkers = function() {
            var e = g.selectedRange(), t = a(c);
            g.removeMarkers(), g.insertNodeAt(!0, t), e && e.collapsed ? t.parentNode.insertBefore(a(u), t.nextSibling) : g.insertNodeAt(!1, a(u));
        }, g.getMarker = function(e) {
            return s.getElementById(e);
        }, g.removeMarker = function(e) {
            e = g.getMarker(e);
            e && be(e);
        }, g.removeMarkers = function() {
            g.removeMarker(c), g.removeMarker(u);
        }, g.saveRange = function() {
            g.insertMarkers();
        }, g.selectRange = function(e) {
            var t, n = r.getSelection(), o = e.endContainer;
            if (e.collapsed && o && !Oe(o, !0)) {
                for (t = o.lastChild; t && ke(t, ".sceditor-ignore"); ) t = t.previousSibling;
                ke(t, "br") && ((o = s.createRange()).setEndAfter(t), o.collapse(!1), 
                g.compare(e, o)) && (e.setStartBefore(t), e.collapse(!0));
            }
            n && (g.clear(), n.addRange(e));
        }, g.restoreRange = function() {
            var e, t = g.selectedRange(), n = g.getMarker(c), o = g.getMarker(u);
            if (!n || !o || !t) return !1;
            e = n.nextSibling === o, (t = s.createRange()).setStartBefore(n), t.setEndAfter(o), 
            e && t.collapse(!0), g.selectRange(t), g.removeMarkers();
        }, g.selectOuterText = function(e, t) {
            var n = g.cloneSelected();
            if (!n) return !1;
            n.collapse(!1), e = S(n, !0, e), t = S(n, !1, t), n.setStart(e.node, e.offset), 
            n.setEnd(t.node, t.offset), g.selectRange(n);
        }, g.getOuterText = function(e, t) {
            var n = g.cloneSelected();
            return n ? (n.collapse(!e), S(n, e, t).text) : "";
        }, g.replaceKeyword = function(e, t, n, o, r, i) {
            n || e.sort(function(e, t) {
                return e[0].length - t[0].length;
            });
            var a, l, s, c, u, d, f, p = "(^|[\\s    ])", m = e.length, h = r ? 1 : 0, n = o || e[m - 1][0].length;
            for (r && n++, i = i || "", c = (a = g.getOuterText(!0, n)).length, 
            a += i, t && (a += g.getOuterText(!1, n)); m--; ) if (f = (d = e[m][0]).length, 
            s = Math.max(0, c - f - h), l = -1, r ? (u = a.substr(s).match(new RegExp(p + w(d) + p))) && (l = u.index + s + u[1].length) : l = a.indexOf(d, s), 
            -1 < l && l <= c && c <= l + f + h) return g.selectOuterText(u = c - l, f - u - (/^\S/.test(i) ? 1 : 0)), 
            g.insertHTML(e[m][1]), !0;
            return !1;
        }, g.compare = function(e, t) {
            return t = t || g.selectedRange(), e && t ? 0 === e.compareBoundaryPoints(Range.END_TO_END, t) && 0 === e.compareBoundaryPoints(Range.START_TO_START, t) : !e && !t;
        }, g.clear = function() {
            var e = r.getSelection();
            e && (e.removeAllRanges ? e.removeAllRanges() : e.empty && e.empty());
        };
    }
    var C, e = navigator.userAgent, gt = /iPhone|iPod|iPad| wosbrowser\//i.test(e), vt = (O = !!window.document.documentMode, 
    I = "-ms-ime-align" in document.documentElement.style, (n = document.createElement("div")).contentEditable = !0, 
    "contentEditable" in document.documentElement && "true" === n.contentEditable && (n = /Opera Mobi|Opera Mini/i.test(e), 
    /Android/i.test(e) && (n = !0, /Safari/.test(e)) && (n = !(R = /Safari\/(\d+)/.exec(e)) || !R[1] || R[1] < 534), 
    / Silk\//i.test(e) && (n = !(R = /AppleWebKit\/(\d+)/.exec(e)) || !R[1] || R[1] < 534), 
    gt && (n = /OS [0-4](_\d)+ like Mac/i.test(e)), /Firefox/i.test(e) && (n = !1), 
    /OneBrowser/i.test(e) && (n = !1), "UCWEB" === navigator.vendor && (n = !1), 
    !(n = O || I ? !0 : n)));
    let {
        entries: yt,
        setPrototypeOf: D,
        isFrozen: k,
        getPrototypeOf: N,
        getOwnPropertyDescriptor: _
    } = Object, {
        freeze: je,
        seal: t,
        create: bt
    } = Object, {
        apply: A,
        construct: M
    } = "undefined" != typeof Reflect && Reflect, wt = (je = je || function(e) {
        return e;
    }, t = t || function(e) {
        return e;
    }, A = A || function(e, t, n) {
        return e.apply(t, n);
    }, M = M || function(e, t) {
        return new e(...t);
    }, o(Array.prototype.forEach)), xt = o(Array.prototype.lastIndexOf), Tt = o(Array.prototype.pop), Et = o(Array.prototype.push), St = o(Array.prototype.splice), Ct = o(String.prototype.toLowerCase), Dt = o(String.prototype.toString), kt = o(String.prototype.match), Nt = o(String.prototype.replace), _t = o(String.prototype.indexOf), At = o(String.prototype.trim), $e = o(Object.prototype.hasOwnProperty), Ge = o(RegExp.prototype.test), Mt = (C = TypeError, 
    function() {
        for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];
        return M(C, t);
    });
    function o(r) {
        return function(e) {
            e instanceof RegExp && (e.lastIndex = 0);
            for (var t = arguments.length, n = new Array(1 < t ? t - 1 : 0), o = 1; o < t; o++) n[o - 1] = arguments[o];
            return A(r, e, n);
        };
    }
    function Ye(t, n, e) {
        var o, r = 2 < arguments.length && void 0 !== e ? e : Ct;
        D && D(t, null);
        let i = n.length;
        for (;i--; ) {
            let e = n[i];
            "string" == typeof e && (o = r(e)) !== e && (k(n) || (n[i] = o), e = o), 
            t[e] = !0;
        }
        return t;
    }
    function qe(e) {
        var t, n, o = bt(null);
        for ([ t, n ] of yt(e)) $e(e, t) && (Array.isArray(n) ? o[t] = (t => {
            for (let e = 0; e < t.length; e++) $e(t, e) || (t[e] = null);
            return t;
        })(n) : n && "object" == typeof n && n.constructor === Object ? o[t] = qe(n) : o[t] = n);
        return o;
    }
    function Rt(e, t) {
        for (;null !== e; ) {
            var n = _(e, t);
            if (n) {
                if (n.get) return o(n.get);
                if ("function" == typeof n.value) return o(n.value);
            }
            e = N(e);
        }
        return function() {
            return null;
        };
    }
    let Ot = je([ "a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr" ]), It = je([ "svg", "a", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "circle", "clippath", "defs", "desc", "ellipse", "filter", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "style", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "view", "vkern" ]), Lt = je([ "feBlend", "feColorMatrix", "feComponentTransfer", "feComposite", "feConvolveMatrix", "feDiffuseLighting", "feDisplacementMap", "feDistantLight", "feDropShadow", "feFlood", "feFuncA", "feFuncB", "feFuncG", "feFuncR", "feGaussianBlur", "feImage", "feMerge", "feMergeNode", "feMorphology", "feOffset", "fePointLight", "feSpecularLighting", "feSpotLight", "feTile", "feTurbulence" ]), Ht = je([ "animate", "color-profile", "cursor", "discard", "font-face", "font-face-format", "font-face-name", "font-face-src", "font-face-uri", "foreignobject", "hatch", "hatchpath", "mesh", "meshgradient", "meshpatch", "meshrow", "missing-glyph", "script", "set", "solidcolor", "unknown", "use" ]), Ft = je([ "math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmultiscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mspace", "msqrt", "mstyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover", "mprescripts" ]), Pt = je([ "maction", "maligngroup", "malignmark", "mlongdiv", "mscarries", "mscarry", "msgroup", "mstack", "msline", "msrow", "semantics", "annotation", "annotation-xml", "mprescripts", "none" ]), zt = je([ "#text" ]), Ut = je([ "accept", "action", "align", "alt", "autocapitalize", "autocomplete", "autopictureinpicture", "autoplay", "background", "bgcolor", "border", "capture", "cellpadding", "cellspacing", "checked", "cite", "class", "clear", "color", "cols", "colspan", "controls", "controlslist", "coords", "crossorigin", "datetime", "decoding", "default", "dir", "disabled", "disablepictureinpicture", "disableremoteplayback", "download", "draggable", "enctype", "enterkeyhint", "face", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "inputmode", "integrity", "ismap", "kind", "label", "lang", "list", "loading", "loop", "low", "max", "maxlength", "media", "method", "min", "minlength", "multiple", "muted", "name", "nonce", "noshade", "novalidate", "nowrap", "open", "optimum", "pattern", "placeholder", "playsinline", "popover", "popovertarget", "popovertargetaction", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "role", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "sizes", "span", "srclang", "start", "src", "srcset", "step", "style", "summary", "tabindex", "title", "translate", "type", "usemap", "valign", "value", "width", "wrap", "xmlns", "slot" ]), Bt = je([ "accent-height", "accumulate", "additive", "alignment-baseline", "amplitude", "ascent", "attributename", "attributetype", "azimuth", "basefrequency", "baseline-shift", "begin", "bias", "by", "class", "clip", "clippathunits", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dx", "dy", "diffuseconstant", "direction", "display", "divisor", "dur", "edgemode", "elevation", "end", "exponent", "fill", "fill-opacity", "fill-rule", "filter", "filterunits", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "font-weight", "fx", "fy", "g1", "g2", "glyph-name", "glyphref", "gradientunits", "gradienttransform", "height", "href", "id", "image-rendering", "in", "in2", "intercept", "k", "k1", "k2", "k3", "k4", "kerning", "keypoints", "keysplines", "keytimes", "lang", "lengthadjust", "letter-spacing", "kernelmatrix", "kernelunitlength", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "markerheight", "markerunits", "markerwidth", "maskcontentunits", "maskunits", "max", "mask", "media", "method", "mode", "min", "name", "numoctaves", "offset", "operator", "opacity", "order", "orient", "orientation", "origin", "overflow", "paint-order", "path", "pathlength", "patterncontentunits", "patterntransform", "patternunits", "points", "preservealpha", "preserveaspectratio", "primitiveunits", "r", "rx", "ry", "radius", "refx", "refy", "repeatcount", "repeatdur", "restart", "result", "rotate", "scale", "seed", "shape-rendering", "slope", "specularconstant", "specularexponent", "spreadmethod", "startoffset", "stddeviation", "stitchtiles", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "style", "surfacescale", "systemlanguage", "tabindex", "tablevalues", "targetx", "targety", "transform", "transform-origin", "text-anchor", "text-decoration", "text-rendering", "textlength", "type", "u1", "u2", "unicode", "values", "viewbox", "visibility", "version", "vert-adv-y", "vert-origin-x", "vert-origin-y", "width", "word-spacing", "wrap", "writing-mode", "xchannelselector", "ychannelselector", "x", "x1", "x2", "xmlns", "y", "y1", "y2", "z", "zoomandpan" ]), Wt = je([ "accent", "accentunder", "align", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "dir", "display", "displaystyle", "encoding", "fence", "frame", "height", "href", "id", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "width", "xmlns" ]), Vt = je([ "xlink:href", "xml:id", "xlink:title", "xml:space", "xmlns:xlink" ]);
    var R = t(/\{\{[\w\W]*|[\w\W]*\}\}/gm), e = t(/<%[\w\W]*|[\w\W]*%>/gm), O = t(/\$\{[\w\W]*/gm), I = t(/^data-[\-\w.\u00B7-\uFFFF]+$/), n = t(/^aria-[\-\w]+$/);
    let jt = t(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);
    var L = t(/^(?:\w+script|data):/i), H = t(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g);
    let $t = t(/^html$/i);
    var F = t(/^[a-z][.\w]*(-[.\w]+)+$/i), Gt = Object.freeze({
        __proto__: null,
        ARIA_ATTR: n,
        ATTR_WHITESPACE: H,
        CUSTOM_ELEMENT: F,
        DATA_ATTR: I,
        DOCTYPE_NAME: $t,
        ERB_EXPR: e,
        IS_ALLOWED_URI: jt,
        IS_SCRIPT_OR_DATA: L,
        MUSTACHE_EXPR: R,
        TMPLIT_EXPR: O
    });
    function Yt() {
        return {
            afterSanitizeAttributes: [],
            afterSanitizeElements: [],
            afterSanitizeShadowDOM: [],
            beforeSanitizeAttributes: [],
            beforeSanitizeElements: [],
            beforeSanitizeShadowDOM: [],
            uponSanitizeAttribute: [],
            uponSanitizeElement: [],
            uponSanitizeShadowNode: []
        };
    }
    let qt = {
        element: 1,
        attribute: 2,
        text: 3,
        cdataSection: 4,
        entityReference: 5,
        entityNode: 6,
        progressingInstruction: 7,
        comment: 8,
        document: 9,
        documentType: 10,
        documentFragment: 11,
        notation: 12
    };
    var Xt = function i(e) {
        e = 0 < arguments.length && void 0 !== e ? e : "undefined" == typeof window ? null : window;
        let c = e => i(e);
        if (c.version = "3.2.5", c.removed = [], !e || !e.document || e.document.nodeType !== qt.document || !e.Element) return c.isSupported = !1, 
        c;
        let r = e.document, l = r, F = l.currentScript, {
            DocumentFragment: P,
            HTMLTemplateElement: z,
            Node: s,
            Element: U,
            NodeFilter: t,
            NamedNodeMap: B = e.NamedNodeMap || e.MozNamedAttrMap,
            HTMLFormElement: W,
            DOMParser: V,
            trustedTypes: u
        } = e;
        e = U.prototype;
        let j = Rt(e, "cloneNode"), $ = Rt(e, "remove"), G = Rt(e, "nextSibling"), Y = Rt(e, "childNodes"), a = Rt(e, "parentNode");
        "function" == typeof z && (e = r.createElement("template")).content && e.content.ownerDocument && (r = e.content.ownerDocument);
        function q(e) {
            return e instanceof RegExp || e instanceof Function;
        }
        function d() {
            let e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
            if (!o || o !== e) {
                if (e = qe(e = e && "object" == typeof e ? e : {}), O = -1 === Le.indexOf(e.PARSER_MEDIA_TYPE) ? "text/html" : e.PARSER_MEDIA_TYPE, 
                I = "application/xhtml+xml" === O ? Dt : Ct, g = $e(e, "ALLOWED_TAGS") ? Ye({}, e.ALLOWED_TAGS, I) : pe, 
                v = $e(e, "ALLOWED_ATTR") ? Ye({}, e.ALLOWED_ATTR, I) : me, Re = $e(e, "ALLOWED_NAMESPACES") ? Ye({}, e.ALLOWED_NAMESPACES, Dt) : Oe, 
                _e = $e(e, "ADD_URI_SAFE_ATTR") ? Ye(qe(Ae), e.ADD_URI_SAFE_ATTR, I) : Ae, 
                ke = $e(e, "ADD_DATA_URI_TAGS") ? Ye(qe(Ne), e.ADD_DATA_URI_TAGS, I) : Ne, 
                D = $e(e, "FORBID_CONTENTS") ? Ye({}, e.FORBID_CONTENTS, I) : De, 
                b = $e(e, "FORBID_TAGS") ? Ye({}, e.FORBID_TAGS, I) : {}, he = $e(e, "FORBID_ATTR") ? Ye({}, e.FORBID_ATTR, I) : {}, 
                n = !!$e(e, "USE_PROFILES") && e.USE_PROFILES, ge = !1 !== e.ALLOW_ARIA_ATTR, 
                ve = !1 !== e.ALLOW_DATA_ATTR, ye = e.ALLOW_UNKNOWN_PROTOCOLS || !1, 
                be = !1 !== e.ALLOW_SELF_CLOSE_IN_ATTR, w = e.SAFE_FOR_TEMPLATES || !1, 
                we = !1 !== e.SAFE_FOR_XML, x = e.WHOLE_DOCUMENT || !1, T = e.RETURN_DOM || !1, 
                E = e.RETURN_DOM_FRAGMENT || !1, S = e.RETURN_TRUSTED_TYPE || !1, 
                Te = e.FORCE_BODY || !1, Ee = !1 !== e.SANITIZE_DOM, Se = e.SANITIZE_NAMED_PROPS || !1, 
                Ce = !1 !== e.KEEP_CONTENT, C = e.IN_PLACE || !1, fe = e.ALLOWED_URI_REGEXP || jt, 
                A = e.NAMESPACE || _, M = e.MATHML_TEXT_INTEGRATION_POINTS || M, 
                R = e.HTML_INTEGRATION_POINTS || R, y = e.CUSTOM_ELEMENT_HANDLING || {}, 
                e.CUSTOM_ELEMENT_HANDLING && q(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck) && (y.tagNameCheck = e.CUSTOM_ELEMENT_HANDLING.tagNameCheck), 
                e.CUSTOM_ELEMENT_HANDLING && q(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck) && (y.attributeNameCheck = e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck), 
                e.CUSTOM_ELEMENT_HANDLING && "boolean" == typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (y.allowCustomizedBuiltInElements = e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements), 
                w && (ve = !1), E && (T = !0), n && (g = Ye({}, zt), v = [], !0 === n.html && (Ye(g, Ot), 
                Ye(v, Ut)), !0 === n.svg && (Ye(g, It), Ye(v, Bt), Ye(v, Vt)), !0 === n.svgFilters && (Ye(g, Lt), 
                Ye(v, Bt), Ye(v, Vt)), !0 === n.mathMl) && (Ye(g, Ft), Ye(v, Wt), 
                Ye(v, Vt)), e.ADD_TAGS && Ye(g = g === pe ? qe(g) : g, e.ADD_TAGS, I), 
                e.ADD_ATTR && Ye(v = v === me ? qe(v) : v, e.ADD_ATTR, I), e.ADD_URI_SAFE_ATTR && Ye(_e, e.ADD_URI_SAFE_ATTR, I), 
                e.FORBID_CONTENTS && Ye(D = D === De ? qe(D) : D, e.FORBID_CONTENTS, I), 
                Ce && (g["#text"] = !0), x && Ye(g, [ "html", "head", "body" ]), 
                g.table && (Ye(g, [ "tbody" ]), delete b.tbody), e.TRUSTED_TYPES_POLICY) {
                    if ("function" != typeof e.TRUSTED_TYPES_POLICY.createHTML) throw Mt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');
                    if ("function" != typeof e.TRUSTED_TYPES_POLICY.createScriptURL) throw Mt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');
                    p = e.TRUSTED_TYPES_POLICY, m = p.createHTML("");
                } else null !== (p = void 0 === p ? ((e, t) => {
                    if ("object" != typeof e || "function" != typeof e.createPolicy) return null;
                    let n = null;
                    var o = "data-tt-policy-suffix", t = "dompurify" + ((n = t && t.hasAttribute(o) ? t.getAttribute(o) : n) ? "#" + n : "");
                    try {
                        return e.createPolicy(t, {
                            createHTML(e) {
                                return e;
                            },
                            createScriptURL(e) {
                                return e;
                            }
                        });
                    } catch (e) {
                        return console.warn("TrustedTypes policy " + t + " could not be created."), 
                        null;
                    }
                })(u, F) : p) && "string" == typeof m && (m = p.createHTML(""));
                je && je(e), o = e;
            }
        }
        function f(e, t) {
            try {
                Et(c.removed, {
                    attribute: t.getAttributeNode(e),
                    from: t
                });
            } catch (e) {
                Et(c.removed, {
                    attribute: null,
                    from: t
                });
            }
            if (t.removeAttribute(e), "is" === e) if (T || E) try {
                L(t);
            } catch (e) {} else try {
                t.setAttribute(e, "");
            } catch (e) {}
        }
        function X(e) {
            let t = null, n = null;
            Te ? e = "<remove></remove>" + e : (o = kt(e, /^[\r\n\t ]+/), n = o && o[0]), 
            "application/xhtml+xml" === O && A === _ && (e = '<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>' + e + "</body></html>");
            var o = p ? p.createHTML(e) : e;
            if (A === _) try {
                t = new V().parseFromString(o, O);
            } catch (e) {}
            if (!t || !t.documentElement) {
                t = J.createDocument(A, "template", null);
                try {
                    t.documentElement.innerHTML = Me ? m : o;
                } catch (e) {}
            }
            return o = t.body || t.documentElement, e && n && o.insertBefore(r.createTextNode(n), o.childNodes[0] || null), 
            A === _ ? ne.call(t, x ? "html" : "body")[0] : x ? t.documentElement : o;
        }
        function K(e) {
            return ee.call(e.ownerDocument || e, e, t.SHOW_ELEMENT | t.SHOW_COMMENT | t.SHOW_TEXT | t.SHOW_PROCESSING_INSTRUCTION | t.SHOW_CDATA_SECTION, null);
        }
        function Q(e) {
            return e instanceof W && ("string" != typeof e.nodeName || "string" != typeof e.textContent || "function" != typeof e.removeChild || !(e.attributes instanceof B) || "function" != typeof e.removeAttribute || "function" != typeof e.setAttribute || "string" != typeof e.namespaceURI || "function" != typeof e.insertBefore || "function" != typeof e.hasChildNodes);
        }
        function Z(e) {
            return "function" == typeof s && e instanceof s;
        }
        let p, m = "", {
            implementation: J,
            createNodeIterator: ee,
            createDocumentFragment: te,
            getElementsByTagName: ne
        } = r, oe = l.importNode, h = Yt(), {
            MUSTACHE_EXPR: re,
            ERB_EXPR: ie,
            TMPLIT_EXPR: ae,
            DATA_ATTR: le,
            ARIA_ATTR: se,
            IS_SCRIPT_OR_DATA: ce,
            ATTR_WHITESPACE: ue,
            CUSTOM_ELEMENT: de
        } = (c.isSupported = "function" == typeof yt && "function" == typeof a && J && void 0 !== J.createHTMLDocument, 
        Gt), fe = Gt.IS_ALLOWED_URI, g = null, pe = Ye({}, [ ...Ot, ...It, ...Lt, ...Ft, ...zt ]), v = null, me = Ye({}, [ ...Ut, ...Bt, ...Wt, ...Vt ]), y = Object.seal(bt(null, {
            tagNameCheck: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: null
            },
            attributeNameCheck: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: null
            },
            allowCustomizedBuiltInElements: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: !1
            }
        })), b = null, he = null, ge = !0, ve = !0, ye = !1, be = !0, w = !1, we = !0, x = !1, xe = !1, Te = !1, T = !1, E = !1, S = !1, Ee = !0, Se = !1, Ce = !0, C = !1, n = {}, D = null, De = Ye({}, [ "annotation-xml", "audio", "colgroup", "desc", "foreignobject", "head", "iframe", "math", "mi", "mn", "mo", "ms", "mtext", "noembed", "noframes", "noscript", "plaintext", "script", "style", "svg", "template", "thead", "title", "video", "xmp" ]), ke = null, Ne = Ye({}, [ "audio", "video", "img", "source", "image", "track" ]), _e = null, Ae = Ye({}, [ "alt", "class", "for", "id", "label", "name", "pattern", "placeholder", "role", "summary", "title", "value", "style", "xmlns" ]), k = "http://www.w3.org/1998/Math/MathML", N = "http://www.w3.org/2000/svg", _ = "http://www.w3.org/1999/xhtml", A = _, Me, Re = null, Oe = Ye({}, [ k, N, _ ], Dt), M = Ye({}, [ "mi", "mo", "mn", "ms", "mtext" ]), R = Ye({}, [ "annotation-xml" ]), Ie = Ye({}, [ "title", "style", "font", "a", "script" ]), O = null, Le = [ "application/xhtml+xml", "text/html" ], I = null, o = null, He = r.createElement("form"), Fe = Ye({}, [ ...It, ...Lt, ...Ht ]), Pe = Ye({}, [ ...Ft, ...Pt ]), L = function(t) {
            Et(c.removed, {
                element: t
            });
            try {
                a(t).removeChild(t);
            } catch (e) {
                $(t);
            }
        };
        function H(e, t, n) {
            wt(e, e => {
                e.call(c, t, n, o);
            });
        }
        function ze(t) {
            let n = null;
            if (H(h.beforeSanitizeElements, t, null), !Q(t)) {
                var e = I(t.nodeName);
                if (H(h.uponSanitizeElement, t, {
                    tagName: e,
                    allowedTags: g
                }), (!t.hasChildNodes() || Z(t.firstElementChild) || !Ge(/<[/\w!]/g, t.innerHTML) || !Ge(/<[/\w!]/g, t.textContent)) && !(t.nodeType === qt.progressingInstruction || we && t.nodeType === qt.comment && Ge(/<[/\w]/g, t.data))) {
                    if (g[e] && !b[e]) return t instanceof U && !(e => {
                        let t = a(e);
                        t && t.tagName || (t = {
                            namespaceURI: A,
                            tagName: "template"
                        });
                        var n = Ct(e.tagName), o = Ct(t.tagName);
                        return !!Re[e.namespaceURI] && (e.namespaceURI === N ? t.namespaceURI === _ ? "svg" === n : t.namespaceURI === k ? "svg" === n && ("annotation-xml" === o || M[o]) : Boolean(Fe[n]) : e.namespaceURI === k ? t.namespaceURI === _ ? "math" === n : t.namespaceURI === N ? "math" === n && R[o] : Boolean(Pe[n]) : e.namespaceURI === _ ? !(t.namespaceURI === N && !R[o] || t.namespaceURI === k && !M[o] || Pe[n]) && (Ie[n] || !Fe[n]) : !("application/xhtml+xml" !== O || !Re[e.namespaceURI]));
                    })(t) || ("noscript" === e || "noembed" === e || "noframes" === e) && Ge(/<\/no(script|embed|frames)/i, t.innerHTML) ? L(t) : (w && t.nodeType === qt.text && (n = t.textContent, 
                    wt([ re, ie, ae ], e => {
                        n = Nt(n, e, " ");
                    }), t.textContent !== n) && (Et(c.removed, {
                        element: t.cloneNode()
                    }), t.textContent = n), H(h.afterSanitizeElements, t, null));
                    if (!b[e] && Ve(e)) {
                        if (y.tagNameCheck instanceof RegExp && Ge(y.tagNameCheck, e)) return;
                        if (y.tagNameCheck instanceof Function && y.tagNameCheck(e)) return;
                    }
                    if (Ce && !D[e]) {
                        var o = a(t) || t.parentNode, r = Y(t) || t.childNodes;
                        if (r && o) for (let e = r.length - 1; 0 <= e; --e) {
                            var i = j(r[e], !0);
                            i.__removalCount = (t.__removalCount || 0) + 1, o.insertBefore(i, G(t));
                        }
                    }
                }
            }
            L(t);
        }
        function Ue(e, t, n) {
            if (Ee && ("id" === t || "name" === t) && (n in r || n in He)) return !1;
            if ((!ve || he[t] || !Ge(le, t)) && (!ge || !Ge(se, t))) if (!v[t] || he[t]) {
                if (!(Ve(e) && (y.tagNameCheck instanceof RegExp && Ge(y.tagNameCheck, e) || y.tagNameCheck instanceof Function && y.tagNameCheck(e)) && (y.attributeNameCheck instanceof RegExp && Ge(y.attributeNameCheck, t) || y.attributeNameCheck instanceof Function && y.attributeNameCheck(t)) || "is" === t && y.allowCustomizedBuiltInElements && (y.tagNameCheck instanceof RegExp && Ge(y.tagNameCheck, n) || y.tagNameCheck instanceof Function && y.tagNameCheck(n)))) return !1;
            } else if (!_e[t] && !Ge(fe, Nt(n, ue, "")) && ("src" !== t && "xlink:href" !== t && "href" !== t || "script" === e || 0 !== _t(n, "data:") || !ke[e]) && (!ye || Ge(ce, Nt(n, ue, ""))) && n) return !1;
            return !0;
        }
        function Be(n) {
            H(h.beforeSanitizeAttributes, n, null);
            var o = n.attributes;
            if (o && !Q(n)) {
                var r = {
                    attrName: "",
                    attrValue: "",
                    keepAttr: !0,
                    allowedAttributes: v,
                    forceKeepAttr: void 0
                };
                let e = o.length;
                for (;e--; ) {
                    var {
                        name: i,
                        namespaceURI: a,
                        value: l
                    } = o[e], s = I(i);
                    let t = "value" === i ? l : At(l);
                    if (r.attrName = s, r.attrValue = t, r.keepAttr = !0, r.forceKeepAttr = void 0, 
                    H(h.uponSanitizeAttribute, n, r), t = r.attrValue, !Se || "id" !== s && "name" !== s || (f(i, n), 
                    t = "user-content-" + t), we && Ge(/((--!?|])>)|<\/(style|title)/i, t)) f(i, n); else if (!r.forceKeepAttr && (f(i, n), 
                    r.keepAttr)) if (!be && Ge(/\/>/i, t)) f(i, n); else if (w && wt([ re, ie, ae ], e => {
                        t = Nt(t, e, " ");
                    }), l = I(n.nodeName), Ue(l, s, t)) {
                        if (p && "object" == typeof u && "function" == typeof u.getAttributeType && !a) switch (u.getAttributeType(l, s)) {
                          case "TrustedHTML":
                            t = p.createHTML(t);
                            break;

                          case "TrustedScriptURL":
                            t = p.createScriptURL(t);
                        }
                        try {
                            a ? n.setAttributeNS(a, i, t) : n.setAttribute(i, t), 
                            Q(n) ? L(n) : Tt(c.removed);
                        } catch (e) {}
                    }
                }
                H(h.afterSanitizeAttributes, n, null);
            }
        }
        function We(e) {
            var t, n = K(e);
            for (H(h.beforeSanitizeShadowDOM, e, null); t = n.nextNode(); ) H(h.uponSanitizeShadowNode, t, null), 
            ze(t), Be(t), t.content instanceof P && We(t.content);
            H(h.afterSanitizeShadowDOM, e, null);
        }
        let Ve = function(e) {
            return "annotation-xml" !== e && kt(e, de);
        };
        return c.sanitize = function(e) {
            var t, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
            let o = null, r = null;
            if ("string" != typeof (e = (Me = !e) ? "\x3c!--\x3e" : e) && !Z(e)) {
                if ("function" != typeof e.toString) throw Mt("toString is not a function");
                if ("string" != typeof (e = e.toString())) throw Mt("dirty is not a string, aborting");
            }
            if (!c.isSupported) return e;
            if (xe || d(n), c.removed = [], C = "string" != typeof e && C) {
                if (e.nodeName) {
                    n = I(e.nodeName);
                    if (!g[n] || b[n]) throw Mt("root node is forbidden and cannot be sanitized in-place");
                }
            } else if (e instanceof s) (n = (o = X("\x3c!----\x3e")).ownerDocument.importNode(e, !0)).nodeType === qt.element && "BODY" === n.nodeName || "HTML" === n.nodeName ? o = n : o.appendChild(n); else {
                if (!T && !w && !x && -1 === e.indexOf("<")) return p && S ? p.createHTML(e) : e;
                if (!(o = X(e))) return T ? null : S ? m : "";
            }
            o && Te && L(o.firstChild);
            for (var i = K(C ? e : o); t = i.nextNode(); ) ze(t), Be(t), t.content instanceof P && We(t.content);
            if (C) return e;
            if (T) {
                if (E) for (r = te.call(o.ownerDocument); o.firstChild; ) r.appendChild(o.firstChild); else r = o;
                return r = v.shadowroot || v.shadowrootmode ? oe.call(l, r, !0) : r;
            }
            let a = x ? o.outerHTML : o.innerHTML;
            return x && g["!doctype"] && o.ownerDocument && o.ownerDocument.doctype && o.ownerDocument.doctype.name && Ge($t, o.ownerDocument.doctype.name) && (a = "<!DOCTYPE " + o.ownerDocument.doctype.name + ">\n" + a), 
            w && wt([ re, ie, ae ], e => {
                a = Nt(a, e, " ");
            }), p && S ? p.createHTML(a) : a;
        }, c.setConfig = function() {
            var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
            d(e), xe = !0;
        }, c.clearConfig = function() {
            o = null, xe = !1;
        }, c.isValidAttribute = function(e, t, n) {
            return o || d({}), e = I(e), t = I(t), Ue(e, t, n);
        }, c.addHook = function(e, t) {
            "function" == typeof t && Et(h[e], t);
        }, c.removeHook = function(e, t) {
            return void 0 !== t ? -1 === (t = xt(h[e], t)) ? void 0 : St(h[e], t, 1)[0] : Tt(h[e]);
        }, c.removeHooks = function(e) {
            h[e] = [];
        }, c.removeAllHooks = function() {
            h = Yt();
        }, c;
    }(), Fe = window, Pe = document, Kt = /^image\/(p?jpe?g|gif|png|bmp)$/i;
    function Qt(e, t) {
        var n;
        p(e, function(e) {
            Oe(e, !0) ? (n || e.nodeType === ve ? /\S/.test(e.nodeValue) : !ke(e, ".sceditor-ignore")) && (n || Ne(n = ye("p", {}, t), e), 
            we(n, e)) : n = null;
        }, !1, !0);
    }
    function ze(r, e) {
        var i, b, u, a, o, l, d, s, w, c, f, p, t, m, h, g, v, H, y, F, P, n, x, z, U, T, E, B, W, V, j, $, G, Y, q, X, K, Q, Z, J, S, ee, te, ne, oe, re, C, ie, D, ae, le, se, ce, k, ue, N, de, _, A = this, M = {}, R = [], O = {}, fe = {}, I = (A.commands = We(!0, {}, e.commands || He), 
        A.opts = We(!0, {}, pt, e)), pe = (Array.isArray(I.allowedIframeUrls) || (I.allowedIframeUrls = []), 
        I.allowedIframeUrls.push("https://youtube.com/embed/"), I.allowedIframeUrls.push("https://player.vimeo.com/video/"), 
        I.allowedIframeUrls.push("https://www.instagram.com/p/"), I.allowedIframeUrls.push("https://www.facebook.com/plugins/"), 
        Xt());
        function L(e) {
            var t = [ "iframe" ].concat(I.allowedTags), n = [ "allowfullscreen", "frameborder", "target" ].concat(I.allowedAttributes);
            return pe.sanitize(e, {
                ADD_TAGS: t,
                ADD_ATTR: n
            });
        }
        pe.addHook("uponSanitizeElement", function(e, t) {
            var n = I.allowedIframeUrls;
            if ("iframe" === t.tagName) {
                var o = Se(e, "src") || "";
                for (let e = 0; e < n.length; e++) {
                    var r = n[e];
                    if (me(r) && o.substr(0, r.length) === r) return;
                    if (r.test && r.test(o)) return;
                }
                be(e);
            }
        }), pe.addHook("afterSanitizeAttributes", function(e) {
            "target" in e && Se(e, "data-sce-target", Se(e, "target")), Ce(e, "target");
        }), e = function() {
            r._sceditor = A, I.locale && "en" !== I.locale && V(), Ne(b = ye("div", {
                className: "sceditor-container card"
            }), r), De(b, "z-index", I.zIndex), P = r.required, r.required = !1;
            function e() {
                Ee(Fe, "load", e), I.autofocus && se(!!I.autofocusEnd), _(), D(), 
                h.call("ready"), "onReady" in i && i.onReady.call(A);
            }
            var t = ze.formats[I.format];
            i = t ? new t() : {}, h = new mt(A), (I.plugins || "").split(",").forEach(function(e) {
                h.register(e.trim());
            }), "init" in i && i.init.call(A), j(), W(), $(), G(), vt || A.toggleSourceMode(), 
            C();
            Te(Fe, "load", e), "complete" === Pe.readyState && e();
        }, V = function() {
            var e;
            (t = ze.locale[I.locale]) || (e = I.locale.split("-"), t = ze.locale[e[0]]), 
            t && t.dateFormat && (I.dateFormat = t.dateFormat);
        }, W = function() {
            s = ye("textarea"), Se(a = ye("iframe", {
                frameborder: 0,
                allowfullscreen: !0
            }), "role", "none"), Ae(w = ye("div"), "card-footer"), Ae(w, "text-body-secondary"), 
            Ae(w, "text-end"), Ae(w, "small"), Ae(w, "p-2"), w.appendChild(rt(A._("Characters remaining:") + '<span id="editor-Counter" class="badge bg-secondary ms-1"></span>')), 
            I.startInSourceMode ? (Ae(b, "sourceMode"), Ke(a)) : (Ae(b, "wysiwygMode"), 
            Ke(s)), I.spellcheck || Se(b, "spellcheck", "false"), "https:" === Fe.location.protocol && Se(a, "src", "about:blank"), 
            Se(s, "title", "source"), we(b, a), we(b, s), we(b, w), A.dimensions(I.width || et(r), I.height || Re(r)), 
            (d = a.contentDocument).open();
            var t = "", e = (I.styles.forEach(e => {
                t += Le("style", {
                    style: e
                });
            }), d.write(Le("html", {
                spellcheck: I.spellcheck ? "" : 'spellcheck="false"',
                charset: I.charset,
                themeMode: I.themeMode,
                styles: t
            })), d.close(), l = d.body, o = a.contentWindow, A.readOnly(!!I.readOnly), 
            gt && (Re(l, "100%"), Te(l, "touchend", A.focus)), Se(r, "tabindex")), e = (Se(s, "tabindex", e), 
            Se(a, "tabindex", e), m = new ht(o, null, L), Ke(r), A.val(r.value), 
            I.placeholder || Se(r, "placeholder"));
            e && (s.placeholder = e, Se(l, "placeholder", e));
        }, $ = function() {
            I.autoUpdate && (Te(l, "blur", de), Te(s, "blur", de)), null === I.rtl && (I.rtl = "rtl" === De(s, "direction")), 
            A.rtl(!!I.rtl), I.autoExpand && (Te(l, "load", _, !0), Te(l, "input keyup", _)), 
            I.resizeEnabled && Y(), Se(b, "id", I.id);
        }, G = function() {
            var e = r.form, t = "compositionstart compositionend", n = "keydown keyup keypress focus blur contextmenu input", o = "onselectionchange" in d ? "selectionchange" : "keyup focus blur contextmenu mouseup touchend click";
            Te(Pe, "click", oe), e && (Te(e, "reset", S), Te(e, "submit", A.updateOriginal, !0)), 
            Te(window, "pagehide", A.updateOriginal), Te(window, "pageshow", S), 
            Te(l, "keypress", J), Te(l, "keydown", Q), Te(l, "keydown", Z), Te(l, "keyup", D), 
            Te(l, "blur", ue), Te(l, "keyup", N), Te(l, "paste", q), Te(l, "cut copy", X), 
            Te(l, t, te), Te(l, o, ae), Te(l, n, ne), Te(l, "blur", function() {
                A.val() || Ae(l, "placeholder");
            }), Te(l, "focus", function() {
                Je(l, "placeholder");
            }), Te(s, "blur", ue), Te(s, "keyup", N), Te(s, "keydown", Q), Te(s, t, te), 
            Te(s, n, ne), Te(d, "mousedown", ee), Te(d, o, ae), Te(d, "keyup", D), 
            Te(b, "selectionchanged", le), Te(b, "selectionchanged", C), Te(b, "selectionchanged valuechanged nodechanged pasteraw paste", ne);
        }, j = function() {
            var i, a = A.commands, l = (I.toolbarExclude || "").split(","), e = I.toolbar.split("|");
            u = ye("div", {
                className: "card-header btn-toolbar",
                unselectable: "on"
            }), I.icons in ze.icons && (E = new ze.icons[I.icons]()), he(e, function(e, t) {
                i = ye("div", {
                    className: "btn-group btn-group-sm m-1"
                }), he(t.split(","), function(e, t) {
                    var n, o, r = a[t];
                    !r || -1 < l.indexOf(t) || (n = r.shortcut, o = Le("toolbarButton", {
                        name: t
                    }, !0).firstChild, "source" === t ? o.classList.add("btn-secondary") : o.classList.add("btn-primary"), 
                    E && E.create && E.create(t) && Ne(E.create(t), o.firstChild), 
                    o._sceTxtMode = !!r.txtExec, o._sceWysiwygMode = !!r.exec, Me(o, "disabled", !r.exec), 
                    Te(o, "click", function(e) {
                        _e(o, "disabled") || B(o, r), C(), e.preventDefault();
                    }), Te(o, "mousedown", function(e) {
                        A.closeDropDown(), e.preventDefault();
                    }), r.tooltip && Se(o, "title", A._(r.tooltip) + (n ? " (" + n + ")" : "")), 
                    n && A.addShortcut(n, t), r.state ? R.push({
                        name: t,
                        state: r.state
                    }) : me(r.exec) && R.push({
                        name: t,
                        state: r.exec
                    }), we(i, o), fe[t] = o);
                }), i.firstChild && we(u, i);
            }), we(I.toolbarContainer || b, u);
        }, Y = function() {
            var e = ye("div", {
                className: "sceditor-grip"
            }), t = "touchmove mousemove", n = "touchcancel touchend mouseup", o = 0, r = 0, i = 0, a = 0, l = 0, s = 0, c = et(b), u = Re(b), d = !1, f = A.rtl(), p = I.resizeMinHeight || u / 1.5, m = I.resizeMaxHeight || 2.5 * u, h = I.resizeMinWidth || c / 1.25, g = I.resizeMaxWidth || 1.25 * c, v = function(e) {
                a = ("touchmove" === e.type ? (e = Fe.event, i = e.changedTouches[0].pageX, 
                e.changedTouches[0]) : (i = e.pageX, e)).pageY;
                var t = s + (a - r), n = f ? l - (i - o) : l + (i - o);
                0 < g && g < n && (n = g), 0 < h && n < h && (n = h), I.resizeWidth || (n = !1), 
                0 < m && m < t && (t = m), 0 < p && t < p && (t = p), I.resizeHeight || (t = !1), 
                (n || t) && A.dimensions(n, t), e.preventDefault();
            }, y = function(e) {
                d && (d = !1, Je(b, "resizing"), Ee(Pe, t, v), Ee(Pe, n, y), e.preventDefault());
            };
            E && E.create && (u = E.create("grip")) && we(e, u), we(b, w), we(b, e), 
            Te(e, "touchstart mousedown", function(e) {
                r = ("touchstart" === e.type ? (e = Fe.event, o = e.touches[0].pageX, 
                e.touches[0]) : (o = e.pageX, e)).pageY, l = et(b), s = Re(b), d = !0, 
                Ae(b, "resizing"), Te(Pe, t, v), Te(Pe, n, y), e.preventDefault();
            });
        }, se = function(e) {
            var t, n = l.firstChild;
            if (nt(b)) if (A.sourceMode()) t = e ? s.value.length : 0, s.setSelectionRange(t, t); else {
                if (ct(l), e) for ((n = l.lastChild) || (n = ye("p", {}, d), we(l, n)); n.lastChild; ) ke(n = n.lastChild, "br") && n.previousSibling && (n = n.previousSibling);
                t = d.createRange(), lt(n) ? t.selectNodeContents(n) : (t.setStartBefore(n), 
                e && t.setStartAfter(n)), t.collapse(!e), m.selectRange(t), y = t, 
                e && (l.scrollTop = l.scrollHeight), A.focus();
            }
        }, A.readOnly = function(e) {
            return "boolean" != typeof e ? !s.readonly : (l.contentEditable = !e, 
            s.readonly = !e, re(e), A);
        }, A.rtl = function(e) {
            var t = e ? "rtl" : "ltr";
            return "boolean" != typeof e ? "rtl" === Se(s, "dir") : (Se(l, "dir", t), 
            Se(s, "dir", t), Je(b, "rtl"), Je(b, "ltr"), Ae(b, t), E && E.rtl && E.rtl(e), 
            A);
        }, re = function(n) {
            var o = A.inSourceMode() ? "_sceTxtMode" : "_sceWysiwygMode";
            he(fe, function(e, t) {
                Me(t, "disabled", n || !t[o]);
            });
        }, A.width = function(e, t) {
            return e || 0 === e ? (A.dimensions(e, null, t), A) : et(b);
        }, A.dimensions = function(e, t, n) {
            return t = !(!t && 0 !== t) && t, !1 === (e = !(!e && 0 !== e) && e) && !1 === t ? {
                width: A.width(),
                height: A.height()
            } : (!1 !== e && (!1 !== n && (I.width = e), et(b, e)), !1 !== t && (!1 !== n && (I.height = t), 
            Re(b, t)), A);
        }, A.height = function(e, t) {
            return e || 0 === e ? (A.dimensions(null, e, t), A) : Re(b);
        }, A.maximize = function(e) {
            var t = "sceditor-maximize";
            return Ue(e) ? _e(b, t) : ((e = !!e) && (U = Fe.scrollY), Me(Pe.documentElement, t, e), 
            Me(Pe.body, t, e), Me(b, t, e), A.width(e ? "100%" : I.width, !1), A.height(e ? "100%" : I.height, !1), 
            e || Fe.scrollTo(0, U), _(), A);
        }, _ = function() {
            I.autoExpand && !z && (z = setTimeout(A.expandToContent, 200));
        }, A.expandToContent = function(e) {
            var t, n;
            A.maximize() || (clearTimeout(z), z = !1, x || (n = I.resizeMinHeight || I.height || Re(r), 
            x = {
                min: n,
                max: I.resizeMaxHeight || 2 * n
            }), (n = Pe.createRange()).selectNodeContents(l), n = n.getBoundingClientRect(), 
            t = d.documentElement.clientHeight - 1, n = n.bottom - n.top, n = A.height() + 1 + (n - t), 
            e || -1 === x.max || (n = Math.min(n, x.max)), A.height(Math.ceil(Math.max(n, x.min))));
        }, A.destroy = function() {
            var e;
            h && (h.destroy(), h = m = null, c && be(c), Ee(Pe, "click", oe), (e = r.form) && (Ee(e, "reset", S), 
            Ee(e, "submit", A.updateOriginal, !0)), Ee(window, "pagehide", A.updateOriginal), 
            Ee(window, "pageshow", S), be(s), be(u), be(b), delete r._sceditor, 
            Qe(r), r.required = P);
        }, A.createDropDown = function(e, t, n) {
            var t = "sceditor-" + t;
            A.closeDropDown(), c && _e(c, t) || (e = We({
                top: e.offsetTop,
                left: e.parentElement.offsetLeft + e.offsetLeft,
                marginTop: e.clientHeight
            }, I.dropDownCss), De(c = ye("div", {
                className: "dropdown-menu show sceditor-dropdown " + t
            }), e), we(c, n), we(b, c), Te(c, "click focusin", function(e) {
                e.stopPropagation();
            }), c && (t = xe(c, "input,textarea")[0]) && t.focus());
        }, oe = function(e) {
            3 !== e.which && c && !e.defaultPrevented && (de(), A.closeDropDown());
        }, X = function(n) {
            var o = m.selectedRange();
            if (o) {
                var r, i = ye("div", {}, d);
                let e, t = o.commonAncestorContainer;
                for (;t && Oe(t, !0); ) t.nodeType === ge && (r = t.cloneNode(), 
                i.firstChild && we(r, i.firstChild), we(i, r), e = e || r), t = t.parentNode;
                we(e || i, o.cloneContents()), ct(i), n.clipboardData.setData("text/html", i.innerHTML), 
                he(xe(i, "p"), function(e, t) {
                    at(t, "div");
                }), he(xe(i, "br"), function(e, t) {
                    t.nextSibling && Oe(t.nextSibling, !0) || be(t);
                }), we(l, i), n.clipboardData.setData("text/plain", i.innerText), 
                be(i), "cut" === n.type && o.deleteContents(), n.preventDefault();
            }
        }, q = function(e) {
            var t = l, n = e.clipboardData;
            if (n) {
                var o = {}, r = n.types, i = n.items;
                for (let e = 0; e < r.length; e++) {
                    if (r.indexOf("text/html") < 0 && Fe.FileReader && i && Kt.test(i[e].type)) return void h.call("pasteHtml", i[e].getAsFile());
                    o[r[e]] = n.getData(r[e]);
                }
                o.text = o["text/plain"], o.html = L(o["text/html"]), K(o);
            } else if (!T) {
                var a = t.scrollTop;
                for (m.saveRange(), T = Pe.createDocumentFragment(); t.firstChild; ) we(T, t.firstChild);
                setTimeout(function() {
                    var e = t.innerHTML;
                    t.innerHTML = "", we(t, T), t.scrollTop = a, T = !1, m.restoreRange(), 
                    K({
                        html: L(e)
                    });
                }, 0);
            }
        }, K = function(e) {
            var t = ye("div", {}, d), e = (h.call("pasteRaw", e), tt(b, "pasteraw", e), 
            e.html ? (t.innerHTML = L(e.html), st(t)) : t.innerHTML = Ie(e.text || ""), 
            {
                val: t.innerHTML
            }), t = ("fragmentToSource" in i && (e.val = i.fragmentToSource(e.val, d, g)), 
            h.call("paste", e), tt(b, "paste", e), "fragmentToHtml" in i && (e.val = i.fragmentToHtml(e.val, g)), 
            h.call("pasteHtml", e), m.getFirstBlockParent());
            A.wysiwygEditorInsertHtml(e.val, null, !0), function e(t) {
                if (t.nodeType === ge) {
                    for (var n = t.parentNode, o = t.tagName, r = t.childNodes.length; r--; ) e(t.childNodes[r]);
                    if (Oe(t) && "BR" !== o) {
                        for (r = t.style.length; r--; ) {
                            var i = t.style[r];
                            De(n, i) === De(t, i) && t.style.removeProperty(i);
                        }
                        if (!t.style.length) if (Ce(t, "style"), "FONT" === o && (De(t, "fontFamily").toLowerCase() === De(n, "fontFamily").toLowerCase() && Ce(t, "face"), 
                        De(t, "color") === De(n, "color") && Ce(t, "color"), De(t, "fontSize") === De(n, "fontSize")) && Ce(t, "size"), 
                        !t.attributes.length && /SPAN|FONT/.test(o)) ft(t); else if (/B|STRONG|EM|SPAN|FONT/.test(o)) for (var a = /B|STRONG/.test(o), l = "EM" === o; n && Oe(n) && (!a || /bold|700/i.test(De(n, "fontWeight"))) && (!l || "italic" === De(n, "fontStyle")); ) {
                            if ((n.tagName === o || a && /B|STRONG/.test(n.tagName)) && dt(n, t)) {
                                ft(t);
                                break;
                            }
                            n = n.parentNode;
                        }
                        var s = t.nextSibling;
                        s && s.tagName === o && dt(s, t) && (we(t, s), ft(s));
                    }
                }
            }(t);
        }, A.closeDropDown = function(e) {
            c && (be(c), c = null), !0 === e && A.focus();
        }, A.wysiwygEditorInsertHtml = function(e, t, n) {
            var o = Re(a);
            A.focus(), !n && Xe(v, "code") || (m.insertHTML(e, t), m.saveRange(), 
            st(l), Qt(l, d), Qe(n = xe(l, "#sceditor-end-marker")[0]), e = l.scrollTop, 
            t = ut(n).top + 1.5 * n.offsetHeight - o, Ke(n), (e < t || t + o < e) && (l.scrollTop = t), 
            k(!1), m.restoreRange(), D());
        }, A.wysiwygEditorInsertText = function(e, t) {
            A.wysiwygEditorInsertHtml(Ie(e), Ie(t));
        }, A.insertText = function(e, t) {
            return A.inSourceMode() ? A.sourceEditorInsertText(e, t) : A.wysiwygEditorInsertText(e, t), 
            A;
        }, A.sourceEditorInsertText = function(e, t) {
            var n, o = s.selectionStart, r = s.selectionEnd, i = s.scrollTop;
            s.focus(), n = s.value, t && (e += n.substring(o, r) + t), s.value = n.substring(0, o) + e + n.substring(r, n.length), 
            s.selectionStart = o + e.length - (t ? t.length : 0), s.selectionEnd = s.selectionStart, 
            s.scrollTop = i, s.focus(), k();
        }, A.getRangeHelper = function() {
            return m;
        }, A.sourceEditorCaret = function(e) {
            return s.focus(), e ? (s.selectionStart = e.start, s.selectionEnd = e.end, 
            this) : {
                start: s.selectionStart,
                end: s.selectionEnd
            };
        }, A.val = function(e, t) {
            return me(e) ? (A.inSourceMode() ? A.setSourceEditorValue(e) : (!1 !== t && "toHtml" in i && (e = i.toHtml(e)), 
            A.setWysiwygEditorValue(e)), A) : A.inSourceMode() ? A.getSourceEditorValue(!1) : A.getWysiwygEditorValue(t);
        }, A.insert = function(t, n, o, e, r) {
            if (A.inSourceMode()) A.sourceEditorInsertText(t, n); else {
                if (n) {
                    let e = m.selectedHtml();
                    t += (e = !1 !== o && "fragmentToSource" in i ? i.fragmentToSource(e, d, g) : e) + n;
                }
                !1 !== o && "fragmentToHtml" in i && (t = i.fragmentToHtml(t, g)), 
                !1 !== o && !0 === r && (t = t.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&")), 
                A.wysiwygEditorInsertHtml(t);
            }
            return A;
        }, A.getWysiwygEditorValue = function(e) {
            var t, n = ye("div", {}, d), o = l.childNodes;
            for (let e = 0; e < o.length; e++) we(n, o[e].cloneNode(!0));
            return we(l, n), st(n), be(n), t = n.innerHTML, t = !1 !== e && i.hasOwnProperty("toSource") ? i.toSource(t, d) : t;
        }, A.getBody = function() {
            return l;
        }, A.getContentAreaContainer = function() {
            return a;
        }, A.getSourceEditorValue = function(e) {
            var t = s.value;
            return t = !1 !== e && "toHtml" in i ? i.toHtml(t) : t;
        }, A.getSourceEditor = function() {
            return s;
        }, A.setWysiwygEditorValue = function(e) {
            l.innerHTML = L(e = e || "<p><br /></p>"), D(), k(), _();
        }, A.setSourceEditorValue = function(e) {
            s.value = e, k();
        }, A.updateOriginal = function() {
            r.value = A.val();
        }, A.inSourceMode = function() {
            return _e(b, "sourceMode");
        }, A.sourceMode = function(e) {
            var t = A.inSourceMode();
            return "boolean" != typeof e ? t : ((t && !e || !t && e) && A.toggleSourceMode(), 
            A);
        }, A.toggleSourceMode = function() {
            var e = A.inSourceMode();
            !vt && e || (e || (m.saveRange(), m.clear()), y = null, A.blur(), e ? A.setWysiwygEditorValue(A.getSourceEditorValue()) : A.setSourceEditorValue(A.getWysiwygEditorValue()), 
            Ze(s), Ze(a), Me(b, "wysiwygMode", e), Me(b, "sourceMode", !e), re(), 
            C(), void 0 !== A.opts.onToggleMode && A.opts.onToggleMode(A));
        }, ie = function() {
            return s.focus(), s.value.substring(s.selectionStart, s.selectionEnd);
        }, B = function(e, t) {
            A.inSourceMode() ? t.txtExec && (Array.isArray(t.txtExec) ? A.sourceEditorInsertText.apply(A, t.txtExec) : t.txtExec.call(A, e, ie())) : t.exec && (Be(t.exec) ? t.exec.call(A, e) : A.execCommand(t.exec, t.hasOwnProperty("execParam") ? t.execParam : null));
        }, A.execCommand = function(e, t) {
            var n = !1, o = A.commands[e];
            if (A.focus(), !Xe(m.parentNode(), "code")) {
                try {
                    n = d.execCommand(e, !1, t);
                } catch (e) {}
                !n && o && o.errorMessage && alert(A._(o.errorMessage)), C();
            }
        }, ae = function() {
            function e() {
                if (o.getSelection() && o.getSelection().rangeCount <= 0) y = null; else if (m && !m.compare(y)) {
                    if ((y = m.cloneSelected()) && y.collapsed) {
                        let e = y.startContainer;
                        var t = y.startOffset;
                        for (t && e.nodeType !== ve && (e = e.childNodes[t]); e && e.parentNode !== l; ) e = e.parentNode;
                        e && Oe(e, !0) && (m.saveRange(), Qt(l, d), m.restoreRange());
                    }
                    tt(b, "selectionchanged");
                }
                F = !1;
            }
            F || (F = !0, "onselectionchange" in d ? e() : setTimeout(e, 100));
        }, le = function() {
            var e, t = m.parentNode();
            g !== t && (e = g, g = t, v = m.getFirstBlockParent(t), tt(b, "nodechanged", {
                oldNode: e,
                newNode: g
            })), H && (v.querySelectorAll("span[style]").forEach(e => {
                e && (e.outerHTML = e.innerHTML);
            }), H = !1);
        }, A.currentNode = function() {
            return g;
        }, A.currentBlockNode = function() {
            return v;
        }, C = function() {
            var n, o, r = "active", i = d, a = A.sourceMode();
            if (A.readOnly()) he(xe(u, r), function(e, t) {
                Je(t, r);
            }); else {
                a || (o = m.parentNode(), n = m.getFirstBlockParent(o));
                for (let t = 0; t < R.length; t++) {
                    let e = 0;
                    var l = fe[R[t].name], s = R[t].state, c = a && !l._sceTxtMode || !a && !l._sceWysiwygMode;
                    if (me(s)) {
                        if (!a) try {
                            -1 < (e = i.queryCommandEnabled(s) ? 0 : -1) && (e = i.queryCommandState(s) ? 1 : 0);
                        } catch (e) {}
                    } else c || (e = s.call(A, o, n));
                    Me(l, "disabled", c || e < 0), Me(l, r, 0 < e);
                }
                E && E.update && E.update(a, o, n);
            }
        }, J = function(t) {
            if (!t.defaultPrevented && (A.closeDropDown(), 13 === t.which)) if (!ke(v, "li,ul,ol") && it(v)) {
                var n = ye("br", {}, d), o = (m.insertNode(n), n.parentNode);
                let e = o.lastChild;
                e && e.nodeType === ve && "" === e.nodeValue && (be(e), e = o.lastChild), 
                !Oe(o, !0) && e === n && Oe(n.previousSibling) && m.insertHTML("<br>"), 
                t.preventDefault();
            }
        }, D = function() {
            ot(l, function(e) {
                var t;
                if (e.nodeType === ge && !/inline/.test(De(e, "display")) && (!ke(e, ".sceditor-nlf") && it(e))) return (t = ye("p", {}, d)).className = "sceditor-nlf", 
                t.innerHTML = "<br />", we(l, t), !1;
                if (3 === e.nodeType && !/^\s*$/.test(e.nodeValue) || ke(e, "br")) return !1;
            });
        }, S = function() {
            A.val(r.value);
        }, ee = function() {
            A.closeDropDown();
        }, A._ = function() {
            var n = arguments;
            return t && t[n[0]] && (n[0] = t[n[0]]), n[0].replace(/\{(\d+)\}/g, function(e, t) {
                return void 0 !== n[+t + 1] ? n[+t + 1] : `{${t}}`;
            });
        }, ne = function(t) {
            h && h.call(t.type + "Event", t, A);
            var e = (t.target === s ? "scesrc" : "scewys") + t.type;
            M[e] && M[e].forEach(function(e) {
                e.call(A, t);
            });
        }, A.bind = function(e, t, n, o) {
            for (var r, i, a = (e = e.split(" ")).length; a--; ) Be(t) && (r = "scewys" + e[a], 
            i = "scesrc" + e[a], n || (M[r] = M[r] || [], M[r].push(t)), o || (M[i] = M[i] || [], 
            M[i].push(t)), "valuechanged" === e[a]) && (k.hasHandler = !0);
            return A;
        }, A.unbind = function(e, t, n, o) {
            for (var r = (e = e.split(" ")).length; r--; ) Be(t) && (n || Ve(M["scewys" + e[r]] || [], t), 
            o || Ve(M["scesrc" + e[r]] || [], t));
            return A;
        }, A.blur = function(e, t, n) {
            return Be(e) ? A.bind("blur", e, t, n) : (A.sourceMode() ? s : l).blur(), 
            A;
        }, A.focus = function(e, t, n) {
            if (Be(e)) A.bind("focus", e, t, n); else if (A.inSourceMode()) s.focus(); else {
                if (xe(d, ":focus").length) return;
                e = m.selectedRange();
                y || se(!0), e && 1 === e.endOffset && e.collapsed && (t = e.endContainer) && 1 === t.childNodes.length && ke(t.firstChild, "br") && (e.setStartBefore(t.firstChild), 
                e.collapse(!0), m.selectRange(e)), o.focus(), l.focus();
            }
            return C(), A;
        }, A.keyDown = function(e, t, n) {
            return A.bind("keydown", e, t, n);
        }, A.keyPress = function(e, t, n) {
            return A.bind("keypress", e, t, n);
        }, A.keyUp = function(e, t, n) {
            return A.bind("keyup", e, t, n);
        }, A.nodeChanged = function(e) {
            return A.bind("nodechanged", e, !1, !0);
        }, A.selectionChanged = function(e) {
            return A.bind("selectionchanged", e, !1, !0);
        }, A.valueChanged = function(e, t, n) {
            return A.bind("valuechanged", e, t, n);
        }, A.css = function(e) {
            return n || (n = ye("style", {
                id: "inline"
            }, d), we(d.head, n)), me(e) ? (n.styleSheet ? n.styleSheet.cssText = e : n.innerHTML = e, 
            A) : n.styleSheet ? n.styleSheet.cssText : n.innerHTML;
        }, Q = function(e) {
            var t = [], n = {
                "`": "~",
                1: "!",
                2: "@",
                3: "#",
                4: "$",
                5: "%",
                6: "^",
                7: "&",
                8: "*",
                9: "(",
                0: ")",
                "-": "_",
                "=": "+",
                ";": ": ",
                "'": '"',
                ",": "<",
                ".": ">",
                "/": "?",
                "\\": "|",
                "[": "{",
                "]": "}"
            }, o = {
                109: "-",
                110: "del",
                111: "/",
                96: "0",
                97: "1",
                98: "2",
                99: "3",
                100: "4",
                101: "5",
                102: "6",
                103: "7",
                104: "8",
                105: "9"
            }, r = e.which, i = {
                8: "backspace",
                9: "tab",
                13: "enter",
                19: "pause",
                20: "capslock",
                27: "esc",
                32: "space",
                33: "pageup",
                34: "pagedown",
                35: "end",
                36: "home",
                37: "left",
                38: "up",
                39: "right",
                40: "down",
                45: "insert",
                46: "del",
                91: "win",
                92: "win",
                93: "select",
                96: "0",
                97: "1",
                98: "2",
                99: "3",
                100: "4",
                101: "5",
                102: "6",
                103: "7",
                104: "8",
                105: "9",
                106: "*",
                107: "+",
                109: "-",
                110: ".",
                111: "/",
                112: "f1",
                113: "f2",
                114: "f3",
                115: "f4",
                116: "f5",
                117: "f6",
                118: "f7",
                119: "f8",
                120: "f9",
                121: "f10",
                122: "f11",
                123: "f12",
                144: "numlock",
                145: "scrolllock",
                186: ";",
                187: "=",
                188: ",",
                189: "-",
                190: ".",
                191: "/",
                192: "`",
                219: "[",
                220: "\\",
                221: "]",
                222: "'"
            }[r] || String.fromCharCode(r).toLowerCase();
            if ((e.ctrlKey || e.metaKey) && t.push("ctrl"), e.altKey && t.push("alt"), 
            e.shiftKey && (t.push("shift"), o[r] ? i = o[r] : n[i] && (i = n[i])), 
            i && (r < 16 || 18 < r) && t.push(i), t = t.join("+"), O[t] && !1 === O[t].call(A) && (e.stopPropagation(), 
            e.preventDefault()), "]" === e.key && A.inSourceMode()) {
                o = s, n = o.selectionStart, r = o.value.slice(0, n), i = o.value.slice(o.selectionEnd, o.value.length);
                let e;
                try {
                    e = r.match(/\[([^\]]+)$/)[1].match(/^([a-z1-6]+)/)[1];
                } catch (e) {}
                -1 < [ "b", "i", "u", "h", "code", "img", "quote", "left", "center", "right", "list", "color", "size", "albumimg", "attach", "youtube", "vimeo", "instagram", "twitter", "facebook", "googlewidget", "spoiler", "userlink", "googlemaps", "hide", "group-hide", "hide-thanks", "hide-reply-thanks", "hide-reply", "hide-posts", "dailymotion", "audio", "media", "note" ].indexOf(e) && (t = `[/${e}]`, 
                o.value = r + t + i, o.selectionStart = o.selectionEnd = n, o.focus());
            }
        }, A.addShortcut = function(e, t) {
            return e = e.toLowerCase(), me(t) ? O[e] = function() {
                return B(fe[t], A.commands[t]), !1;
            } : O[e] = t, A;
        }, A.removeShortcut = function(e) {
            return delete O[e.toLowerCase()], A;
        }, Z = function(e) {
            var t, n, o;
            if (8 === e.which && (H = !0, !I.disableBlockRemove) && (n = m.selectedRange()) && (t = n.startContainer, 
            0 === n.startOffset) && (o = ce()) && !ke(o, "body")) {
                for (;t !== o; ) {
                    for (;t.previousSibling; ) if ((t = t.previousSibling).nodeType !== ve || t.nodeValue) return;
                    if (!(t = t.parentNode)) return;
                }
                A.clearBlockFormatting(o), e.preventDefault();
            }
        }, ce = function() {
            for (var e = v; !it(e) || Oe(e, !0); ) if (!(e = e.parentNode) || ke(e, "body")) return;
            return e;
        }, A.clearBlockFormatting = function(e) {
            return (e = e || ce()) && !ke(e, "body") && (m.saveRange(), e.className = "", 
            Se(e, "style", ""), ke(e, "p,div,td") || at(e, "p"), m.restoreRange()), 
            A;
        }, k = function(e) {
            var t, n, o;
            h && (h.hasHandler("valuechangedEvent") || k.hasHandler) && (o = !(n = A.sourceMode()) && m.hasSelection(), 
            e = (f = !1) !== e && !d.getElementById("sceditor-start-marker"), p && (clearTimeout(p), 
            p = !1), o && e && m.saveRange(), (t = n ? s.value : l.innerHTML) !== k.lastVal && (k.lastVal = t, 
            tt(b, "valuechanged", {
                rawValue: n ? A.val() : t
            })), o) && e && m.removeMarkers();
        }, ue = function() {
            p && k();
        }, N = function(e) {
            var e = e.which, t = N.lastChar, n = 13 === t || 32 === t, t = 8 === t || 46 === t;
            N.lastChar = e, f || (13 === e || 32 === e ? n ? N.triggerNext = !0 : k() : 8 === e || 46 === e ? t ? N.triggerNext = !0 : k() : N.triggerNext && (k(), 
            N.triggerNext = !1), clearTimeout(p), p = setTimeout(function() {
                f || k();
            }, 1500));
        }, te = function(e) {
            (f = /start/i.test(e.type)) || k();
        }, de = function() {
            A.updateOriginal();
        }, e();
    }
    ze.locale = {}, ze.formats = {}, ze.icons = {}, ze.command = {
        get: function(e) {
            return He[e] || null;
        },
        set: function(e, t) {
            return !(!e || !t) && ((t = We(He[e] || {}, t)).remove = function() {
                ze.command.remove(e);
            }, He[e] = t, this);
        },
        remove: function(e) {
            return He[e] && delete He[e], this;
        }
    }, window.sceditor = {
        command: ze.command,
        commands: He,
        defaultOptions: pt,
        ios: gt,
        isWysiwygSupported: vt,
        regexEscape: w,
        escapeEntities: Ie,
        escapeUriScheme: function(e) {
            var t, n = window.location;
            return e && /^[^\/]*:/i.test(e) && !b.test(e) ? ((t = n.pathname.split("/")).pop(), 
            n.protocol + "//" + n.host + t.join("/") + "/" + e) : e;
        },
        dom: {
            css: De,
            attr: Se,
            removeAttr: Ce,
            is: ke,
            closest: Xe,
            width: et,
            height: Re,
            traverse: p,
            rTraverse: ot,
            parseHTML: rt,
            hasStyling: it,
            convertElement: at,
            blockLevelList: m,
            canHaveChildren: lt,
            isInline: Oe,
            copyCSS: function(e, t) {
                t.style && e.style && (t.style.cssText = e.style.cssText + t.style.cssText);
            },
            fixNesting: st,
            findCommonAncestor: function(e, t) {
                for (;e = e.parentNode; ) if ((n = e) !== (o = t) && n.contains && n.contains(o)) return e;
                var n, o;
            },
            getSibling: g,
            removeWhiteSpace: ct,
            extractContents: v,
            getOffset: ut,
            getStyle: y,
            hasStyle: function(e, t, n) {
                return !!(e = y(e, t)) && (!n || e === n || Array.isArray(n) && -1 < n.indexOf(e));
            }
        },
        locale: ze.locale,
        icons: ze.icons,
        utils: {
            each: he,
            isEmptyObject: l,
            extend: We
        },
        plugins: mt.plugins,
        formats: ze.formats,
        create: function(e, t) {
            t = t || {}, u(e, ".sceditor-container") || (t.runWithoutWysiwygSupport || vt) && new ze(e, t);
        },
        instance: function(e) {
            return e._sceditor;
        }
    };
})();

(t => {
    var l, f = t.escapeEntities, r = t.escapeUriScheme, h = t.dom, e = t.utils, p = h.css, s = h.attr, g = h.is, n = e.extend, b = e.each, i = t.command.get, v = {
        always: 1,
        never: 2,
        auto: 3
    }, a = {
        bold: {
            txtExec: [ "[b]", "[/b]" ]
        },
        italic: {
            txtExec: [ "[i]", "[/i]" ]
        },
        underline: {
            txtExec: [ "[u]", "[/u]" ]
        },
        strike: {
            txtExec: [ "[s]", "[/s]" ]
        },
        mark: {
            txtExec: [ "[h]", "[/h]" ]
        },
        left: {
            txtExec: [ "[left]", "[/left]" ]
        },
        center: {
            txtExec: [ "[center]", "[/center]" ]
        },
        right: {
            txtExec: [ "[right]", "[/right]" ]
        },
        justify: {
            txtExec: [ "[justify]", "[/justify]" ]
        },
        font: {
            txtExec: function(t) {
                var e = this;
                i("font")._dropDown(e, t, function(t) {
                    e.insertText(`[font=${t}]`, "[/font]");
                });
            }
        },
        size: {
            txtExec: function(t) {
                var e = this;
                i("size")._dropDown(e, t, function(t) {
                    e.insertText(`[size=${t}]`, "[/size]");
                });
            }
        },
        color: {
            txtExec: function(t) {
                var e = this;
                i("color")._dropDown(e, t, function(t) {
                    e.insertText(`[color=${t}]`, "[/color]");
                });
            }
        },
        bulletlist: {
            txtExec: function(t, e) {
                this.insertText(`[list]
[list]${e.split(/\r?\n/).join("[/li]\n[li]")}[/li]
[/ul]`);
            }
        },
        orderedlist: {
            txtExec: function(t, e) {
                this.insertText(`[list=I]
[li]${e.split(/\r?\n/).join("[/li]\n[li]")}[/li]
[/list]`);
            }
        },
        table: {
            txtExec: [ "[table][tr][td]", "[/td][/tr][/table]" ]
        },
        code: {
            txtExec: function(t) {
                var e = this;
                i("code")._dropDown(e, t, function(t) {
                    e.insertText(`[code=${t}]`, "[/code]");
                });
            }
        },
        note: {
            txtExec: function(t) {
                var e = this;
                i("note")._dropDown(e, t, function(t) {
                    e.insertText(`[note=${t}]`, "[/note]");
                });
            }
        },
        extensions: {
            txtExec: function(t) {
                var e = this;
                i("extensions")._dropDown(e, t, function(t) {
                    e.insertText(`[${t}]`, `[/${t}]`);
                });
            }
        },
        image: {
            txtExec: function(t, n) {
                var r = this;
                i("image")._dropDown(r, t, function(t, e) {
                    e || n ? r.insertText(`[img=${t}]${e || n || t}[/img]`) : r.insertText(`[img]${t}[/img]`);
                });
            }
        },
        email: {
            txtExec: function(t, n) {
                var r = this;
                i("email")._dropDown(r, t, function(t, e) {
                    r.insertText(`[email=${t}]${e || n || t}[/email]`);
                });
            }
        },
        link: {
            txtExec: function(t, n) {
                var r = this;
                i("link")._dropDown(r, t, function(t, e) {
                    n || e ? r.insertText(`[url=${t}]${e || n || t}[/url]`) : r.insertText(`[url]${t}[/url]`);
                });
            }
        },
        quote: {
            txtExec: [ "[quote]", "[/quote]" ]
        },
        userlink: {
            txtExec: [ "[userlink]", "[/userlink]" ]
        },
        albums: {
            txtExec: function(t) {
                var e = this;
                i("albums")._dropDown(e, t, function(t) {
                    e.insertText(`[albumid]${t}[/albumid]`);
                });
            }
        },
        attachments: {
            txtExec: function(t) {
                var e = this;
                i("attachments")._dropDown(e, t, function(t) {
                    e.insertText(`[attach]${t}[/attach]`);
                });
            }
        },
        media: {
            txtExec: function(t) {
                var e = this;
                i("media")._dropDown(e, t, function(t) {
                    e.insertText(`[media]${t}[/media]`);
                });
            }
        },
        vimeo: {
            txtExec: function(t) {
                var e = this;
                i("vimeo")._dropDown(e, t, function(t) {
                    e.insertText(`[vimeo]${t}[/vimeo]`);
                });
            }
        },
        instagram: {
            txtExec: function(t) {
                var e = this;
                i("instagram")._dropDown(e, t, function(t) {
                    e.insertText(`[instagram]${t}[/instagram]`);
                });
            }
        },
        facebook: {
            txtExec: function(t) {
                var e = this;
                i("facebook")._dropDown(e, t, function(t) {
                    e.insertText(`[facebook]${t}[/facebook]`);
                });
            }
        },
        youtube: {
            txtExec: function(t) {
                var e = this;
                i("youtube")._dropDown(e, t, function(t) {
                    e.insertText(`[youtube]${t}[/youtube]`);
                });
            }
        }
    }, y = {
        b: {
            tags: {
                b: null,
                strong: null
            },
            styles: {
                "font-weight": [ "bold", "bolder", "401", "700", "800", "900" ]
            },
            format: "[b]{0}[/b]",
            html: "<strong>{0}</strong>"
        },
        i: {
            tags: {
                i: null,
                em: null
            },
            styles: {
                "font-style": [ "italic", "oblique" ]
            },
            format: "[i]{0}[/i]",
            html: "<em>{0}</em>"
        },
        u: {
            tags: {
                u: null
            },
            styles: {
                "text-decoration": [ "underline" ]
            },
            format: "[u]{0}[/u]",
            html: "<u>{0}</u>"
        },
        s: {
            tags: {
                s: null,
                strike: null
            },
            styles: {
                "text-decoration": [ "line-through" ]
            },
            format: "[s]{0}[/s]",
            html: "<s>{0}</s>"
        },
        sub: {
            tags: {
                sub: null
            },
            format: "[sub]{0}[/sub]",
            html: "<sub>{0}</sub>"
        },
        sup: {
            tags: {
                sup: null
            },
            format: "[sup]{0}[/sup]",
            html: "<sup>{0}</sup>"
        },
        h: {
            tags: {
                h: null,
                mark: null
            },
            format: "[h]{0}[/h]",
            html: "<mark>{0}</mark>"
        },
        font: {
            tags: {
                font: {
                    face: null
                }
            },
            styles: {
                "font-family": null
            },
            quoteType: v.never,
            format: function(t, e) {
                var n;
                return `[font=${o(n = g(t, "font") && (n = s(t, "face")) ? n : p(t, "font-family"))}]${e}[/font]`;
            },
            html: '<font face="{defaultattr}">{0}</font>'
        },
        size: {
            tags: {
                font: {
                    size: null
                }
            },
            styles: {
                "font-size": null
            },
            format: function(t, e) {
                var n = s(t, "size"), r = 2;
                return -1 < (n = n || p(t, "fontSize")).indexOf("px") ? ((n = +n.replace("px", "")) < 12 && (r = 1), 
                15 < n && (r = 3), 17 < n && (r = 4), 23 < n && (r = 5), 31 < n && (r = 6), 
                47 < n && (r = 7)) : r = n, `[size=${r}]${e}[/size]`;
            },
            html: '<font size="{defaultattr}">{!0}</font>'
        },
        color: {
            tags: {
                font: {
                    color: null
                }
            },
            styles: {
                color: null
            },
            quoteType: v.never,
            format: function(t, e) {
                var n;
                return `[color=${d(n = g(t, "font") && (n = s(t, "color")) ? n : t.style.color || p(t, "color"))}]${e}[/color]`;
            },
            html: function(t, e, n) {
                return `<font color="${f(d(e.defaultattr), !0)}">${n}</font>`;
            }
        },
        ul: {
            tags: {
                ul: null
            },
            breakStart: !0,
            isInline: !1,
            skipLastLineBreak: !0,
            format: "[list]{0}[/list]",
            html: "<ul>{0}</ul>"
        },
        list: {
            breakStart: !0,
            isInline: !1,
            skipLastLineBreak: !0,
            format: "[list]{0}[/list]",
            html: "<ul>{0}</ul>"
        },
        ol: {
            tags: {
                ol: null
            },
            breakStart: !0,
            isInline: !1,
            skipLastLineBreak: !0,
            format: "[list=I]{0}[/list]",
            html: "<ol>{0}</ol>"
        },
        li: {
            tags: {
                li: null
            },
            isInline: !1,
            closedBy: [ "/ul", "/ol", "/list", "*", "li" ],
            format: "[li]{0}[/li]",
            html: "<li>{0}</li>"
        },
        "*": {
            isInline: !1,
            closedBy: [ "/ul", "/ol", "/list", "*", "li" ],
            html: "<li>{0}</li>"
        },
        table: {
            tags: {
                table: null
            },
            isInline: !1,
            isHtmlInline: !0,
            skipLastLineBreak: !0,
            format: "[table]{0}[/table]",
            html: '<table class="table">{0}</table>'
        },
        tr: {
            tags: {
                tr: null
            },
            isInline: !1,
            skipLastLineBreak: !0,
            format: "[tr]{0}[/tr]",
            html: "<tr>{0}</tr>"
        },
        th: {
            tags: {
                th: null
            },
            allowsEmpty: !0,
            isInline: !1,
            format: "[th]{0}[/th]",
            html: "<th>{0}</th>"
        },
        td: {
            tags: {
                td: null
            },
            allowsEmpty: !0,
            isInline: !1,
            format: "[td]{0}[/td]",
            html: '<td class="border">{0}</td>'
        },
        hr: {
            tags: {
                hr: null
            },
            allowsEmpty: !0,
            isSelfClosing: !0,
            isInline: !1,
            format: "[hr]{0}",
            html: "<hr />"
        },
        img: {
            allowsEmpty: !0,
            tags: {
                img: {
                    src: null,
                    class: "img-user-posted img-thumbnail"
                }
            },
            allowedChildren: [ "#" ],
            quoteType: v.never,
            format: function(t) {
                var e = s(t, "alt");
                return e ? `[img=${s(t, "src")}]${e}[/img]` : `[img]${s(t, "src")}[/img]`;
            },
            html: function(t, e, n) {
                return e.defaultattr = f(e.defaultattr, !0) || n, `<img src="${r(e.defaultattr)}" alt="${n}" class="img-user-posted img-thumbnail" />`;
            }
        },
        userlink: {
            allowsEmpty: !0,
            tags: {
                span: {
                    class: "badge rounded-pill text-bg-secondary fs-6"
                }
            },
            format: function(t) {
                return `[userlink]${s(t, "data-user")}[/userlink]`;
            },
            html: function(t, e, n) {
                return `<span class="badge rounded-pill text-bg-secondary fs-6" data-user="${f(n)}">${f(n)}</span>`;
            }
        },
        albumimg: {
            allowsEmpty: !0,
            tags: {
                div: {
                    src: null,
                    class: "card text-bg-dark"
                }
            },
            allowedChildren: [ "#" ],
            quoteType: v.never,
            format: function(t) {
                return `[albumimg]${s(t, "alt")}[/albumimg]`;
            },
            html: function(t, e, n) {
                return e.defaultattr = f(e.defaultattr, !0) || n, `<div class="card text-bg-dark" style="max-width:200px" alt="${n}"><img src="${l.albumsPreviewUrl}${r(e.defaultattr)}" class="img-user-posted card-img-top" style="max-height:200px;max-width:200px;object-fit:contain""></div>`;
            }
        },
        url: {
            allowsEmpty: !0,
            tags: {
                a: {
                    href: null
                }
            },
            quoteType: v.never,
            format: function(t, e) {
                t = s(t, "href");
                return "mailto:" === t.substr(0, 7) ? `[email="${t.substr(7)}"]${e}[/email]` : `[url=${t}]${e}[/url]`;
            },
            html: function(t, e, n) {
                return e.defaultattr = f(e.defaultattr, !0) || n, `<a href="${r(e.defaultattr)}" class="link">${n}</a>`;
            }
        },
        email: {
            quoteType: v.never,
            html: function(t, e, n) {
                return `<a href="mailto:${f(e.defaultattr, !0) || n}">${n}</a>`;
            }
        },
        quote: {
            tags: {
                div: {
                    class: "border rounded mx-3 mb-3 p-3 border-secondary shadow-sm"
                }
            },
            isInline: !1,
            quoteType: v.never,
            format: function(t, e) {
                var n, r = "", i = t.children;
                for (let t = 0; !n && t < i.length; t++) g(i[t], "cite") && (n = i[t]);
                return n && (r = n && n.textContent, n && t.removeChild(n), e = this.elementToBbcode(t), 
                r = "=" + r.replace(/(^\s+|\s+$)/g, ""), n) && t.insertBefore(n, t.firstChild), 
                `[quote${r}]${e}[/quote]`;
            },
            html: function(t, e, n) {
                return `<div class="border rounded mx-3 mb-3 p-3 border-secondary shadow-sm"><span contenteditable="false"><i class="fa fa-quote-left text-primary fs-4 me-2"></i></span>${n = e.defaultattr ? n + '<cite class="card-text text-end d-block text-body-secondary small">' + f(e.defaultattr) + "</cite>" : n}</div>`;
            }
        },
        code: {
            tags: {
                code: {
                    class: null
                }
            },
            isInline: !1,
            allowedChildren: [ "#", "#newline" ],
            format: function(t, e) {
                var n;
                return `[code=${(n = g(t, "code") && (n = s(t, "class")) ? n : t.className.replace("lang-", "")).replace("lang-", "")}]${e}[/code]`;
            },
            html: '<pre class="border border-danger rounded m-2 p-2"><code class="lang-{defaultattr}">{0}</code></pre>'
        },
        note: {
            tags: {
                div: {
                    role: "alert"
                }
            },
            isInline: !1,
            allowedChildren: [ "#", "#newline" ],
            format: function(t, e) {
                return `[note=${(s(t, "class") || t.className.replace("alert alert-", "")).replace("alert alert-", "")}]${e}[/note]`;
            },
            html: '<div class="alert alert-{defaultattr}" role="alert">{0}</div>'
        },
        left: {
            styles: {
                "text-align": [ "left", "-webkit-left", "-moz-left", "-khtml-left" ]
            },
            isInline: !1,
            allowsEmpty: !0,
            format: "[left]{0}[/left]",
            html: '<div align="left">{0}</div>'
        },
        center: {
            styles: {
                "text-align": [ "center", "-webkit-center", "-moz-center", "-khtml-center" ]
            },
            isInline: !1,
            allowsEmpty: !0,
            format: "[center]{0}[/center]",
            html: '<div align="center">{0}</div>'
        },
        right: {
            styles: {
                "text-align": [ "right", "-webkit-right", "-moz-right", "-khtml-right" ]
            },
            isInline: !1,
            allowsEmpty: !0,
            format: "[right]{0}[/right]",
            html: '<div align="right">{0}</div>'
        },
        justify: {
            styles: {
                "text-align": [ "justify", "-webkit-justify", "-moz-justify", "-khtml-justify" ]
            },
            isInline: !1,
            allowsEmpty: !0,
            format: "[justify]{0}[/justify]",
            html: '<div align="justify">{0}</div>'
        },
        facebook: {
            allowsEmpty: !0,
            tags: {
                div: {
                    "data-facebook-url": null
                }
            },
            format: function(t, e) {
                return (t = s(t, "data-facebook-url")) ? `[facebook]${t}[/facebook]` : e;
            },
            html: function(t, e, n) {
                return `<div class="ratio ratio-1x1" data-oembed-url="${n}" data-facebook-url="${n}"><iframe src="https://www.facebook.com/plugins/post.php?href=${n}"></iframe></div>`;
            }
        },
        instagram: {
            allowsEmpty: !0,
            tags: {
                div: {
                    "data-instagram-url": null
                }
            },
            format: function(t, e) {
                return (t = s(t, "data-instagram-url")) ? `[instagram]${t}[/instagram]` : e;
            },
            html: function(t, e, n) {
                var r;
                return `<div class="ratio ratio-1x1" data-oembed-url="https://www.instagram.com/p/${r = n.match(/\/(p|tv|reel)\/(.*?)\//)[2]}" data-instagram-url="${n}"><iframe src="https://www.instagram.com/p/${r}/embed/captioned/"></iframe></div>`;
            }
        },
        vimeo: {
            allowsEmpty: !0,
            tags: {
                div: {
                    "data-vimeo-url": null
                }
            },
            format: function(t, e) {
                return (t = s(t, "data-vimeo-url")) ? `[vimeo]${t}[/vimeo]` : e;
            },
            html: function(t, e, n) {
                var r = n.match(/vimeo\..*\/(\d+)(?:$|\/)/)[1];
                return `<div data-oembed-url="https://vimeo.com/${r}" data-vimeo-url="${n}" class="ratio ratio-16x9 border"><iframe src="https://player.vimeo.com/video/${r}?show_title=1&show_byline=1&show_portrait=1&fullscreen=1"></iframe></div>`;
            }
        },
        youtube: {
            allowsEmpty: !0,
            tags: {
                div: {
                    "data-youtube-url": null
                }
            },
            format: function(t, e) {
                return (t = s(t, "data-youtube-url")) ? `[youtube]${t}[/youtube]` : e;
            },
            html: function(t, e, n) {
                var r = n, n = n.match(/(?:v=|v\/|embed\/|youtu.be\/)?([a-zA-Z0-9_-]{11})/)[1];
                return `<div data-oembed-url="https://youtube.com/embed/${n}" data-youtube-url="${r}" class="ratio ratio-16x9 border"><iframe src="https://youtube.com/embed/${n}?hd=1"></iframe></div>`;
            }
        },
        rtl: {
            styles: {
                direction: [ "rtl" ]
            },
            isInline: !1,
            format: "[rtl]{0}[/rtl]",
            html: '<div style="direction: rtl">{0}</div>'
        },
        ltr: {
            styles: {
                direction: [ "ltr" ]
            },
            isInline: !1,
            format: "[ltr]{0}[/ltr]",
            html: '<div style="direction: ltr">{0}</div>'
        },
        ignore: {}
    };
    function x(t, r) {
        return t.replace(/\{([^}]+)\}/g, function(t, e) {
            var n = !0;
            return "!" === e.charAt(0) && (n = !1, e = e.substring(1)), "0" === e && (n = !1), 
            void 0 === r[e] ? t : n ? f(r[e], !0) : r[e];
        });
    }
    function k(t) {
        return "function" == typeof t;
    }
    function o(t) {
        return t && t.replace(/\\(.)/g, "$1").replace(/^(["'])(.*?)\1$/, "$2");
    }
    var $ = "open", w = "content", E = "newline", B = "close";
    function u(t, e, n, r, i, l) {
        var a = this;
        a.type = t, a.name = e, a.val = n, a.attrs = r || {}, a.children = i || [], 
        a.closing = l || null;
    }
    function T(t) {
        var h = this;
        function a(t, e) {
            var n, r, i;
            return t === $ && (n = e.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/)) && (i = l(n[1]), 
            n[2]) && (n[2] = n[2].trim()) && (r = (t => {
                var e, n = /([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g, r = {};
                if ("=" === t.charAt(0) && t.indexOf("=", 1) < 0) r.defaultattr = o(t.substr(1)); else for ("=" === t.charAt(0) && (t = "defaultattr" + t); e = n.exec(t); ) r[l(e[1])] = o(e[3]) || e[4];
                return r;
            })(n[2])), t === B && (n = e.match(/\[\/([^\[\]]+)\]/)) && (i = l(n[1])), 
            (i = t === E ? "#newline" : i) && (t !== $ && t !== B || y[i]) || (t = w, 
            i = "#"), new u(t, i, e, r);
        }
        function d(t, e, n) {
            for (var r = n.length; r--; ) if (n[r].type === e && n[r].name === t) return 1;
        }
        function m(t, e) {
            t = (t ? y[t.name] : {}).allowedChildren;
            return !h.opts.fixInvalidChildren || !t || -1 < t.indexOf(e.name || "#");
        }
        function c(t, e) {
            for (var n, r, i, l, a, o, s = "", u = function(t) {
                return !1 !== (!t || (void 0 !== t.isHtmlInline ? t.isHtmlInline : t.isInline));
            }; 0 < t.length; ) if (n = t.shift()) {
                if (n.type === $) o = n.children[n.children.length - 1] || {}, r = y[n.name], 
                l = e && u(r), i = c(n.children, !1), o = r && r.html ? (u(r) || !u(y[o.name]) || r.isPreFormatted || r.skipLastLineBreak, 
                k(r.html) ? r.html.call(h, n, n.attrs, i) : (n.attrs[0] = i, x(r.html, n.attrs))) : n.val + i + (n.closing ? n.closing.val : ""); else {
                    if (n.type === E) {
                        if (!e) {
                            s += "<br />";
                            continue;
                        }
                        a || (s += "<div>"), s += "<br />", t.length || (s += "<br />"), 
                        s += "</div>\n", a = !1;
                        continue;
                    }
                    l = e, o = f(n.val, !0);
                }
                l && !a ? (s += "<div>", a = !0) : !l && a && (s += "</div>\n", 
                a = !1), s += o;
            }
            return a && (s += "</div>\n"), s;
        }
        function p(t, e, n) {
            var r = /\s|=/.test(t);
            return k(e) ? e(t, n) : e === v.never || e === v.auto && !r ? t : `"${t.replace(/\\/g, "\\\\").replace(/"/g, '\\"')}"`;
        }
        function g(t) {
            return t.length ? t[t.length - 1] : null;
        }
        function l(t) {
            return t.toLowerCase();
        }
        h.opts = n({}, T.defaults, t), h.tokenize = function(t) {
            var e, n, r, i = [], l = [ {
                type: w,
                regex: /^([^\[\r\n]+|\[)/
            }, {
                type: E,
                regex: /^(\r\n|\r|\n)/
            }, {
                type: $,
                regex: /^\[[^\[\]]+\]/
            }, {
                type: B,
                regex: /^\[\/[^\[\]]+\]/
            } ];
            t: for (;t.length; ) {
                for (r = l.length; r--; ) if (n = l[r].type, (e = t.match(l[r].regex)) && e[0]) {
                    i.push(a(n, e[0])), t = t.substr(e[0].length);
                    continue t;
                }
                t.length && i.push(a(w, t)), t = "";
            }
            return i;
        }, h.parse = function(t, e) {
            var t = (t => {
                function e() {
                    return g(f);
                }
                function n(t) {
                    (e() ? e().children : c).push(t);
                }
                function r(t) {
                    return e() && (l = y[e().name]) && l.closedBy && -1 < l.closedBy.indexOf(t);
                }
                for (var i, l, a, o, s, u = [], c = [], f = []; i = t.shift(); ) switch (s = t[0], 
                m(e(), i) || i.type === B && e() && i.name === e().name || (i.name = "#", 
                i.type = w), i.type) {
                  case $:
                    r(i.name) && f.pop(), n(i), (l = y[i.name]) && !l.isSelfClosing && (l.closedBy || d(i.name, B, t)) ? f.push(i) : l && l.isSelfClosing || (i.type = w);
                    break;

                  case B:
                    if (e() && i.name !== e().name && r("/" + i.name) && f.pop(), 
                    e() && i.name === e().name) e().closing = i, f.pop(); else if (d(i.name, $, f)) {
                        for (;a = f.pop(); ) {
                            if (a.name === i.name) {
                                a.closing = i;
                                break;
                            }
                            a = a.clone(), u.length && a.children.push(g(u)), u.push(a);
                        }
                        for (s && s.type === E && (l = y[i.name]) && !1 === l.isInline && (n(s), 
                        t.shift()), n(g(u)), o = u.length; o--; ) f.push(u[o]);
                        u.length = 0;
                    } else i.type = w, n(i);
                    break;

                  case E:
                    e() && s && r((s.type === B ? "/" : "") + s.name) && (s.type === B && s.name === e().name || ((l = y[e().name]) && l.breakAfter || l && !1 === l.isInline && h.opts.breakAfterBlock && !1 !== l.breakAfter) && f.pop()), 
                    n(i);
                    break;

                  default:
                    n(i);
                }
                return c;
            })(h.tokenize(t)), n = h.opts;
            return n.fixInvalidNesting && function t(e, n, r, i) {
                var l, a, o, s, u;
                let c = function(t) {
                    let e = y[t.name];
                    return !e || !1 !== e.isInline;
                };
                n = n || [];
                i = i || e;
                for (a = 0; a < e.length; a++) if ((l = e[a]) && l.type === $) {
                    if (r && !c(l)) {
                        if (o = g(n), u = o.splitAt(l), s = 1 < n.length ? n[n.length - 2].children : i, 
                        m(l, o)) {
                            let t = o.clone();
                            t.children = l.children, l.children = [ t ];
                        }
                        if (-1 < (o = s.indexOf(o))) {
                            u.children.splice(0, 1), s.splice(o + 1, 0, l, u);
                            let t = u.children[0];
                            return void (t && t.type === E && !c(l) && (u.children.splice(0, 1), 
                            s.splice(o + 2, 0, t)));
                        }
                    }
                    n.push(l), t(l.children, n, r || c(l), i), n.pop();
                }
            }(t), function t(e, n, r) {
                var i, l, a, o, s, u, c, f;
                var d = e.length;
                n && (o = y[n.name]);
                var m = d;
                for (;m--; ) (i = e[m]) && (i.type === E ? (l = 0 < m ? e[m - 1] : null, 
                a = m < d - 1 ? e[m + 1] : null, f = !1, !r && o && !0 !== o.isSelfClosing && (l ? u || a || (!1 === o.isInline && h.opts.breakEndBlock && !1 !== o.breakEnd && (f = !0), 
                o.breakEnd && (f = !0), u = f) : (!1 === o.isInline && h.opts.breakStartBlock && !1 !== o.breakStart && (f = !0), 
                o.breakStart && (f = !0))), l && l.type === $ && (s = y[l.name]) && (r ? !1 === s.isInline && (f = !0) : (!1 === s.isInline && h.opts.breakAfterBlock && !1 !== s.breakAfter && (f = !0), 
                s.breakAfter && (f = !0))), !r && !c && a && a.type === $ && (s = y[a.name]) && (!1 === s.isInline && h.opts.breakBeforeBlock && !1 !== s.breakBefore && (f = !0), 
                s.breakBefore && (f = !0), c = f) ? e.splice(m, 1) : (f && e.splice(m, 1), 
                c = !1)) : i.type === $ && t(i.children, i, r));
            }(t, null, e), n.removeEmptyTags && function t(e) {
                var n, r;
                let i = function(e) {
                    for (var n = e.length; n--; ) {
                        let t = e[n].type;
                        if (t === $ || t === B) return !1;
                        if (t === w && /\S|\u00A0/.test(e[n].val)) return !1;
                    }
                    return !0;
                };
                var l = e.length;
                for (;l--; ) (n = e[l]) && n.type === $ && (r = y[n.name], t(n.children), 
                i(n.children)) && r && !r.isSelfClosing && !r.allowsEmpty && e.splice.apply(e, [ l, 1 ].concat(n.children));
            }(t), t;
        }, h.toHTML = function(t, e) {
            return c(h.parse(t, e), !0);
        }, h.toHTMLFragment = function(t, e) {
            return c(h.parse(t, e), !1);
        }, h.toBBCode = function(t, e) {
            return function t(e) {
                var n, r, i, l, a, o, s, u, c, f = "";
                for (;0 < e.length; ) if (n = e.shift()) if (i = y[n.name], c = !(!i || !1 !== i.isInline), 
                l = i && i.isSelfClosing, o = c && h.opts.breakBeforeBlock && !1 !== i.breakBefore || i && i.breakBefore, 
                s = c && !l && h.opts.breakStartBlock && !1 !== i.breakStart || i && i.breakStart, 
                u = c && h.opts.breakEndBlock && !1 !== i.breakEnd || i && i.breakEnd, 
                c = c && h.opts.breakAfterBlock && !1 !== i.breakAfter || i && i.breakAfter, 
                a = (i ? i.quoteType : null) || h.opts.quoteType || v.auto, i || n.type !== $) if (n.type === $) {
                    if (o && (f += "\n"), f += "[" + n.name, n.attrs) for (r in n.attrs.defaultattr && (f += "=" + p(n.attrs.defaultattr, a, "defaultattr"), 
                    delete n.attrs.defaultattr), n.attrs) n.attrs.hasOwnProperty(r) && (f += ` ${r}=` + p(n.attrs[r], a, r));
                    f += "]", s && (f += "\n"), n.children && (f += t(n.children)), 
                    l || i.excludeClosing || (u && (f += "\n"), f += `[/${n.name}]`), 
                    c && (f += "\n"), n.closing && l && (f += n.closing.val);
                } else f += n.val; else f += n.val, n.children && (f += t(n.children)), 
                n.closing && (f += n.closing.val);
                return f;
            }(h.parse(t, e));
        };
    }
    function c(t) {
        return t = parseInt(t, 10), isNaN(t) ? "00" : (t = Math.max(0, Math.min(t, 255)).toString(16)).length < 2 ? "0" + t : t;
    }
    function d(t) {
        var e;
        return (e = (t = t || "#000").match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i)) ? "#" + c(e[1]) + c(e[2]) + c(e[3]) : (e = t.match(/#([0-9a-f])([0-9a-f])([0-9a-f])\s*?$/i)) ? "#" + e[1] + e[1] + e[2] + e[2] + e[3] + e[3] : t;
    }
    function m() {
        var u = this, i = (u.stripQuotes = o, {}), d = {
            ul: [ "li", "ol", "ul" ],
            ol: [ "li", "ol", "ul" ],
            table: [ "tr" ],
            tr: [ "td", "th" ],
            code: [ "br", "p", "div" ]
        };
        function m(l, a, e) {
            function o(t) {
                var e = t[0], t = t[1], n = h.getStyle(l, e), r = l.parentNode;
                return !(!n || r && h.hasStyle(r, e, n)) && (!t || t.includes(n));
            }
            function t(t) {
                i[t] && i[t][e] && b(i[t][e], function(t, e) {
                    var n, r = y[t].strictMatch, i = (r = void 0 === r ? u.opts.strictMatch : r) ? "every" : "some";
                    if (!e || e[i]((n = r, function(t) {
                        var e = t[0], t = t[1];
                        return ("style" !== e || "CODE" !== l.nodeName) && ("style" === e && t ? t[n ? "every" : "some"](o) : (e = s(l, e)) && (!t || t.includes(e)));
                    }))) return e = y[t].format, a = k(e) ? e.call(u, l, a) : function(t) {
                        var n = arguments;
                        return t.replace(/\{(\d+)\}/g, function(t, e) {
                            return void 0 !== n[+e + 1] ? n[+e + 1] : `{${e}}`;
                        });
                    }(e, a), !1;
                });
            }
            return t("*"), t(l.nodeName.toLowerCase()), a;
        }
        function c(t, e) {
            function f(t, s, u) {
                var c = "";
                return h.traverse(t, function(t) {
                    var e = "", n = t.nodeType, r = t.nodeName.toLowerCase(), i = "code" === r, l = d[r], a = t.firstChild, o = !0;
                    u && !(o = -1 < u.indexOf(r)) && (l = u), 1 === n ? g(t, ".sceditor-nlf") && !a || ("iframe" !== r && (e = f(t, s || i, l)), 
                    o ? (s || (i || (e = m(t, e, !1)), e = m(t, e, !0)), c += ((n, r) => {
                        var i, l, a = n.nodeName.toLowerCase(), o = h.isInline;
                        if (!o(n, !0) || "br" === a) {
                            let t;
                            let e = n.previousSibling;
                            for (;e && 1 === e.nodeType && !g(e, "br") && o(e, !0) && !e.firstChild; ) e = e.previousSibling;
                            for (;l = (i = n.parentNode) && i.lastChild, t = l === n, 
                            (n = i) && t && o(i, !0); );
                            t && "li" !== a || (r += "\n"), "br" !== a && e && !g(e, "br") && o(e, !0) && (r = `
` + r);
                        }
                        return r;
                    })(t, e)) : c += e) : 3 === n && (c += t.nodeValue);
                }, !1, !0), c;
            }
            return f(t, e);
        }
        function t(t, e, n) {
            var r = new T(u.opts.parserOptions), t = t || n ? r.toHTMLFragment : r.toHTML;
            return l = u.opts, t(u.opts.bbcodeTrim ? e.trim() : e);
        }
        function e(t, e, n, r) {
            n = n || document;
            var i, l = !!h.closest(r, "code"), a = n.createElement("div"), o = n.createElement("div"), s = new T(u.opts.parserOptions);
            for (o.innerHTML = e, p(a, "visibility", "hidden"), a.appendChild(o), 
            n.body.appendChild(a), t && (a.insertBefore(n.createTextNode("#"), a.firstChild), 
            a.appendChild(n.createTextNode("#"))), r && p(o, "whiteSpace", p(r, "whiteSpace")), 
            i = o.getElementsByClassName("sceditor-ignore"); i.length; ) i[0].parentNode.removeChild(i[0]);
            return h.removeWhiteSpace(a), e = c(o, l), n.body.removeChild(a), e = s.toBBCode(e, !0), 
            e = u.opts.bbcodeTrim ? e.trim() : e;
        }
        u.init = function() {
            u.opts = this.opts, u.elementToBbcode = c, b(y, function(n, t) {
                var r = !1 === t.isInline, t = y[n].tags, e = y[n].styles;
                e && (i["*"] = i["*"] || {}, i["*"][r] = i["*"][r] || {}, i["*"][r][n] = [ [ "style", Object.entries(e) ] ]), 
                t && b(t, function(t, e) {
                    e && e.style && (e.style = Object.entries(e.style)), i[t] = i[t] || {}, 
                    i[t][r] = i[t][r] || {}, i[t][r][n] = e && Object.entries(e);
                });
            }), this.commands = n(!0, {}, a, this.commands), this.toBBCode = u.toSource, 
            this.fromBBCode = u.toHtml;
        }, u.toHtml = t.bind(null, !1), u.fragmentToHtml = t.bind(null, !0), u.toSource = e.bind(null, !1), 
        u.fragmentToSource = e.bind(null, !0);
    }
    u.prototype = {
        clone: function() {
            var t = this;
            return new u(t.type, t.name, t.val, n({}, t.attrs), [], t.closing ? t.closing.clone() : null);
        },
        splitAt: function(t) {
            var e, n = this.clone(), t = this.children.indexOf(t);
            return -1 < t && (e = this.children.length - t, n.children = this.children.splice(t, e)), 
            n;
        }
    }, T.QuoteType = v, T.defaults = {
        breakBeforeBlock: !1,
        breakStartBlock: !1,
        breakEndBlock: !1,
        breakAfterBlock: !0,
        removeEmptyTags: !0,
        fixInvalidNesting: !0,
        fixInvalidChildren: !0,
        quoteType: v.auto,
        strictMatch: !1
    }, m.get = function(t) {
        return y[t] || null;
    }, m.set = function(t, e) {
        return t && e && ((e = n(y[t] || {}, e)).remove = function() {
            delete y[t];
        }, y[t] = e), this;
    }, m.rename = function(t, e) {
        return t in y && (y[e] = y[t], delete y[t]), this;
    }, m.remove = function(t) {
        return t in y && delete y[t], this;
    }, m.formatBBCodeString = x, t.formats.bbcode = m, t.BBCodeParser = T;
})(sceditor);

(s => {
    var f = s.dom, o = {
        albums: '<i class="fa-solid fa-images"></i',
        attachments: '<i class="fa-solid fa-paperclip"></i',
        bold: '<i class="fa-solid fa-bold"></i>',
        bulletlist: '<i class="fa-solid fa-list-ul"></i>',
        center: '<i class="fa-solid fa-align-center"></i>',
        code: '<i class="fa-solid fa-code"></i>',
        color: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-palette sce-color fa-badge"></i></span>',
        copy: '<i class="fa-solid fa-copy"></i>',
        cut: '<i class="fa-solid fa-scissors"></i>',
        email: '<i class="fa-solid fa-envelope"></i>',
        emojis: '<i class="fa-solid fa-face-smile"></i>',
        extensions: '<i class="fa-solid fa-plug"></i>',
        font: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-font fa-badge"></i></span>',
        format: '<i class="fa-solid fa-font"></i>',
        grip: '<svg xmlns="http://www.w3.org/2000/svg"viewbox="0 0 16 16" unselectable="on"><path d="M14.656 5.156l-10 10 .688.688 10-10-.688-.688zm0 3l-7 7 .688.688 7-7-.688-.688zm0 3l-4 4 .688.688 4-4-.688-.688z"/></svg>',
        mark: '<i class="fa-solid fa-highlighter"></i>',
        horizontalrule: '<i class="fa-solid fa-grip-lines"></i>',
        image: '<i class="fa-solid fa-image"></i>',
        italic: '<i class="fa-solid fa-italic"></i>',
        justify: '<i class="fa-solid fa-align-justify"></i>',
        left: '<i class="fa-solid fa-align-left"></i>',
        link: '<i class="fa-solid fa-link"></i>',
        maximize: '<i class="fa-solid fa-maximize"></i>',
        media: '<i class="fa-solid fa-photo-film"></i>',
        note: '<i class="fa-solid fa-note-sticky"></i>',
        orderedlist: '<i class="fa-solid fa-list-ol"></i>',
        paste: '<i class="fa-solid fa-paste"></i>',
        pastetext: '<i class="fa-solid fa-paste"></i>',
        quote: '<i class="fa-solid fa-quote-left"></i>',
        redo: '<i class="fa-solid fa-redo"></i>',
        removeformat: '<i class="fa-solid fa-remove-format"></i>',
        reply: '<i class="fa-solid fa-reply"></i>',
        right: '<i class="fa-solid fa-align-right"></i>',
        size: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-up-down fa-badge"></i></span>',
        source: '<i class="fa-solid fa-file-code"></i>',
        strike: '<i class="fa-solid fa-strikethrough"></i>',
        table: '<i class="fa-solid fa-table"></i>',
        underline: '<i class="fa-solid fa-underline"></i>',
        undo: '<i class="fa-solid fa-undo"></i>',
        unlink: '<i class="fa-solid fa-link-slash"></i>',
        vimeo: '<i class="fa-brands fa-vimeo"></i>',
        instagram: '<i class="fa-brands fa-instagram"></i>',
        facebook: '<i class="fa-brands fa-facebook"></i>',
        youtube: '<i class="fa-brands fa-youtube"></i>'
    };
    s.icons.fontawesome = function() {
        var l, i = {};
        return {
            create: function(a) {
                return a in o && (i[a] = s.dom.parseHTML(o[a]).firstChild, "color" === a) && (l = i[a].querySelector(".sce-color")), 
                i[a];
            },
            update: function(s, i) {
                if (l) {
                    let a = "inherit";
                    !s && i && (a = i.ownerDocument.queryCommandValue("forecolor")), 
                    f.css(l, "color", a);
                }
            },
            rtl: function(a) {
                var s = i.grip;
                s && (f.css(s, "transform", a = a ? "scaleX(-1)" : ""), f.css(s, "msTransform", a), 
                f.css(s, "webkitTransform", a));
            }
        };
    }, s.icons.fontawesome.icons = o;
})((document, sceditor));

(f => {
    var v = void 0 !== window.FileReader;
    f.plugins.dragdrop = function() {
        var n, A, r, a, i, d;
        function o() {
            i.style.display = "none", a.className = a.className.replace(/(^| )dnd( |$)/g, "");
        }
        function s() {
            return 1;
        }
        function l(e) {
            var t = document.createElement("img");
            function n(e) {
                var n = A.getBody().ownerDocument.getElementById(t.id);
                n && ("string" == typeof e && n.insertAdjacentHTML("afterend", e), 
                n.parentNode.removeChild(n));
            }
            return t.src = "data:image/gif;base64,R0lGODlhlgBkAPABAH19ffb29iH5BAAKAAAAIf4aQ3JlYXRlZCB3aXRoIGFqYXhsb2FkLmluZm8AIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAlgBkAAAC1YyPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwD2fP6iD/gH6Pc2GIhg2JeQSNjGuLf4GMlYKIloefAIUEl52ZmJyaY5mUhqyFnqmQr6KRoaMKp66hbLumpQ69oK+5qrOyg4a6qYV2x8jJysvMzc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fL99UAAAh+QQACgAAACwAAAAAlgBkAIEAAAB9fX329vYAAAAC3JSPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwD2fP4iABgY+CcoCNeHuJdQyLjIaOiWiOj4CEhZ+SbZd/nI2RipqYhQOThKGpAZCuBZyArZprpqSupaCqtaazmLCRqai7rb2av5W5wqSShcm8fc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5/vVAAAIfkEAAoAAAAsAAAAAJYAZACBAAAAfX199vb2AAAAAuCUj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9jr8E9nz+AgAYGLjQVwhXiJgguAiYgGjo9tinyCjoKLn3hpmJUGmJsBmguUnpCXCJOZraaXoKShoJe9DqehCqKlnqiZobuzrbyvuIO8xqKpxIPKlwrPCbBx0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P379UAAAh+QQACgAAACwAAAAAlgBkAIEAAAB9fX329vYAAAAC4JSPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwT2fP6iD7gAMEhICAeImIAYiFDoOPi22KcouZfw6BhZGUBZeYlp6LbJiTD6CQqg6Vm6eQqqKtkZ24iaKtrKunpQa9tmmju7Wwu7KFtMi3oYDMzompkHHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5+vv8/f31QAADs=", 
            t.className = "sceditor-ignore", t.id = "sce-dragdrop-" + d++, function() {
                return e ? e.parentNode.replaceChild(t, e) : A.wysiwygEditorInsertHtml(t.outerHTML), 
                {
                    insert: function(e) {
                        n(e);
                    },
                    cancel: n
                };
            };
        }
        function e(e) {
            var n = e.dataTransfer, t = n.files.length || !n.items ? n.files : n.items;
            for (let e = 0; e < t.length; e++) if ("string" === t[e].kind) return;
            "none" === i.style.display && (i.style.display = "block", a.className += " dnd"), 
            e.preventDefault();
        }
        function t(e) {
            var n = e.dataTransfer, t = n.files.length || !n.items ? n.files : n.items;
            o();
            for (let e = 0; e < t.length; e++) {
                if ("string" === t[e].kind) return;
                s(t[e]), r(t[e], l());
            }
            e.preventDefault();
        }
        v && (d = 0, this.signalReady = function() {
            n = (A = this).opts.dragdrop || {}, (r = n.handleFile) && (a = A.getContentAreaContainer().parentNode, 
            i = a.appendChild(f.dom.parseHTML('<div class="sceditor-dnd-cover" style="display: none"></div>').firstChild), 
            a.addEventListener("dragover", e), a.addEventListener("dragleave", o), 
            a.addEventListener("dragend", o), a.addEventListener("drop", t), A.getBody().addEventListener("dragover", e), 
            A.getBody().addEventListener("drop", o));
        }, this.signalPasteHtml = function(e) {
            !e || !n.handleFile || e.val || (o(), "handlePaste" in n && !n.handlePaste) || r(e, l());
        });
    };
})(sceditor);

sceditor.plugins.undo = function() {
    var n, i, a, o, r = this, s = "", d = 0, c = !1, u = !1, l = !1, e = 50, t = [], g = 0;
    function f(e) {
        if (u = !0, i.sourceMode(e.sourceMode), e.sourceMode) i.val(e.value, !1), 
        i.sourceEditorCaret(e.caret); else if (i.getBody().innerHTML = e.value, 
        e.caret) {
            var t = i.getRangeHelper().selectedRange(), n = t, e = e.caret;
            try {
                var o = e.startPositions, r = e.endPositions;
                n.setStart(m(a, o), o[0]), n.setEnd(m(a, r), r[0]);
            } catch (e) {
                console && console.warn && console.warn("[SCEditor] Undo plugin lost caret", e);
            }
            i.getRangeHelper().selectRange(t);
        }
        i.focus(), u = !1;
    }
    function h(e, t) {
        var n = e[t];
        e[t] = function() {
            var e = c;
            !e && !u && o && i.getRangeHelper().hasSelection() && v(), c = !0, n.apply(this, arguments), 
            e || (c = !1, u) || (p(), s = "");
        };
    }
    function p() {
        g && (t.length -= g, g = 0), 0 < e && e < t.length && t.shift(), o = {}, 
        v(), t.push(o);
    }
    function v() {
        var e = i.sourceMode(), e = (o.caret = e ? i.sourceEditorCaret() : (e => {
            if (e) return a.normalize(), {
                startPositions: y(e.startContainer, e.startOffset),
                endPositions: y(e.endContainer, e.endOffset)
            };
        })(i.getRangeHelper().selectedRange()), (o.sourceMode = e) ? i.getSourceEditorValue(!1) : i.getBody().innerHTML), t = document.getElementById("editor-Counter"), n = i.opts.maxLength;
        i.val().length > n ? r.undo() : t.textContent = n - i.val().length, o.value = e;
    }
    function E() {
        n === document.activeElement && r.signalSelectionchangedEvent();
    }
    function y(e, t) {
        for (var n = [ t ], o = e; o && "BODY" !== o.tagName; ) n.push((e => {
            for (var t = 0; e = e.previousSibling; ) t++;
            return t;
        })(o)), o = o.parentNode;
        return n;
    }
    function m(t, n) {
        for (let e = n.length - 1; t && 0 < e; e--) t = t.childNodes[n[e]];
        return t;
    }
    r.init = function() {
        e = (i = this).undoLimit || e, i.addShortcut("ctrl+z", r.undo), i.addShortcut("ctrl+shift+z", r.redo), 
        i.addShortcut("ctrl+y", r.redo);
    }, r.signalReady = function() {
        function e(e) {
            "historyUndo" === e.inputType ? (r.undo(), e.preventDefault()) : "historyRedo" === e.inputType && (r.redo(), 
            e.preventDefault());
        }
        function t() {
            s = "", p();
        }
        n = i.getContentAreaContainer().nextSibling, a = i.getBody(), p(), h(i, "setWysiwygEditorValue"), 
        h(i, "setSourceEditorValue"), h(i, "sourceEditorInsertText"), h(i.getRangeHelper(), "insertNode"), 
        h(i, "toggleSourceMode"), a.addEventListener("beforeinput", e), n.addEventListener("beforeinput", e), 
        a.addEventListener("compositionend", t), n.addEventListener("compositionend", t), 
        document.addEventListener("selectionchange", E);
    }, r.destroy = function() {
        document.removeEventListener("selectionchange", E);
    }, r.undo = function() {
        return o = null, g < t.length - 1 && (g++, f(t[t.length - 1 - g])), !1;
    }, r.redo = function() {
        return 0 < g && (g--, f(t[t.length - 1 - g])), !1;
    }, r.signalSelectionchangedEvent = function() {
        u || l ? l = !1 : (o && v(), s = "");
    }, r.signalInputEvent = function(e) {
        var t = e.inputType;
        if (l = !0, t && !e.isComposing) switch (e.inputType) {
          case "deleteContentBackward":
            o && s === t && d < 20 ? v() : (p(), d = 0), s = t;
            break;

          case "insertText":
            d += e.data ? e.data.length : 1, o && s === t && d < 20 && !/\s$/.test(e.data) ? v() : (p(), 
            d = 0), s = t;
            break;

          default:
            s = "sce-misc", d = 0, p();
        }
    };
};

(t => {
    var i = t.utils, l = t.dom;
    t.plugins.plaintext = function() {
        var n = !0;
        this.init = function() {
            var t = this.commands, e = this.opts;
            e && e.plaintext && e.plaintext.addButton && (n = e.plaintext.enabled, 
            t.pastetext = i.extend(t.pastetext || {}, {
                state: function() {
                    return n ? 1 : 0;
                },
                exec: function() {
                    n = !n;
                }
            }));
        }, this.signalPasteRaw = function(t) {
            var e;
            n && (t.html && !t.text && ((e = document.createElement("div")).innerHTML = t.html, 
            i.each(e.querySelectorAll("p"), function(t, e) {
                l.convertElement(e, "div");
            }), i.each(e.querySelectorAll("br"), function(t, e) {
                e.nextSibling && l.isInline(e.nextSibling, !0) || e.parentNode.removeChild(e);
            }), document.body.appendChild(e), t.text = e.innerText, document.body.removeChild(e)), 
            t.html = null);
        };
    };
})(sceditor);

function mentions(opts = {}) {
    opts = Object.assign({}, {
        lookup: "lookup",
        id: "",
        selector: "",
        element: null,
        symbol: "@",
        items: [],
        item_template: '<a class="dropdown-item" href="#" style="font-family: var(--bs-body-font-family);"><img src="${item.avatar}" alt="avatar" class="me-2 img-thumbnail" style="max-width:20px;max-height:20px" /> ${item.name}</a>',
        onclick: undefined,
        url: ""
    }, opts);
    const $e = opts.element.inSourceMode() ? opts.element.getSourceEditor() : opts.element.getContentAreaContainer().contentWindow.document.body;
    if (!$e) return console.error("Invalid element selector", opts);
    var $lookup = document.createElement("div");
    $lookup.classList = `fixed-top autohide ${opts.lookup}`;
    $e.parentNode.insertBefore($lookup, $e.nextSibling);
    $e.addEventListener("keydown", processKey);
    $e.addEventListener("keyup", showLookup);
    $e.addEventListener("click", hideLookup);
    var start, end, prevWord;
    var isFixed = false;
    var $el = $lookup.parentNode;
    while ($el && $el.nodeName.toLowerCase() !== "body" && !isFixed) {
        isFixed = window.getComputedStyle($el).getPropertyValue("position").toLowerCase() === "fixed";
        $el = $el.parentElement;
    }
    function showLookup(event) {
        if (event.code === "Escape") {
            return hideLookup();
        }
        var sel, text, curr;
        if (opts.element.inSourceMode()) {
            sel = document.getSelection();
            var $parent = opts.element.getSourceEditor();
            text = $parent.value || "";
            curr = sel.baseOffset;
        } else {
            sel = opts.element.getContentAreaContainer().contentWindow.document.getSelection();
            text = opts.element.val() || "";
            curr = sel.baseOffset;
        }
        var getLength = arr => arr instanceof Array && arr.length > 0 ? arr[0].length : 0;
        start = curr - getLength(text.slice(0, curr).match(/[\S]+$/g));
        end = curr + getLength(text.slice(curr).match(/^[\S]+/g));
        var word = text.substring(start, end);
        if (!word || word[0] !== opts.symbol) {
            prevWord = "";
            return hideLookup();
        }
        if (word === prevWord) return;
        prevWord = word;
        var pos = {
            x: 0,
            y: 0
        };
        var parentRect = opts.element.inSourceMode() ? opts.element.getSourceEditor().getBoundingClientRect() : opts.element.getContentAreaContainer().contentWindow.document.body.getBoundingClientRect();
        pos.y = parentRect.top + 30;
        pos.x = parentRect.left + 20;
        $lookup.style.left = pos.x + "px";
        $lookup.style.top = pos.y + "px";
        var query = word.slice(1);
        if (query.length >= 3) {
            fetch(opts.url.replace("{q}", query), {
                method: "GET",
                headers: {
                    Accept: "application/json",
                    "Content-Type": "application/json;charset=utf-8",
                    RequestVerificationToken: document.querySelector('input[name="__RequestVerificationToken"]').value
                }
            }).then(response => response.json()).then(data => opts.items = data);
        }
        var items = opts.items.filter(e => e.name.toLowerCase().includes(word.slice(1).toLowerCase())).map(item => eval('`<li class="mention-li-nt ${opts.lookup}" data-name = "${item.name}" data-id = "${item.id}">' + opts.item_template + "</li>`"));
        if (!items.length) return hideLookup();
        $lookup.innerHTML = `<ul class="dropdown-menu show">${items.join("")}</ul>`;
        [ ...$lookup.firstElementChild.children ].forEach($el => $el.addEventListener("click", onClick) || $el.addEventListener("mouseenter", onHover));
        $lookup.firstElementChild.children[0].classList.add("active");
        if ($lookup.hasAttribute("hidden")) $lookup.removeAttribute("hidden");
        var bounding = $lookup.getBoundingClientRect();
        if (!(bounding.top >= 0 && bounding.left >= 0 && bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) && bounding.right <= (window.innerWidth || document.documentElement.clientWidth))) $lookup.style.top = parseInt($lookup.style.top) - 10 - $lookup.clientHeight + "px";
    }
    function hideLookup() {
        if (!$lookup.hasAttribute("hidden")) $lookup.setAttribute("hidden", true);
    }
    function onClick(event) {
        const deleteItem = event.target.classList.contains("mention-li-nt") ? event.target : event.target.parentElement;
        opts.onclick(deleteItem.dataset);
        var value = opts.element.val();
        opts.element.val(value.replace(value.substring(start + 1, end), ""));
        hideLookup();
    }
    function onHover(event) {
        const $el = event.target.closest(".mention-li-nt");
        if ($el.classList.contains("active")) return;
        [ ...$lookup.firstElementChild.children ].filter($el => $el.classList.contains("active")).forEach($el => $el.classList.remove("active"));
        $el.classList.add("active");
    }
    function processKey(event) {
        const code = event.key;
        if ([ "ArrowUp", "ArrowDown", "Enter" ].indexOf(code) == -1 || $lookup.hasAttribute("hidden")) return;
        event.preventDefault();
        if (code == "Enter") return $lookup.querySelector(".active").click();
        const $children = [ ...$lookup.firstElementChild.children ];
        const curr = $children.findIndex($el => $el.classList.contains("active"));
        $children[curr].classList.remove("active");
        const $next = $children[($children.length + curr + (code == "ArrowUp" ? -1 : 1)) % $children.length];
        $next.classList.add("active");
        $next.scrollIntoView(false);
    }
}